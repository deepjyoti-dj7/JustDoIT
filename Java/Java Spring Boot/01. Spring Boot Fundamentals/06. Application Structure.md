# ğŸ—ï¸ Application Structure

## Recommended Project Structure

### Standard Maven/Gradle Project Layout

```
myapp/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main/
â”‚   â”‚   â”œâ”€â”€ java/
â”‚   â”‚   â”‚   â””â”€â”€ com/
â”‚   â”‚   â”‚       â””â”€â”€ example/
â”‚   â”‚   â”‚           â””â”€â”€ myapp/
â”‚   â”‚   â”‚               â”œâ”€â”€ MyAppApplication.java          # Main class
â”‚   â”‚   â”‚               â”œâ”€â”€ config/                        # Configuration
â”‚   â”‚   â”‚               â”‚   â”œâ”€â”€ SecurityConfig.java
â”‚   â”‚   â”‚               â”‚   â”œâ”€â”€ DatabaseConfig.java
â”‚   â”‚   â”‚               â”‚   â””â”€â”€ AppConfig.java
â”‚   â”‚   â”‚               â”œâ”€â”€ controller/                    # REST Controllers
â”‚   â”‚   â”‚               â”‚   â”œâ”€â”€ UserController.java
â”‚   â”‚   â”‚               â”‚   â””â”€â”€ ProductController.java
â”‚   â”‚   â”‚               â”œâ”€â”€ service/                       # Business Logic
â”‚   â”‚   â”‚               â”‚   â”œâ”€â”€ UserService.java
â”‚   â”‚   â”‚               â”‚   â”œâ”€â”€ ProductService.java
â”‚   â”‚   â”‚               â”‚   â””â”€â”€ impl/
â”‚   â”‚   â”‚               â”‚       â”œâ”€â”€ UserServiceImpl.java
â”‚   â”‚   â”‚               â”‚       â””â”€â”€ ProductServiceImpl.java
â”‚   â”‚   â”‚               â”œâ”€â”€ repository/                    # Data Access
â”‚   â”‚   â”‚               â”‚   â”œâ”€â”€ UserRepository.java
â”‚   â”‚   â”‚               â”‚   â””â”€â”€ ProductRepository.java
â”‚   â”‚   â”‚               â”œâ”€â”€ model/                        # Domain Entities
â”‚   â”‚   â”‚               â”‚   â”œâ”€â”€ User.java
â”‚   â”‚   â”‚               â”‚   â””â”€â”€ Product.java
â”‚   â”‚   â”‚               â”œâ”€â”€ dto/                          # Data Transfer Objects
â”‚   â”‚   â”‚               â”‚   â”œâ”€â”€ UserDTO.java
â”‚   â”‚   â”‚               â”‚   â”œâ”€â”€ CreateUserRequest.java
â”‚   â”‚   â”‚               â”‚   â””â”€â”€ UserResponse.java
â”‚   â”‚   â”‚               â”œâ”€â”€ exception/                    # Custom Exceptions
â”‚   â”‚   â”‚               â”‚   â”œâ”€â”€ UserNotFoundException.java
â”‚   â”‚   â”‚               â”‚   â”œâ”€â”€ GlobalExceptionHandler.java
â”‚   â”‚   â”‚               â”‚   â””â”€â”€ ErrorResponse.java
â”‚   â”‚   â”‚               â”œâ”€â”€ util/                         # Utility Classes
â”‚   â”‚   â”‚               â”‚   â”œâ”€â”€ DateUtil.java
â”‚   â”‚   â”‚               â”‚   â””â”€â”€ ValidationUtil.java
â”‚   â”‚   â”‚               â””â”€â”€ constants/                    # Constants
â”‚   â”‚   â”‚                   â””â”€â”€ AppConstants.java
â”‚   â”‚   â””â”€â”€ resources/
â”‚   â”‚       â”œâ”€â”€ application.properties                    # Main config
â”‚   â”‚       â”œâ”€â”€ application-dev.properties                # Dev profile
â”‚   â”‚       â”œâ”€â”€ application-prod.properties               # Prod profile
â”‚   â”‚       â”œâ”€â”€ static/                                   # Static resources
â”‚   â”‚       â”‚   â”œâ”€â”€ css/
â”‚   â”‚       â”‚   â”œâ”€â”€ js/
â”‚   â”‚       â”‚   â””â”€â”€ images/
â”‚   â”‚       â”œâ”€â”€ templates/                                # Templates (Thymeleaf)
â”‚   â”‚       â”‚   â””â”€â”€ index.html
â”‚   â”‚       â”œâ”€â”€ db/                                       # Database scripts
â”‚   â”‚       â”‚   â””â”€â”€ migration/
â”‚   â”‚       â”‚       â”œâ”€â”€ V1__init.sql
â”‚   â”‚       â”‚       â””â”€â”€ V2__add_users.sql
â”‚   â”‚       â””â”€â”€ logback-spring.xml                       # Logging config
â”‚   â””â”€â”€ test/
â”‚       â”œâ”€â”€ java/
â”‚       â”‚   â””â”€â”€ com/
â”‚       â”‚       â””â”€â”€ example/
â”‚       â”‚           â””â”€â”€ myapp/
â”‚       â”‚               â”œâ”€â”€ controller/
â”‚       â”‚               â”‚   â””â”€â”€ UserControllerTest.java
â”‚       â”‚               â”œâ”€â”€ service/
â”‚       â”‚               â”‚   â””â”€â”€ UserServiceTest.java
â”‚       â”‚               â””â”€â”€ repository/
â”‚       â”‚                   â””â”€â”€ UserRepositoryTest.java
â”‚       â””â”€â”€ resources/
â”‚           â””â”€â”€ application-test.properties
â”œâ”€â”€ target/                                               # Build output (gitignored)
â”œâ”€â”€ pom.xml                                              # Maven dependencies
â”œâ”€â”€ .gitignore
â””â”€â”€ README.md
```

## Package Organization

### Option 1: Layer-based (Recommended for Small/Medium Projects)

```
com.example.myapp
â”œâ”€â”€ controller/       # Presentation layer
â”œâ”€â”€ service/         # Business logic layer
â”œâ”€â”€ repository/      # Data access layer
â”œâ”€â”€ model/          # Domain entities
â”œâ”€â”€ dto/            # Data transfer objects
â”œâ”€â”€ config/         # Configuration
â”œâ”€â”€ exception/      # Exception handling
â””â”€â”€ util/           # Utilities
```

**Pros:**
- Clear separation of concerns
- Easy to understand
- Standard practice

**Cons:**
- Related code spread across packages
- Harder to identify feature boundaries

### Option 2: Feature-based (Recommended for Large Projects/Microservices)

```
com.example.myapp
â”œâ”€â”€ user/
â”‚   â”œâ”€â”€ User.java
â”‚   â”œâ”€â”€ UserController.java
â”‚   â”œâ”€â”€ UserService.java
â”‚   â”œâ”€â”€ UserRepository.java
â”‚   â””â”€â”€ UserDTO.java
â”œâ”€â”€ product/
â”‚   â”œâ”€â”€ Product.java
â”‚   â”œâ”€â”€ ProductController.java
â”‚   â”œâ”€â”€ ProductService.java
â”‚   â”œâ”€â”€ ProductRepository.java
â”‚   â””â”€â”€ ProductDTO.java
â”œâ”€â”€ order/
â”‚   â”œâ”€â”€ Order.java
â”‚   â”œâ”€â”€ OrderController.java
â”‚   â”œâ”€â”€ OrderService.java
â”‚   â””â”€â”€ OrderRepository.java
â””â”€â”€ common/
    â”œâ”€â”€ config/
    â”œâ”€â”€ exception/
    â””â”€â”€ util/
```

**Pros:**
- Feature-focused
- Easy to locate related code
- Better for microservices
- Easier to extract features

**Cons:**
- Less conventional
- Can have code duplication

### Option 3: Hybrid Approach

```
com.example.myapp
â”œâ”€â”€ user/
â”‚   â”œâ”€â”€ controller/
â”‚   â”œâ”€â”€ service/
â”‚   â”œâ”€â”€ repository/
â”‚   â””â”€â”€ model/
â”œâ”€â”€ product/
â”‚   â”œâ”€â”€ controller/
â”‚   â”œâ”€â”€ service/
â”‚   â”œâ”€â”€ repository/
â”‚   â””â”€â”€ model/
â””â”€â”€ shared/
    â”œâ”€â”€ config/
    â”œâ”€â”€ exception/
    â””â”€â”€ util/
```

## Main Application Class Location

### âœ… Correct: Root Package
```
com.example.myapp
â””â”€â”€ MyAppApplication.java    # Main class here
    â”œâ”€â”€ controller/
    â”œâ”€â”€ service/
    â””â”€â”€ repository/
```

**Why?** Component scanning starts from main class package and scans all sub-packages.

### âŒ Incorrect: Nested Package
```
com.example.myapp
â”œâ”€â”€ controller/
â”œâ”€â”€ service/
â””â”€â”€ config/
    â””â”€â”€ MyAppApplication.java    # Wrong location!
```

**Problem:** Components in `controller/` and `service/` won't be scanned automatically.

## Package Naming Conventions

### Good Practice
```
com.company.project.layer.feature

Examples:
com.example.myapp.controller.UserController
com.example.myapp.service.impl.UserServiceImpl
com.example.myapp.repository.UserRepository
```

### Domain vs Technical Packages

**Technical (Layer-based):**
```
com.example.myapp.controller
com.example.myapp.service
com.example.myapp.repository
```

**Domain (Feature-based):**
```
com.example.myapp.user
com.example.myapp.product
com.example.myapp.order
```

## Layer Responsibilities

### 1. Controller Layer
**Responsibility:** Handle HTTP requests, delegate to service

```java
@RestController
@RequestMapping("/api/users")
public class UserController {
    
    @Autowired
    private UserService userService;
    
    @GetMapping("/{id}")
    public ResponseEntity<UserDTO> getUser(@PathVariable Long id) {
        return ResponseEntity.ok(userService.getUserById(id));
    }
    
    @PostMapping
    public ResponseEntity<UserDTO> createUser(@Valid @RequestBody CreateUserRequest request) {
        return ResponseEntity.status(HttpStatus.CREATED)
            .body(userService.createUser(request));
    }
}
```

**Contains:**
- `@RestController` or `@Controller` classes
- Request mapping
- Input validation
- Response formatting

### 2. Service Layer
**Responsibility:** Business logic, transactions

```java
@Service
@Transactional
public class UserServiceImpl implements UserService {
    
    @Autowired
    private UserRepository userRepository;
    
    @Override
    public UserDTO getUserById(Long id) {
        User user = userRepository.findById(id)
            .orElseThrow(() -> new UserNotFoundException(id));
        return mapToDTO(user);
    }
    
    @Override
    public UserDTO createUser(CreateUserRequest request) {
        // Business logic
        User user = new User();
        user.setName(request.getName());
        user.setEmail(request.getEmail());
        
        User saved = userRepository.save(user);
        return mapToDTO(saved);
    }
}
```

**Contains:**
- `@Service` classes
- Business logic
- Transaction management
- Data transformation

### 3. Repository Layer
**Responsibility:** Data access

```java
@Repository
public interface UserRepository extends JpaRepository<User, Long> {
    
    Optional<User> findByEmail(String email);
    
    List<User> findByNameContaining(String name);
    
    @Query("SELECT u FROM User u WHERE u.status = :status")
    List<User> findActiveUsers(@Param("status") String status);
}
```

**Contains:**
- `@Repository` interfaces
- Database queries
- Data persistence

### 4. Model/Entity Layer
**Responsibility:** Domain objects

```java
@Entity
@Table(name = "users")
public class User {
    
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    
    @Column(nullable = false)
    private String name;
    
    @Column(unique = true, nullable = false)
    private String email;
    
    // Getters and setters
}
```

**Contains:**
- `@Entity` classes
- Domain model
- Business rules

### 5. DTO Layer
**Responsibility:** Data transfer between layers

```java
public class UserDTO {
    private Long id;
    private String name;
    private String email;
    // Getters and setters
}

public class CreateUserRequest {
    @NotBlank
    private String name;
    
    @Email
    private String email;
    // Getters and setters
}
```

**Contains:**
- Request/Response objects
- No business logic
- Validation annotations

### 6. Configuration Layer
**Responsibility:** Bean configuration

```java
@Configuration
public class AppConfig {
    
    @Bean
    public RestTemplate restTemplate() {
        return new RestTemplate();
    }
    
    @Bean
    public PasswordEncoder passwordEncoder() {
        return new BCryptPasswordEncoder();
    }
}
```

**Contains:**
- `@Configuration` classes
- Bean definitions
- External service configs

### 7. Exception Layer
**Responsibility:** Error handling

```java
@ControllerAdvice
public class GlobalExceptionHandler {
    
    @ExceptionHandler(UserNotFoundException.class)
    public ResponseEntity<ErrorResponse> handleUserNotFound(UserNotFoundException ex) {
        ErrorResponse error = new ErrorResponse(
            HttpStatus.NOT_FOUND.value(),
            ex.getMessage(),
            LocalDateTime.now()
        );
        return ResponseEntity.status(HttpStatus.NOT_FOUND).body(error);
    }
}
```

**Contains:**
- Custom exceptions
- Global exception handlers
- Error response models

## Configuration Files

### application.properties
```properties
# Server
server.port=8080
server.servlet.context-path=/api

# Database
spring.datasource.url=jdbc:mysql://localhost:3306/mydb
spring.datasource.username=root
spring.datasource.password=secret

# JPA
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true

# Logging
logging.level.root=INFO
logging.level.com.example.myapp=DEBUG
```

### application.yml (Alternative)
```yaml
server:
  port: 8080
  servlet:
    context-path: /api

spring:
  datasource:
    url: jdbc:mysql://localhost:3306/mydb
    username: root
    password: secret
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true

logging:
  level:
    root: INFO
    com.example.myapp: DEBUG
```

### Profile-specific Configs
```
application.properties           # Common
application-dev.properties       # Development
application-test.properties      # Testing
application-prod.properties      # Production
```

## Resources Directory

### Static Resources
```
src/main/resources/static/
â”œâ”€â”€ css/
â”‚   â””â”€â”€ styles.css
â”œâ”€â”€ js/
â”‚   â””â”€â”€ app.js
â”œâ”€â”€ images/
â”‚   â””â”€â”€ logo.png
â””â”€â”€ index.html
```

Access: `http://localhost:8080/css/styles.css`

### Templates (Thymeleaf)
```
src/main/resources/templates/
â”œâ”€â”€ index.html
â”œâ”€â”€ user/
â”‚   â”œâ”€â”€ list.html
â”‚   â””â”€â”€ detail.html
â””â”€â”€ error/
    â””â”€â”€ 404.html
```

### Database Migration
```
src/main/resources/db/migration/
â”œâ”€â”€ V1__init_schema.sql
â”œâ”€â”€ V2__add_users_table.sql
â””â”€â”€ V3__add_products_table.sql
```

## Best Practices

### 1. âœ… Main Class in Root Package
```java
// âœ… Good
com.example.myapp.MyAppApplication

// âŒ Bad
com.example.myapp.config.MyAppApplication
```

### 2. âœ… Clear Layer Separation
```java
Controller â†’ Service â†’ Repository â†’ Database
```

### 3. âœ… Use DTOs
```java
// Don't expose entities directly
@GetMapping
public List<UserDTO> getUsers() {  // âœ… DTO
    return userService.getAllUsers();
}

// âŒ Bad
public List<User> getUsers() {  // Exposes entity
    return userRepository.findAll();
}
```

### 4. âœ… Single Responsibility
Each class should have one responsibility.

### 5. âœ… Consistent Naming
```java
UserController
UserService / UserServiceImpl
UserRepository
User (entity)
UserDTO (data transfer)
```

### 6. âœ… Package by Feature for Microservices
```
user/
product/
order/
```

### 7. âœ… Common Package for Shared Code
```
common/
â”œâ”€â”€ config/
â”œâ”€â”€ exception/
â””â”€â”€ util/
```

## Anti-patterns to Avoid

### âŒ God Class
```java
// Bad: One class doing everything
public class UserManager {
    // HTTP handling
    // Business logic
    // Database access
    // Validation
}
```

### âŒ Logic in Controller
```java
// Bad
@RestController
public class UserController {
    @GetMapping("/users/{id}")
    public User getUser(@PathVariable Long id) {
        // âŒ Business logic in controller
        User user = repository.findById(id).orElse(null);
        if (user == null) throw new Exception();
        return user;
    }
}
```

### âŒ Circular Dependencies
```java
// Bad
UserService â†’ ProductService â†’ UserService
```

## Interview Questions

**Q: Where should the main class be located?**  
A: In the root package to enable component scanning of all sub-packages.

**Q: What are the common layers in Spring Boot?**  
A: Controller, Service, Repository, Model, DTO, Configuration, Exception.

**Q: Layer-based vs Feature-based packaging?**  
A: Layer-based for small/medium apps, Feature-based for microservices/large apps.

**Q: Where to put static resources?**  
A: `src/main/resources/static/`

**Q: Difference between Model and DTO?**  
A: Model is domain entity (database), DTO is data transfer object (API).

## Key Takeaways

- Main class in root package
- Clear layer separation (Controller â†’ Service â†’ Repository)
- Use DTOs for API layer
- Package by layer (small) or feature (large)
- Follow consistent naming conventions
- Keep configuration in properties/yml files
- Single responsibility per class
- Avoid circular dependencies
