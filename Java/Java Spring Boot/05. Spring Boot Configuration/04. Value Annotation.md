# üíé @Value Annotation - Complete Guide

## üìã Table of Contents
- [Introduction](#introduction)
- [Basic Usage](#basic-usage)
- [Default Values](#default-values)
- [SpEL Expressions](#spel-expressions)
- [System Properties](#system-properties)
- [Environment Variables](#environment-variables)
- [Collection Values](#collection-values)
- [Map Values](#map-values)
- [Type Conversion](#type-conversion)
- [Constructor and Method Injection](#constructor-and-method-injection)
- [Best Practices](#best-practices)
- [Interview Questions](#interview-questions)

---

## üéØ Introduction

`@Value` annotation injects property values directly into fields, methods, and constructor parameters.

### Benefits

- ‚úÖ **Simple injection**: Direct property binding
- ‚úÖ **SpEL support**: Powerful expression language
- ‚úÖ **Default values**: Fallback values
- ‚úÖ **System properties**: Access system/env variables
- ‚úÖ **Flexible**: Multiple value sources

---

## üéØ Basic Usage

### Field Injection

```yaml
# application.yml
app:
  name: MyApplication
  version: 1.0.0
  port: 8080
  enabled: true
```

```java
@Component
public class AppComponent {
    
    @Value("${app.name}")
    private String appName;
    
    @Value("${app.version}")
    private String version;
    
    @Value("${app.port}")
    private int port;
    
    @Value("${app.enabled}")
    private boolean enabled;
    
    public void printConfig() {
        System.out.println("App: " + appName);
        System.out.println("Version: " + version);
        System.out.println("Port: " + port);
        System.out.println("Enabled: " + enabled);
    }
}
```

### Literal Values

```java
@Component
public class LiteralComponent {
    
    @Value("MyApp")
    private String name;
    
    @Value("100")
    private int maxUsers;
    
    @Value("true")
    private boolean active;
    
    @Value("3.14")
    private double pi;
}
```

### String Values

```java
@Component
public class StringComponent {
    
    @Value("Welcome to Spring Boot")
    private String message;
    
    @Value("admin@example.com")
    private String email;
    
    @Value("/api/v1")
    private String apiPath;
}
```

---

## üîß Default Values

### Using Colon (:) Syntax

```java
@Component
public class DefaultValueComponent {
    
    // If app.name not found, use "DefaultApp"
    @Value("${app.name:DefaultApp}")
    private String appName;
    
    // Default port 8080
    @Value("${server.port:8080}")
    private int port;
    
    // Default true
    @Value("${app.enabled:true}")
    private boolean enabled;
    
    // Default max users
    @Value("${app.max-users:100}")
    private int maxUsers;
}
```

### Empty String Default

```java
@Component
public class EmptyDefaultComponent {
    
    // Empty string if not found
    @Value("${app.description:}")
    private String description;
    
    // Null if not found (for objects)
    @Value("${app.optional:#{null}}")
    private String optional;
}
```

### Default Collections

```java
@Component
public class DefaultCollectionComponent {
    
    // Default empty list
    @Value("${app.servers:}")
    private List<String> servers;
    
    // Default list with values
    @Value("${app.allowed-origins:http://localhost:3000,http://localhost:4200}")
    private List<String> allowedOrigins;
}
```

---

## üöÄ SpEL Expressions

Spring Expression Language (SpEL) provides powerful expressions.

### Arithmetic Operations

```java
@Component
public class SpELArithmeticComponent {
    
    // Addition
    @Value("#{100 + 50}")
    private int sum;  // 150
    
    // Subtraction
    @Value("#{100 - 30}")
    private int difference;  // 70
    
    // Multiplication
    @Value("#{10 * 5}")
    private int product;  // 50
    
    // Division
    @Value("#{100 / 4}")
    private int quotient;  // 25
    
    // Modulus
    @Value("#{100 % 30}")
    private int remainder;  // 10
    
    // Power
    @Value("#{T(java.lang.Math).pow(2, 3)}")
    private double power;  // 8.0
}
```

### Logical Operations

```java
@Component
public class SpELLogicalComponent {
    
    // AND
    @Value("#{true and false}")
    private boolean andResult;  // false
    
    // OR
    @Value("#{true or false}")
    private boolean orResult;  // true
    
    // NOT
    @Value("#{!true}")
    private boolean notResult;  // false
    
    // Ternary
    @Value("#{2 > 1 ? 'yes' : 'no'}")
    private String ternary;  // "yes"
}
```

### String Operations

```java
@Component
public class SpELStringComponent {
    
    // Concatenation
    @Value("#{'Hello' + ' ' + 'World'}")
    private String concat;  // "Hello World"
    
    // Substring
    @Value("#{'Hello World'.substring(0, 5)}")
    private String substring;  // "Hello"
    
    // Contains
    @Value("#{'Hello World'.contains('World')}")
    private boolean contains;  // true
    
    // Length
    @Value("#{'Hello'.length()}")
    private int length;  // 5
    
    // Upper/Lower case
    @Value("#{'hello'.toUpperCase()}")
    private String upper;  // "HELLO"
    
    @Value("#{'WORLD'.toLowerCase()}")
    private String lower;  // "world"
}
```

### Bean References

```java
@Component
public class ConfigService {
    public String getAppName() {
        return "MyApplication";
    }
    
    public int getMaxUsers() {
        return 100;
    }
}

@Component
public class SpELBeanComponent {
    
    // Reference bean method
    @Value("#{configService.getAppName()}")
    private String appName;
    
    @Value("#{configService.getMaxUsers()}")
    private int maxUsers;
    
    // Reference bean property
    @Value("#{systemProperties['user.name']}")
    private String username;
    
    @Value("#{systemProperties['java.version']}")
    private String javaVersion;
}
```

### Property Placeholders with SpEL

```java
@Component
public class MixedComponent {
    
    // Property + SpEL
    @Value("#{${app.max-users} * 2}")
    private int doubleMaxUsers;
    
    // Property with default + SpEL
    @Value("#{${app.rate:1.0} * 100}")
    private double percentage;
    
    // Conditional based on property
    @Value("#{${app.enabled:true} ? 'ON' : 'OFF'}")
    private String status;
}
```

### Static Method/Field Access

```java
@Component
public class SpELStaticComponent {
    
    // Static field
    @Value("#{T(java.lang.Math).PI}")
    private double pi;  // 3.14159...
    
    @Value("#{T(java.lang.Integer).MAX_VALUE}")
    private int maxInt;  // 2147483647
    
    // Static method
    @Value("#{T(java.lang.Math).random()}")
    private double random;
    
    @Value("#{T(java.lang.System).currentTimeMillis()}")
    private long timestamp;
    
    // Custom static
    @Value("#{T(com.example.Constants).APP_VERSION}")
    private String version;
}
```

---

## üñ•Ô∏è System Properties

### Accessing System Properties

```java
@Component
public class SystemPropertiesComponent {
    
    @Value("${user.name}")
    private String userName;
    
    @Value("${user.home}")
    private String userHome;
    
    @Value("${java.version}")
    private String javaVersion;
    
    @Value("${os.name}")
    private String osName;
    
    @Value("${file.separator}")
    private String fileSeparator;
    
    @Value("${path.separator}")
    private String pathSeparator;
}
```

### Setting System Properties

```bash
# Command line
java -Dapp.name=MyApp -Dserver.port=9090 -jar app.jar
```

```java
@Component
public class CustomSystemProperties {
    
    @Value("${app.name}")
    private String appName;  // From -Dapp.name
    
    @Value("${server.port}")
    private int port;  // From -Dserver.port
}
```

---

## üåç Environment Variables

### Accessing Environment Variables

```bash
# Set environment variables
export APP_NAME=MyApplication
export SERVER_PORT=8080
export DB_PASSWORD=secret123
```

```java
@Component
public class EnvironmentComponent {
    
    // Direct access
    @Value("${APP_NAME}")
    private String appName;
    
    @Value("${SERVER_PORT}")
    private int port;
    
    @Value("${DB_PASSWORD}")
    private String dbPassword;
    
    // With default
    @Value("${LOG_LEVEL:INFO}")
    private String logLevel;
}
```

### Relaxed Binding with Environment Variables

```bash
# Environment variable (uppercase with underscores)
export APP_MAX_USERS=100
```

```java
@Component
public class RelaxedBindingComponent {
    
    // All these work with APP_MAX_USERS
    @Value("${app.max-users:50}")
    private int maxUsers1;
    
    @Value("${app.maxUsers:50}")
    private int maxUsers2;
    
    @Value("${APP_MAX_USERS:50}")
    private int maxUsers3;
}
```

---

## üì¶ Collection Values

### List Values

```yaml
# application.yml
app:
  servers:
    - server1
    - server2
    - server3
```

```properties
# application.properties
app.servers=server1,server2,server3
```

```java
@Component
public class ListComponent {
    
    // YAML list
    @Value("${app.servers}")
    private List<String> servers;
    
    // With default
    @Value("${app.allowed-ips:127.0.0.1,192.168.1.1}")
    private List<String> allowedIps;
    
    // SpEL list
    @Value("#{{'value1', 'value2', 'value3'}}")
    private List<String> spelList;
    
    // Split string
    @Value("#{'${app.servers}'.split(',')}")
    private List<String> splitList;
}
```

### Array Values

```java
@Component
public class ArrayComponent {
    
    @Value("${app.servers}")
    private String[] servers;
    
    @Value("${app.ports:8080,8081,8082}")
    private int[] ports;
    
    // SpEL array
    @Value("#{new int[]{1, 2, 3, 4, 5}}")
    private int[] numbers;
}
```

### Set Values

```java
@Component
public class SetComponent {
    
    @Value("${app.servers}")
    private Set<String> servers;
    
    // SpEL set (removes duplicates)
    @Value("#{'a,b,c,a,b'.split(',')}")
    private Set<String> uniqueValues;
}
```

---

## üó∫Ô∏è Map Values

### Map from Properties

```yaml
# application.yml
app:
  database:
    url: jdbc:mysql://localhost:3306/db
    username: admin
    password: secret
```

```java
@Component
public class MapComponent {
    
    // Map values (requires custom processing)
    @Value("#{${app.database}}")
    private Map<String, String> database;
    
    // SpEL map
    @Value("#{{'key1':'value1', 'key2':'value2'}}")
    private Map<String, String> spelMap;
}
```

### Accessing Map Values

```java
@Component
public class MapAccessComponent {
    
    @Value("#{systemProperties}")
    private Map<String, String> systemProps;
    
    @Value("#{systemEnvironment}")
    private Map<String, String> envVars;
    
    // Access specific map entry
    @Value("#{systemProperties['user.name']}")
    private String userName;
    
    @Value("#{systemEnvironment['PATH']}")
    private String path;
}
```

---

## üîÑ Type Conversion

### Primitive Types

```yaml
app:
  count: 100
  rate: 4.5
  enabled: true
  initial: A
```

```java
@Component
public class PrimitiveComponent {
    
    @Value("${app.count}")
    private int intValue;
    
    @Value("${app.count}")
    private long longValue;
    
    @Value("${app.rate}")
    private double doubleValue;
    
    @Value("${app.rate}")
    private float floatValue;
    
    @Value("${app.enabled}")
    private boolean booleanValue;
    
    @Value("${app.initial}")
    private char charValue;
}
```

### Wrapper Types

```java
@Component
public class WrapperComponent {
    
    @Value("${app.count}")
    private Integer intValue;
    
    @Value("${app.count}")
    private Long longValue;
    
    @Value("${app.rate}")
    private Double doubleValue;
    
    @Value("${app.enabled}")
    private Boolean booleanValue;
}
```

### Date and Time

```yaml
app:
  start-date: 2024-01-01
  start-time: 10:30:00
  timestamp: 2024-01-01T10:30:00
```

```java
@Component
public class DateTimeComponent {
    
    // Using SpEL with SimpleDateFormat
    @Value("#{T(java.time.LocalDate).parse('${app.start-date}')}")
    private LocalDate startDate;
    
    @Value("#{T(java.time.LocalTime).parse('${app.start-time}')}")
    private LocalTime startTime;
    
    @Value("#{T(java.time.LocalDateTime).parse('${app.timestamp}')}")
    private LocalDateTime timestamp;
}
```

### Custom Type Conversion

```java
// Custom converter
@Component
public class StringToUserConverter implements Converter<String, User> {
    
    @Override
    public User convert(String source) {
        String[] parts = source.split(":");
        User user = new User();
        user.setName(parts[0]);
        user.setEmail(parts[1]);
        return user;
    }
}

// Usage
@Component
public class CustomConversionComponent {
    
    @Value("${app.admin:John:john@example.com}")
    private User admin;  // Converts "John:john@example.com" to User
}
```

---

## üèóÔ∏è Constructor and Method Injection

### Constructor Injection

```java
@Component
public class ConstructorInjectionComponent {
    
    private final String appName;
    private final int port;
    
    public ConstructorInjectionComponent(
            @Value("${app.name}") String appName,
            @Value("${server.port:8080}") int port) {
        this.appName = appName;
        this.port = port;
    }
}
```

### Method Injection

```java
@Component
public class MethodInjectionComponent {
    
    private String appName;
    private int port;
    
    @Autowired
    public void setConfig(
            @Value("${app.name}") String appName,
            @Value("${server.port:8080}") int port) {
        this.appName = appName;
        this.port = port;
    }
}
```

### Setter Injection

```java
@Component
public class SetterInjectionComponent {
    
    private String appName;
    private int port;
    
    @Value("${app.name}")
    public void setAppName(String appName) {
        this.appName = appName;
    }
    
    @Value("${server.port:8080}")
    public void setPort(int port) {
        this.port = port;
    }
}
```

---

## üìå Best Practices

### 1. Prefer @ConfigurationProperties for Complex Configuration

```java
// ‚úÖ For complex configuration
@ConfigurationProperties(prefix = "app")
public class AppProperties {
    private String name;
    private int maxUsers;
    private Database database;
    // ...
}

// ‚ùå Too many @Value annotations
@Component
public class AppComponent {
    @Value("${app.name}")
    private String name;
    
    @Value("${app.max-users}")
    private int maxUsers;
    
    @Value("${app.database.url}")
    private String dbUrl;
    // ... many more
}
```

### 2. Always Provide Default Values

```java
// ‚úÖ With default
@Value("${app.name:MyApp}")
private String appName;

@Value("${server.port:8080}")
private int port;

// ‚ùå No default - fails if property missing
@Value("${app.name}")
private String appName;
```

### 3. Use Constructor Injection for Immutability

```java
// ‚úÖ Immutable
@Component
public class ImmutableComponent {
    
    private final String appName;
    private final int port;
    
    public ImmutableComponent(
            @Value("${app.name:MyApp}") String appName,
            @Value("${server.port:8080}") int port) {
        this.appName = appName;
        this.port = port;
    }
}

// ‚ùå Mutable field injection
@Component
public class MutableComponent {
    @Value("${app.name:MyApp}")
    private String appName;
}
```

### 4. Use SpEL for Calculations

```java
// ‚úÖ Calculate at injection time
@Value("#{${app.max-users} * 2}")
private int doubleMaxUsers;

@Value("#{${app.timeout-seconds:30} * 1000}")
private long timeoutMillis;

// ‚ùå Calculate manually later
@Value("${app.max-users}")
private int maxUsers;

public int getDoubleMaxUsers() {
    return maxUsers * 2;  // Calculate every time
}
```

### 5. Be Careful with Escape Characters

```java
// ‚úÖ Properly escaped
@Value("${app.regex:\\d{3}-\\d{2}-\\d{4}}")
private String ssnRegex;

@Value("${app.path:C:\\\\Program Files\\\\App}")
private String windowsPath;

// ‚ùå Incorrect escaping
@Value("${app.regex:\d{3}-\d{2}-\d{4}}")
private String ssnRegex;  // Won't work
```

### 6. Use @Value for Simple Values Only

```java
// ‚úÖ Simple single value
@Value("${app.name:MyApp}")
private String appName;

@Value("${server.port:8080}")
private int port;

// ‚ùå Complex nested structure (use @ConfigurationProperties)
@Value("${app.database.connection.pool.max-size}")
private int poolSize;
```

### 7. Validate Injected Values

```java
@Component
public class ValidatedComponent {
    
    private final int port;
    
    public ValidatedComponent(@Value("${server.port:8080}") int port) {
        if (port < 1024 || port > 65535) {
            throw new IllegalArgumentException("Invalid port: " + port);
        }
        this.port = port;
    }
}
```

---

## üé§ Interview Questions

### Q1: What is @Value annotation?
**Answer:** Annotation for injecting property values into Spring beans from properties files, environment variables, or SpEL expressions.

### Q2: How to provide default value with @Value?
**Answer:** Use colon syntax:
```java
@Value("${app.name:DefaultApp}")
private String name;
```

### Q3: What is SpEL in @Value?
**Answer:** Spring Expression Language - powerful expression syntax for calculations, bean references, and conditional logic using `#{...}` syntax.

### Q4: Difference between ${} and #{}?
**Answer:**
- `${}`: Property placeholder (reads from properties)
- `#{}`: SpEL expression (calculations, bean references)

### Q5: Can @Value inject collections?
**Answer:** Yes, lists, sets, and arrays:
```java
@Value("${app.servers}")
private List<String> servers;
```

### Q6: How to inject system properties?
**Answer:**
```java
@Value("${user.name}")
private String userName;
```

### Q7: How to access bean methods in @Value?
**Answer:** Use SpEL:
```java
@Value("#{configService.getAppName()}")
private String appName;
```

### Q8: Can @Value be used with constructor injection?
**Answer:** Yes:
```java
public Component(@Value("${app.name}") String name) {
    this.name = name;
}
```

### Q9: When to use @Value vs @ConfigurationProperties?
**Answer:**
- **@Value**: Simple single values, SpEL needed
- **@ConfigurationProperties**: Multiple related properties, validation, type safety

### Q10: How to inject static values?
**Answer:** Use SpEL:
```java
@Value("#{T(java.lang.Math).PI}")
private double pi;
```

---

## üìö Summary

### Injection Syntaxes

```java
// Property placeholder
@Value("${property.name}")

// With default
@Value("${property.name:default}")

// SpEL expression
@Value("#{expression}")

// Mixed
@Value("#{${property} * 2}")
```

### Common Use Cases

```java
@Component
public class ComprehensiveExample {
    
    // Simple property
    @Value("${app.name:MyApp}")
    private String appName;
    
    // List
    @Value("${app.servers}")
    private List<String> servers;
    
    // SpEL calculation
    @Value("#{${app.max-users:100} * 2}")
    private int capacity;
    
    // Bean reference
    @Value("#{configService.getValue()}")
    private String configValue;
    
    // Static access
    @Value("#{T(java.lang.Math).PI}")
    private double pi;
    
    // System property
    @Value("${user.home}")
    private String userHome;
    
    // Environment variable
    @Value("${PATH}")
    private String path;
    
    // Conditional
    @Value("#{${app.enabled:true} ? 'ON' : 'OFF'}")
    private String status;
}
```

### Best Practices Summary

1. Provide default values
2. Use @ConfigurationProperties for complex configs
3. Prefer constructor injection
4. Use SpEL for calculations
5. Validate injected values
6. Properly escape special characters
7. Keep it simple - use @Value for simple values

### @Value vs @ConfigurationProperties

| Feature | @Value | @ConfigurationProperties |
|---------|--------|-------------------------|
| **Simple values** | ‚úÖ Best choice | ‚ö†Ô∏è Overkill |
| **Multiple related properties** | ‚ùå Verbose | ‚úÖ Best choice |
| **SpEL expressions** | ‚úÖ Yes | ‚ùå No |
| **Validation** | ‚ùå Manual | ‚úÖ Built-in |
| **Type safety** | ‚ö†Ô∏è Runtime | ‚úÖ Compile-time |
| **IDE support** | ‚ö†Ô∏è Limited | ‚úÖ Excellent |

**Next:** Profile-specific Configuration ‚Üí

