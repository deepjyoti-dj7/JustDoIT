# üåê Web Annotations - Complete Guide

## üìã Table of Contents
- [@RestController](#restcontroller)
- [@RequestMapping](#requestmapping)
- [HTTP Method Annotations](#http-method-annotations)
- [@RequestBody](#requestbody)
- [@ResponseBody](#responsebody)
- [@PathVariable](#pathvariable)
- [@RequestParam](#requestparam)
- [@RequestHeader](#requestheader)
- [@ResponseStatus](#responsestatus)
- [@ExceptionHandler](#exceptionhandler)
- [@ControllerAdvice](#controlleradvice)
- [@CrossOrigin](#crossorigin)
- [Best Practices](#best-practices)
- [Interview Questions](#interview-questions)

---

## üéÆ @RestController

Combination of **@Controller + @ResponseBody** for building RESTful web services.

### Basic Usage

```java
@RestController
@RequestMapping("/api/users")
public class UserController {
    
    private final UserService userService;
    
    public UserController(UserService userService) {
        this.userService = userService;
    }
    
    @GetMapping
    public List<User> getAllUsers() {
        return userService.findAll();
    }
    
    @GetMapping("/{id}")
    public User getUser(@PathVariable Long id) {
        return userService.findById(id);
    }
    
    @PostMapping
    public User createUser(@RequestBody UserDto userDto) {
        return userService.create(userDto);
    }
}
```

### @Controller vs @RestController

```java
// @Controller - Returns views
@Controller
public class WebController {
    
    @GetMapping("/home")
    public String home(Model model) {
        model.addAttribute("message", "Welcome");
        return "home";  // Returns view name
    }
}

// @RestController - Returns data
@RestController
public class ApiController {
    
    @GetMapping("/api/data")
    public Data getData() {
        return new Data();  // Returns JSON
    }
}

// @Controller + @ResponseBody = @RestController
@Controller
public class MixedController {
    
    @GetMapping("/page")
    public String page() {
        return "view";  // Returns view
    }
    
    @GetMapping("/api/data")
    @ResponseBody
    public Data data() {
        return new Data();  // Returns JSON
    }
}
```

### ResponseEntity for Control

```java
@RestController
@RequestMapping("/api/products")
public class ProductController {
    
    @GetMapping("/{id}")
    public ResponseEntity<Product> getProduct(@PathVariable Long id) {
        return productService.findById(id)
            .map(ResponseEntity::ok)
            .orElse(ResponseEntity.notFound().build());
    }
    
    @PostMapping
    public ResponseEntity<Product> createProduct(@RequestBody ProductDto dto) {
        Product product = productService.create(dto);
        URI location = URI.create("/api/products/" + product.getId());
        return ResponseEntity.created(location).body(product);
    }
    
    @DeleteMapping("/{id}")
    public ResponseEntity<Void> deleteProduct(@PathVariable Long id) {
        productService.delete(id);
        return ResponseEntity.noContent().build();
    }
}
```

---

## üó∫Ô∏è @RequestMapping

Maps HTTP requests to handler methods.

### Basic Usage

```java
@RestController
@RequestMapping("/api/users")
public class UserController {
    
    @RequestMapping(method = RequestMethod.GET)
    public List<User> getAllUsers() {
        return userService.findAll();
    }
    
    @RequestMapping(value = "/{id}", method = RequestMethod.GET)
    public User getUser(@PathVariable Long id) {
        return userService.findById(id);
    }
}
```

### Path Patterns

```java
@RestController
@RequestMapping("/api")
public class ApiController {
    
    // Exact match: /api/users
    @GetMapping("/users")
    public List<User> users() { }
    
    // Path variable: /api/users/123
    @GetMapping("/users/{id}")
    public User user(@PathVariable Long id) { }
    
    // Multiple path variables: /api/users/123/orders/456
    @GetMapping("/users/{userId}/orders/{orderId}")
    public Order userOrder(@PathVariable Long userId, @PathVariable Long orderId) { }
    
    // Wildcard: /api/files/documents/report.pdf
    @GetMapping("/files/**")
    public void downloadFile(HttpServletRequest request) { }
    
    // Regex: /api/products/P123
    @GetMapping("/products/{code:[A-Z]\\d+}")
    public Product product(@PathVariable String code) { }
}
```

### Request Parameters

```java
@RestController
@RequestMapping("/api/products")
public class ProductController {
    
    // Query parameters: /api/products/search?name=laptop&minPrice=1000
    @GetMapping(value = "/search", params = {"name", "minPrice"})
    public List<Product> search(
        @RequestParam String name,
        @RequestParam BigDecimal minPrice
    ) {
        return productService.search(name, minPrice);
    }
    
    // Specific param value
    @GetMapping(value = "/featured", params = "featured=true")
    public List<Product> featured() {
        return productService.findFeatured();
    }
}
```

### Header Matching

```java
@RestController
@RequestMapping("/api/data")
public class DataController {
    
    // Requires specific header
    @GetMapping(headers = "X-API-VERSION=1")
    public Data getDataV1() {
        return dataServiceV1.getData();
    }
    
    @GetMapping(headers = "X-API-VERSION=2")
    public Data getDataV2() {
        return dataServiceV2.getData();
    }
    
    // Content-Type
    @PostMapping(headers = "Content-Type=application/json")
    public void processJson(@RequestBody String json) { }
}
```

### Content Type (consumes/produces)

```java
@RestController
@RequestMapping("/api/content")
public class ContentController {
    
    // Consumes JSON
    @PostMapping(consumes = "application/json")
    public void processJson(@RequestBody Data data) { }
    
    // Consumes XML
    @PostMapping(consumes = "application/xml")
    public void processXml(@RequestBody Data data) { }
    
    // Produces JSON
    @GetMapping(produces = "application/json")
    public Data getJson() {
        return new Data();
    }
    
    // Produces XML
    @GetMapping(produces = "application/xml")
    public Data getXml() {
        return new Data();
    }
    
    // Multiple content types
    @GetMapping(produces = {"application/json", "application/xml"})
    public Data getData() {
        return new Data();
    }
}
```

---

## üî§ HTTP Method Annotations

Shortcuts for **@RequestMapping** with specific HTTP methods.

### @GetMapping

```java
@RestController
@RequestMapping("/api/users")
public class UserController {
    
    // GET /api/users
    @GetMapping
    public List<User> getAllUsers() {
        return userService.findAll();
    }
    
    // GET /api/users/123
    @GetMapping("/{id}")
    public User getUser(@PathVariable Long id) {
        return userService.findById(id);
    }
    
    // GET /api/users/search?name=john&age=25
    @GetMapping("/search")
    public List<User> search(
        @RequestParam String name,
        @RequestParam(required = false) Integer age
    ) {
        return userService.search(name, age);
    }
}
```

### @PostMapping

```java
@RestController
@RequestMapping("/api/users")
public class UserController {
    
    // POST /api/users
    @PostMapping
    public ResponseEntity<User> createUser(@Valid @RequestBody UserDto userDto) {
        User user = userService.create(userDto);
        URI location = URI.create("/api/users/" + user.getId());
        return ResponseEntity.created(location).body(user);
    }
    
    // POST /api/users/batch
    @PostMapping("/batch")
    public List<User> createUsers(@RequestBody List<UserDto> users) {
        return userService.createBatch(users);
    }
}
```

### @PutMapping

```java
@RestController
@RequestMapping("/api/users")
public class UserController {
    
    // PUT /api/users/123 (Full update)
    @PutMapping("/{id}")
    public User updateUser(
        @PathVariable Long id,
        @Valid @RequestBody UserDto userDto
    ) {
        return userService.update(id, userDto);
    }
}
```

### @PatchMapping

```java
@RestController
@RequestMapping("/api/users")
public class UserController {
    
    // PATCH /api/users/123 (Partial update)
    @PatchMapping("/{id}")
    public User partialUpdate(
        @PathVariable Long id,
        @RequestBody Map<String, Object> updates
    ) {
        return userService.partialUpdate(id, updates);
    }
    
    // PATCH /api/users/123/email
    @PatchMapping("/{id}/email")
    public User updateEmail(
        @PathVariable Long id,
        @RequestParam String email
    ) {
        return userService.updateEmail(id, email);
    }
}
```

### @DeleteMapping

```java
@RestController
@RequestMapping("/api/users")
public class UserController {
    
    // DELETE /api/users/123
    @DeleteMapping("/{id}")
    public ResponseEntity<Void> deleteUser(@PathVariable Long id) {
        userService.delete(id);
        return ResponseEntity.noContent().build();
    }
    
    // DELETE /api/users?ids=1,2,3
    @DeleteMapping
    public ResponseEntity<Void> deleteUsers(@RequestParam List<Long> ids) {
        userService.deleteAll(ids);
        return ResponseEntity.noContent().build();
    }
}
```

### Comparison

| Annotation | HTTP Method | Purpose | Idempotent |
|------------|-------------|---------|------------|
| **@GetMapping** | GET | Retrieve data | ‚úÖ Yes |
| **@PostMapping** | POST | Create resource | ‚ùå No |
| **@PutMapping** | PUT | Full update | ‚úÖ Yes |
| **@PatchMapping** | PATCH | Partial update | ‚ùå No |
| **@DeleteMapping** | DELETE | Remove resource | ‚úÖ Yes |

---

## üì• @RequestBody

Binds HTTP request body to a method parameter.

### Basic Usage

```java
@RestController
@RequestMapping("/api/users")
public class UserController {
    
    @PostMapping
    public User createUser(@RequestBody UserDto userDto) {
        return userService.create(userDto);
    }
}

// Request
POST /api/users
Content-Type: application/json

{
  "username": "john",
  "email": "john@example.com",
  "age": 25
}
```

### With Validation

```java
@RestController
@RequestMapping("/api/products")
public class ProductController {
    
    @PostMapping
    public Product createProduct(@Valid @RequestBody ProductDto dto) {
        return productService.create(dto);
    }
}

// DTO with validation
public class ProductDto {
    @NotBlank(message = "Name is required")
    private String name;
    
    @NotNull(message = "Price is required")
    @DecimalMin(value = "0.01", message = "Price must be positive")
    private BigDecimal price;
    
    @Min(value = 0, message = "Stock cannot be negative")
    private Integer stock;
}
```

### Optional Request Body

```java
@RestController
public class DataController {
    
    @PostMapping("/api/data")
    public Data processData(@RequestBody(required = false) DataDto data) {
        if (data == null) {
            data = new DataDto();  // Use defaults
        }
        return dataService.process(data);
    }
}
```

### List/Collection Request Body

```java
@RestController
@RequestMapping("/api/users")
public class UserController {
    
    @PostMapping("/batch")
    public List<User> createUsers(@RequestBody List<UserDto> users) {
        return userService.createBatch(users);
    }
}

// Request
POST /api/users/batch
[
  {"username": "john", "email": "john@example.com"},
  {"username": "jane", "email": "jane@example.com"}
]
```

---

## üì§ @ResponseBody

Indicates return value should be **serialized to response body**.

### Basic Usage

```java
@Controller
public class DataController {
    
    @GetMapping("/api/data")
    @ResponseBody
    public Data getData() {
        return new Data();  // Serialized to JSON
    }
    
    @GetMapping("/page")
    public String getPage() {
        return "view";  // Returns view name (no @ResponseBody)
    }
}
```

### Not Needed with @RestController

```java
// @RestController already includes @ResponseBody
@RestController
public class ApiController {
    
    @GetMapping("/api/users")
    public List<User> getUsers() {
        return userService.findAll();  // Automatically serialized
    }
}
```

---

## üõ§Ô∏è @PathVariable

Extracts values from URI path.

### Basic Usage

```java
@RestController
@RequestMapping("/api/users")
public class UserController {
    
    // /api/users/123
    @GetMapping("/{id}")
    public User getUser(@PathVariable Long id) {
        return userService.findById(id);
    }
}
```

### Multiple Path Variables

```java
@RestController
@RequestMapping("/api")
public class OrderController {
    
    // /api/users/123/orders/456
    @GetMapping("/users/{userId}/orders/{orderId}")
    public Order getUserOrder(
        @PathVariable Long userId,
        @PathVariable Long orderId
    ) {
        return orderService.findByUserAndOrder(userId, orderId);
    }
}
```

### Named Path Variables

```java
@RestController
public class ProductController {
    
    // /api/products/category/electronics/item/laptop
    @GetMapping("/api/products/category/{cat}/item/{item}")
    public Product getProduct(
        @PathVariable("cat") String category,
        @PathVariable("item") String itemName
    ) {
        return productService.findByCategoryAndName(category, itemName);
    }
}
```

### Optional Path Variables

```java
@RestController
public class FileController {
    
    // /api/files or /api/files/documents/report.pdf
    @GetMapping({"/api/files", "/api/files/**"})
    public void downloadFile(
        @PathVariable(required = false) String path
    ) {
        fileService.download(path != null ? path : "default");
    }
}
```

### Regex Constraints

```java
@RestController
@RequestMapping("/api")
public class ValidationController {
    
    // Only allows numeric IDs
    @GetMapping("/users/{id:[0-9]+}")
    public User getUser(@PathVariable Long id) {
        return userService.findById(id);
    }
    
    // Matches product codes like P123, P456
    @GetMapping("/products/{code:[A-Z]\\d+}")
    public Product getProduct(@PathVariable String code) {
        return productService.findByCode(code);
    }
}
```

### Map All Path Variables

```java
@RestController
public class DynamicController {
    
    @GetMapping("/api/data/{var1}/{var2}")
    public Map<String, String> getData(@PathVariable Map<String, String> pathVars) {
        // pathVars contains: {var1=value1, var2=value2}
        return pathVars;
    }
}
```

---

## üîç @RequestParam

Extracts query parameters from URL.

### Basic Usage

```java
@RestController
@RequestMapping("/api/products")
public class ProductController {
    
    // /api/products/search?name=laptop
    @GetMapping("/search")
    public List<Product> search(@RequestParam String name) {
        return productService.searchByName(name);
    }
}
```

### Optional Parameters

```java
@RestController
@RequestMapping("/api/products")
public class ProductController {
    
    // /api/products?page=0&size=10&sort=name
    @GetMapping
    public Page<Product> getProducts(
        @RequestParam(defaultValue = "0") int page,
        @RequestParam(defaultValue = "10") int size,
        @RequestParam(required = false) String sort
    ) {
        return productService.findAll(page, size, sort);
    }
}
```

### Named Parameters

```java
@RestController
public class SearchController {
    
    // /api/search?q=laptop&max=50
    @GetMapping("/api/search")
    public List<Product> search(
        @RequestParam("q") String query,
        @RequestParam(name = "max", defaultValue = "20") int maxResults
    ) {
        return searchService.search(query, maxResults);
    }
}
```

### Collection Parameters

```java
@RestController
@RequestMapping("/api/products")
public class ProductController {
    
    // /api/products/filter?categories=electronics,books,toys
    @GetMapping("/filter")
    public List<Product> filter(
        @RequestParam List<String> categories
    ) {
        return productService.findByCategories(categories);
    }
    
    // /api/products/delete?ids=1&ids=2&ids=3
    @DeleteMapping("/delete")
    public void deleteMultiple(@RequestParam List<Long> ids) {
        productService.deleteAll(ids);
    }
}
```

### Map All Parameters

```java
@RestController
public class DynamicController {
    
    @GetMapping("/api/search")
    public List<Product> search(@RequestParam Map<String, String> params) {
        // params contains all query parameters
        return searchService.dynamicSearch(params);
    }
}
```

---

## üìã @RequestHeader

Extracts HTTP header values.

### Basic Usage

```java
@RestController
@RequestMapping("/api")
public class HeaderController {
    
    @GetMapping("/data")
    public Data getData(@RequestHeader("X-API-KEY") String apiKey) {
        if (!authService.validateApiKey(apiKey)) {
            throw new UnauthorizedException();
        }
        return dataService.getData();
    }
}
```

### Optional Headers

```java
@RestController
public class VersionController {
    
    @GetMapping("/api/data")
    public Data getData(
        @RequestHeader(value = "X-API-VERSION", defaultValue = "1") String version
    ) {
        if ("2".equals(version)) {
            return dataServiceV2.getData();
        }
        return dataServiceV1.getData();
    }
}
```

### Multiple Headers

```java
@RestController
public class SecurityController {
    
    @PostMapping("/api/secure")
    public Response secureEndpoint(
        @RequestHeader("Authorization") String auth,
        @RequestHeader("X-Request-ID") String requestId,
        @RequestHeader(value = "X-Forwarded-For", required = false) String clientIp
    ) {
        log.info("Request ID: {}, Client IP: {}", requestId, clientIp);
        return processRequest(auth);
    }
}
```

### All Headers

```java
@RestController
public class DebugController {
    
    @GetMapping("/api/debug")
    public Map<String, String> debug(@RequestHeader Map<String, String> headers) {
        return headers;  // Returns all request headers
    }
    
    @GetMapping("/api/headers")
    public HttpHeaders getHeaders(@RequestHeader HttpHeaders headers) {
        return headers;  // Spring HttpHeaders object
    }
}
```

---

## üìä @ResponseStatus

Sets HTTP status code for response.

### Basic Usage

```java
@RestController
@RequestMapping("/api/users")
public class UserController {
    
    @PostMapping
    @ResponseStatus(HttpStatus.CREATED)  // 201
    public User createUser(@RequestBody UserDto dto) {
        return userService.create(dto);
    }
    
    @DeleteMapping("/{id}")
    @ResponseStatus(HttpStatus.NO_CONTENT)  // 204
    public void deleteUser(@PathVariable Long id) {
        userService.delete(id);
    }
}
```

### Custom Exception

```java
@ResponseStatus(HttpStatus.NOT_FOUND)
public class ResourceNotFoundException extends RuntimeException {
    public ResourceNotFoundException(String message) {
        super(message);
    }
}

@RestController
public class ProductController {
    
    @GetMapping("/api/products/{id}")
    public Product getProduct(@PathVariable Long id) {
        return productService.findById(id)
            .orElseThrow(() -> new ResourceNotFoundException("Product not found"));
        // Automatically returns 404
    }
}
```

---

## üö® @ExceptionHandler

Handles exceptions in controller.

### Basic Usage

```java
@RestController
@RequestMapping("/api/users")
public class UserController {
    
    @GetMapping("/{id}")
    public User getUser(@PathVariable Long id) {
        return userService.findById(id)
            .orElseThrow(() -> new UserNotFoundException(id));
    }
    
    @ExceptionHandler(UserNotFoundException.class)
    public ResponseEntity<ErrorResponse> handleNotFound(UserNotFoundException ex) {
        ErrorResponse error = new ErrorResponse(
            HttpStatus.NOT_FOUND.value(),
            ex.getMessage(),
            LocalDateTime.now()
        );
        return ResponseEntity.status(HttpStatus.NOT_FOUND).body(error);
    }
    
    @ExceptionHandler(IllegalArgumentException.class)
    public ResponseEntity<ErrorResponse> handleBadRequest(IllegalArgumentException ex) {
        ErrorResponse error = new ErrorResponse(
            HttpStatus.BAD_REQUEST.value(),
            ex.getMessage(),
            LocalDateTime.now()
        );
        return ResponseEntity.badRequest().body(error);
    }
}
```

### Multiple Exceptions

```java
@RestController
public class OrderController {
    
    @ExceptionHandler({OrderNotFoundException.class, ProductNotFoundException.class})
    public ResponseEntity<ErrorResponse> handleNotFound(RuntimeException ex) {
        ErrorResponse error = new ErrorResponse(404, ex.getMessage());
        return ResponseEntity.status(HttpStatus.NOT_FOUND).body(error);
    }
}
```

---

## üõ°Ô∏è @ControllerAdvice

Global exception handling across all controllers.

### Basic Usage

```java
@ControllerAdvice
public class GlobalExceptionHandler {
    
    @ExceptionHandler(ResourceNotFoundException.class)
    public ResponseEntity<ErrorResponse> handleNotFound(ResourceNotFoundException ex) {
        ErrorResponse error = new ErrorResponse(
            HttpStatus.NOT_FOUND.value(),
            ex.getMessage(),
            LocalDateTime.now()
        );
        return ResponseEntity.status(HttpStatus.NOT_FOUND).body(error);
    }
    
    @ExceptionHandler(MethodArgumentNotValidException.class)
    public ResponseEntity<Map<String, String>> handleValidation(
            MethodArgumentNotValidException ex) {
        Map<String, String> errors = new HashMap<>();
        ex.getBindingResult().getFieldErrors().forEach(error ->
            errors.put(error.getField(), error.getDefaultMessage())
        );
        return ResponseEntity.badRequest().body(errors);
    }
    
    @ExceptionHandler(Exception.class)
    public ResponseEntity<ErrorResponse> handleGeneral(Exception ex) {
        ErrorResponse error = new ErrorResponse(
            HttpStatus.INTERNAL_SERVER_ERROR.value(),
            "An error occurred",
            LocalDateTime.now()
        );
        return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body(error);
    }
}
```

### Scoped to Specific Controllers

```java
@ControllerAdvice(assignableTypes = {UserController.class, ProductController.class})
public class ApiExceptionHandler {
    // Only handles exceptions from UserController and ProductController
}

@ControllerAdvice(basePackages = "com.example.api")
public class ApiPackageExceptionHandler {
    // Only handles exceptions from controllers in com.example.api package
}

@ControllerAdvice(annotations = RestController.class)
public class RestControllerExceptionHandler {
    // Only handles exceptions from @RestController classes
}
```

### Complete Example

```java
@ControllerAdvice
@Slf4j
public class GlobalExceptionHandler {
    
    @ExceptionHandler(ResourceNotFoundException.class)
    @ResponseStatus(HttpStatus.NOT_FOUND)
    public ErrorResponse handleNotFound(ResourceNotFoundException ex) {
        log.error("Resource not found: {}", ex.getMessage());
        return new ErrorResponse(404, ex.getMessage());
    }
    
    @ExceptionHandler(AccessDeniedException.class)
    @ResponseStatus(HttpStatus.FORBIDDEN)
    public ErrorResponse handleAccessDenied(AccessDeniedException ex) {
        log.error("Access denied: {}", ex.getMessage());
        return new ErrorResponse(403, "Access denied");
    }
    
    @ExceptionHandler(MethodArgumentNotValidException.class)
    @ResponseStatus(HttpStatus.BAD_REQUEST)
    public ValidationErrorResponse handleValidation(MethodArgumentNotValidException ex) {
        Map<String, String> errors = new HashMap<>();
        ex.getBindingResult().getFieldErrors().forEach(error ->
            errors.put(error.getField(), error.getDefaultMessage())
        );
        return new ValidationErrorResponse(400, "Validation failed", errors);
    }
    
    @ExceptionHandler(Exception.class)
    @ResponseStatus(HttpStatus.INTERNAL_SERVER_ERROR)
    public ErrorResponse handleGeneral(Exception ex) {
        log.error("Unexpected error", ex);
        return new ErrorResponse(500, "An unexpected error occurred");
    }
}

@Data
@AllArgsConstructor
class ErrorResponse {
    private int status;
    private String message;
    private LocalDateTime timestamp = LocalDateTime.now();
    
    public ErrorResponse(int status, String message) {
        this.status = status;
        this.message = message;
    }
}
```

---

## üåç @CrossOrigin

Enables **Cross-Origin Resource Sharing (CORS)**.

### Basic Usage

```java
@RestController
@RequestMapping("/api/users")
@CrossOrigin(origins = "http://localhost:3000")
public class UserController {
    
    @GetMapping
    public List<User> getUsers() {
        return userService.findAll();
    }
}
```

### Method-Level CORS

```java
@RestController
@RequestMapping("/api/products")
public class ProductController {
    
    @CrossOrigin(origins = "http://localhost:3000")
    @GetMapping
    public List<Product> getProducts() {
        return productService.findAll();
    }
    
    @CrossOrigin(origins = {"http://localhost:3000", "https://app.example.com"})
    @PostMapping
    public Product createProduct(@RequestBody ProductDto dto) {
        return productService.create(dto);
    }
}
```

### Advanced Configuration

```java
@RestController
@RequestMapping("/api/data")
@CrossOrigin(
    origins = {"http://localhost:3000", "https://app.example.com"},
    methods = {RequestMethod.GET, RequestMethod.POST},
    allowedHeaders = {"Authorization", "Content-Type"},
    exposedHeaders = {"X-Total-Count"},
    allowCredentials = "true",
    maxAge = 3600
)
public class DataController {
}
```

### Global CORS Configuration

```java
@Configuration
public class WebConfig implements WebMvcConfigurer {
    
    @Override
    public void addCorsMappings(CorsRegistry registry) {
        registry.addMapping("/api/**")
            .allowedOrigins("http://localhost:3000", "https://app.example.com")
            .allowedMethods("GET", "POST", "PUT", "DELETE", "OPTIONS")
            .allowedHeaders("*")
            .allowCredentials(true)
            .maxAge(3600);
    }
}
```

---

## üìå Best Practices

### 1. RESTful URL Design

```java
// ‚úÖ Good - RESTful design
@RestController
@RequestMapping("/api/users")
public class UserController {
    @GetMapping                          // GET /api/users
    @GetMapping("/{id}")                 // GET /api/users/123
    @PostMapping                         // POST /api/users
    @PutMapping("/{id}")                 // PUT /api/users/123
    @DeleteMapping("/{id}")              // DELETE /api/users/123
}

// ‚ùå Bad - non-RESTful
@RestController
public class UserController {
    @GetMapping("/getAllUsers")
    @GetMapping("/getUserById")
    @PostMapping("/createUser")
    @PostMapping("/updateUser")
    @PostMapping("/deleteUser")
}
```

### 2. Use Appropriate HTTP Methods

```java
// ‚úÖ Correct
@GetMapping("/{id}")          // Read
@PostMapping                  // Create
@PutMapping("/{id}")          // Full update
@PatchMapping("/{id}")        // Partial update
@DeleteMapping("/{id}")       // Delete

// ‚ùå Incorrect
@PostMapping("/getUser")      // Should be GET
@GetMapping("/createUser")    // Should be POST
```

### 3. Validate Input

```java
// ‚úÖ Always validate
@PostMapping
public User createUser(@Valid @RequestBody UserDto dto) {
    return userService.create(dto);
}

// DTO with validation
public class UserDto {
    @NotBlank
    @Size(min = 3, max = 50)
    private String username;
    
    @Email
    private String email;
}
```

### 4. Use ResponseEntity for Control

```java
// ‚úÖ Fine control over response
@GetMapping("/{id}")
public ResponseEntity<User> getUser(@PathVariable Long id) {
    return userService.findById(id)
        .map(user -> ResponseEntity.ok()
            .header("X-User-Status", user.getStatus())
            .body(user))
        .orElse(ResponseEntity.notFound().build());
}
```

### 5. Global Exception Handling

```java
// ‚úÖ Centralized error handling
@ControllerAdvice
public class GlobalExceptionHandler {
    @ExceptionHandler(ResourceNotFoundException.class)
    public ResponseEntity<ErrorResponse> handleNotFound(ResourceNotFoundException ex) {
        return ResponseEntity.status(HttpStatus.NOT_FOUND)
            .body(new ErrorResponse(404, ex.getMessage()));
    }
}
```

---

## üé§ Interview Questions

### Q1: Difference between @Controller and @RestController?
**Answer:** @RestController = @Controller + @ResponseBody. Returns data (JSON/XML) instead of view names.

### Q2: What is @RequestMapping?
**Answer:** Maps HTTP requests to handler methods. Can specify URL, HTTP method, headers, params, consumes, produces.

### Q3: @PathVariable vs @RequestParam?
**Answer:**
- **@PathVariable**: Extracts from URL path (`/users/{id}`)
- **@RequestParam**: Extracts from query string (`/users?id=123`)

### Q4: What is @RequestBody?
**Answer:** Binds HTTP request body to method parameter. Automatically deserializes JSON/XML to Java object.

### Q5: What is @ControllerAdvice?
**Answer:** Global exception handler for all controllers. Centralized error handling across the application.

### Q6: How to enable CORS?
**Answer:** Use @CrossOrigin annotation or configure globally in WebMvcConfigurer.

### Q7: What is @ResponseStatus?
**Answer:** Sets HTTP status code for response. Can be used on methods or exception classes.

### Q8: Difference between @PutMapping and @PatchMapping?
**Answer:**
- **PUT**: Full resource update (replace entire resource)
- **PATCH**: Partial update (modify specific fields)

### Q9: What is @ExceptionHandler?
**Answer:** Handles specific exceptions in controller. Returns custom error responses.

### Q10: How to make @RequestParam optional?
**Answer:**
```java
@RequestParam(required = false) String param
// or
@RequestParam(defaultValue = "default") String param
```

---

## üìö Summary

### Key Annotations
- **@RestController**: REST API controller
- **@RequestMapping**: Map HTTP requests
- **@GetMapping/@PostMapping/@PutMapping/@PatchMapping/@DeleteMapping**: HTTP methods
- **@RequestBody**: Request body binding
- **@PathVariable**: URL path extraction
- **@RequestParam**: Query parameter extraction
- **@RequestHeader**: HTTP header extraction
- **@ResponseStatus**: Set HTTP status
- **@ExceptionHandler**: Handle exceptions
- **@ControllerAdvice**: Global exception handling
- **@CrossOrigin**: Enable CORS

### Best Practices
1. **RESTful** URL design
2. **Validate** all inputs
3. Use **appropriate** HTTP methods
4. **Global** exception handling
5. **ResponseEntity** for fine control

### Complete REST Controller

```java
@RestController
@RequestMapping("/api/users")
@RequiredArgsConstructor
@Validated
public class UserController {
    
    private final UserService userService;
    
    @GetMapping
    public Page<User> getUsers(
        @RequestParam(defaultValue = "0") int page,
        @RequestParam(defaultValue = "10") int size
    ) {
        return userService.findAll(page, size);
    }
    
    @GetMapping("/{id}")
    public ResponseEntity<User> getUser(@PathVariable Long id) {
        return userService.findById(id)
            .map(ResponseEntity::ok)
            .orElse(ResponseEntity.notFound().build());
    }
    
    @PostMapping
    @ResponseStatus(HttpStatus.CREATED)
    public User createUser(@Valid @RequestBody UserDto dto) {
        return userService.create(dto);
    }
    
    @PutMapping("/{id}")
    public User updateUser(
        @PathVariable Long id,
        @Valid @RequestBody UserDto dto
    ) {
        return userService.update(id, dto);
    }
    
    @DeleteMapping("/{id}")
    @ResponseStatus(HttpStatus.NO_CONTENT)
    public void deleteUser(@PathVariable Long id) {
        userService.delete(id);
    }
}

@ControllerAdvice
class GlobalExceptionHandler {
    @ExceptionHandler(ResourceNotFoundException.class)
    public ResponseEntity<ErrorResponse> handleNotFound(ResourceNotFoundException ex) {
        return ResponseEntity.status(HttpStatus.NOT_FOUND)
            .body(new ErrorResponse(404, ex.getMessage()));
    }
}
```

**Next:** Data Annotations ‚Üí

