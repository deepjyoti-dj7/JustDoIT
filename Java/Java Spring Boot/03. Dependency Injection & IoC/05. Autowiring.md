# üîó Autowiring in Spring - Complete Guide

## üìã Table of Contents
- [What is Autowiring?](#what-is-autowiring)
- [@Autowired Annotation](#autowired-annotation)
- [Autowiring Modes](#autowiring-modes)
- [Constructor Autowiring](#constructor-autowiring)
- [Setter Autowiring](#setter-autowiring)
- [Field Autowiring](#field-autowiring)
- [Required vs Optional](#required-vs-optional)
- [Autowiring with Collections](#autowiring-with-collections)
- [Autowiring Ambiguity](#autowiring-ambiguity)
- [@Inject vs @Autowired](#inject-vs-autowired)
- [Best Practices](#best-practices)
- [Interview Questions](#interview-questions)

---

## üéØ What is Autowiring?

**Autowiring** is Spring's mechanism to automatically inject dependencies into beans without explicit configuration.

### Without Autowiring (Manual)

```java
@Configuration
public class AppConfig {
    @Bean
    public UserRepository userRepository() {
        return new UserRepositoryImpl();
    }
    
    @Bean
    public UserService userService() {
        return new UserService(userRepository());  // Manual wiring
    }
}
```

### With Autowiring (Automatic)

```java
@Service
public class UserService {
    private final UserRepository repository;
    
    @Autowired  // Automatic wiring
    public UserService(UserRepository repository) {
        this.repository = repository;
    }
}
```

Spring automatically finds and injects the `UserRepository` bean!

---

## üè∑Ô∏è @Autowired Annotation

### Basic Usage

```java
@Component
public class OrderService {
    // Constructor injection
    @Autowired
    public OrderService(OrderRepository repository) {
        this.repository = repository;
    }
    
    // Setter injection
    @Autowired
    public void setEmailService(EmailService emailService) {
        this.emailService = emailService;
    }
    
    // Field injection
    @Autowired
    private PaymentService paymentService;
}
```

### Where @Autowired Can Be Applied

```java
@Component
public class Example {
    // 1. Fields
    @Autowired
    private UserRepository repository;
    
    // 2. Constructors
    @Autowired
    public Example(UserRepository repository) {
        this.repository = repository;
    }
    
    // 3. Setters
    @Autowired
    public void setEmailService(EmailService email) {
        this.emailService = email;
    }
    
    // 4. Regular methods
    @Autowired
    public void init(DataSource dataSource, Cache cache) {
        this.dataSource = dataSource;
        this.cache = cache;
    }
}
```

---

## üî¢ Autowiring Modes

Spring supports different autowiring modes:

### 1. **byType** (Default)

Autowire by matching **type** (class/interface).

```java
public interface UserRepository { }

@Repository
public class UserRepositoryImpl implements UserRepository { }

@Service
public class UserService {
    private final UserRepository repository;
    
    @Autowired  // Finds bean by type: UserRepository
    public UserService(UserRepository repository) {
        this.repository = repository;
    }
}
```

### 2. **byName**

Autowire by matching **parameter name** to **bean name**.

```java
@Repository("userRepo")
public class UserRepositoryImpl implements UserRepository { }

@Service
public class UserService {
    @Autowired
    public void setUserRepo(UserRepository userRepo) {  // Matches bean name
        this.repository = userRepo;
    }
}
```

### 3. **constructor** (Recommended)

```java
@Service
public class UserService {
    private final UserRepository repository;
    
    // Constructor autowiring - automatic since Spring 4.3
    public UserService(UserRepository repository) {
        this.repository = repository;
    }
}
```

### 4. **no** (Disabled)

```java
// Manual wiring in @Configuration
@Bean
public UserService userService() {
    return new UserService(userRepository());
}
```

---

## üèóÔ∏è Constructor Autowiring

### Implicit Autowiring (Spring 4.3+)

```java
@Service
public class UserService {
    private final UserRepository repository;
    
    // @Autowired optional if single constructor
    public UserService(UserRepository repository) {
        this.repository = repository;
    }
}
```

### Multiple Parameters

```java
@Service
public class OrderService {
    private final OrderRepository orderRepo;
    private final PaymentService paymentService;
    private final EmailService emailService;
    
    public OrderService(OrderRepository orderRepo,
                       PaymentService paymentService,
                       EmailService emailService) {
        this.orderRepo = orderRepo;
        this.paymentService = paymentService;
        this.emailService = emailService;
    }
}
```

### Multiple Constructors

```java
@Service
public class UserService {
    private final UserRepository repository;
    private final EmailService emailService;
    
    // Primary constructor
    @Autowired
    public UserService(UserRepository repository, 
                      EmailService emailService) {
        this.repository = repository;
        this.emailService = emailService;
    }
    
    // Not used by Spring (no @Autowired)
    public UserService(UserRepository repository) {
        this(repository, new DefaultEmailService());
    }
}
```

### With Lombok

```java
@Service
@RequiredArgsConstructor
public class UserService {
    private final UserRepository repository;
    private final EmailService emailService;
    
    // Constructor auto-generated and autowired
}
```

---

## ‚öôÔ∏è Setter Autowiring

### Basic Setter Injection

```java
@Service
public class NotificationService {
    private EmailService emailService;
    private SmsService smsService;
    
    @Autowired
    public void setEmailService(EmailService emailService) {
        this.emailService = emailService;
    }
    
    @Autowired
    public void setSmsService(SmsService smsService) {
        this.smsService = smsService;
    }
}
```

### Method Injection (Multiple Parameters)

```java
@Service
public class ReportService {
    private DataSource dataSource;
    private TemplateEngine templateEngine;
    
    @Autowired
    public void configure(DataSource dataSource, 
                         TemplateEngine templateEngine) {
        this.dataSource = dataSource;
        this.templateEngine = templateEngine;
    }
}
```

---

## üìå Field Autowiring

### Basic Field Injection

```java
@Service
public class UserService {
    @Autowired
    private UserRepository repository;
    
    @Autowired
    private EmailService emailService;
}
```

**Note:** Not recommended! Use constructor injection instead.

---

## ‚ö†Ô∏è Required vs Optional

### Required (Default)

```java
@Service
public class UserService {
    private final UserRepository repository;
    
    @Autowired  // required = true by default
    public UserService(UserRepository repository) {
        this.repository = repository;
    }
}

// If UserRepository bean not found:
// Error: NoSuchBeanDefinitionException
```

### Optional Dependencies

#### Option 1: required = false

```java
@Service
public class NotificationService {
    private EmailService emailService;
    
    @Autowired(required = false)
    public void setEmailService(EmailService emailService) {
        this.emailService = emailService;
    }
    
    public void notify(String message) {
        if (emailService != null) {
            emailService.send(message);
        }
    }
}
```

#### Option 2: Optional<T>

```java
@Service
public class UserService {
    private final UserRepository repository;
    private final EmailService emailService;
    
    public UserService(UserRepository repository,
                      Optional<EmailService> emailService) {
        this.repository = repository;
        this.emailService = emailService.orElse(new DefaultEmailService());
    }
}
```

#### Option 3: @Nullable

```java
@Service
public class UserService {
    private final UserRepository repository;
    private final EmailService emailService;
    
    public UserService(UserRepository repository,
                      @Nullable EmailService emailService) {
        this.repository = repository;
        this.emailService = emailService != null 
            ? emailService 
            : new DefaultEmailService();
    }
}
```

### Comparison

| Approach | Null Check | Default Value | Readability |
|----------|-----------|---------------|-------------|
| `required = false` | Manual | ‚úÖ | Good |
| `Optional<T>` | Automatic | ‚úÖ | Best |
| `@Nullable` | Manual | ‚úÖ | Good |

---

## üì¶ Autowiring with Collections

### Injecting List of Beans

```java
public interface NotificationService {
    void send(String message);
}

@Component
public class EmailNotification implements NotificationService { }

@Component
public class SmsNotification implements NotificationService { }

@Component
public class PushNotification implements NotificationService { }

@Service
public class NotificationDispatcher {
    private final List<NotificationService> services;
    
    @Autowired
    public NotificationDispatcher(List<NotificationService> services) {
        this.services = services;  // All 3 implementations injected
    }
    
    public void notifyAll(String message) {
        services.forEach(service -> service.send(message));
    }
}
```

### Injecting Map of Beans

```java
@Service
public class PaymentProcessor {
    private final Map<String, PaymentGateway> gateways;
    
    @Autowired
    public PaymentProcessor(Map<String, PaymentGateway> gateways) {
        this.gateways = gateways;  // Key = bean name, Value = bean
    }
    
    public void process(String type, BigDecimal amount) {
        PaymentGateway gateway = gateways.get(type);
        gateway.charge(amount);
    }
}

@Component("stripe")
public class StripePayment implements PaymentGateway { }

@Component("paypal")
public class PayPalPayment implements PaymentGateway { }
```

### Injecting Array

```java
@Service
public class ValidatorService {
    private final Validator[] validators;
    
    @Autowired
    public ValidatorService(Validator[] validators) {
        this.validators = validators;
    }
    
    public boolean validate(Object obj) {
        return Arrays.stream(validators)
            .allMatch(v -> v.isValid(obj));
    }
}
```

### Ordered Injection

```java
@Component
@Order(1)
public class FirstValidator implements Validator { }

@Component
@Order(2)
public class SecondValidator implements Validator { }

@Service
public class ValidatorChain {
    @Autowired
    private List<Validator> validators;  // Ordered by @Order annotation
}
```

---

## ‚ö° Autowiring Ambiguity

### Problem: Multiple Candidates

```java
public interface PaymentGateway { }

@Component
public class StripePayment implements PaymentGateway { }

@Component
public class PayPalPayment implements PaymentGateway { }

@Service
public class OrderService {
    @Autowired
    private PaymentGateway gateway;  // Error: Which one to inject?
}

// Error: NoUniqueBeanDefinitionException
```

### Solution 1: @Qualifier

```java
@Service
public class OrderService {
    private final PaymentGateway gateway;
    
    @Autowired
    public OrderService(@Qualifier("stripePayment") PaymentGateway gateway) {
        this.gateway = gateway;
    }
}
```

### Solution 2: @Primary

```java
@Component
@Primary  // Default choice
public class StripePayment implements PaymentGateway { }

@Component
public class PayPalPayment implements PaymentGateway { }

@Service
public class OrderService {
    @Autowired
    private PaymentGateway gateway;  // Injects StripePayment
}
```

### Solution 3: Parameter Name Matching

```java
@Service
public class OrderService {
    private final PaymentGateway gateway;
    
    @Autowired
    public OrderService(PaymentGateway stripePayment) {  // Matches bean name
        this.gateway = stripePayment;
    }
}
```

---

## üíâ @Inject vs @Autowired

### @Autowired (Spring-specific)

```java
@Service
public class UserService {
    @Autowired
    private UserRepository repository;
}
```

### @Inject (JSR-330 standard)

```java
import javax.inject.Inject;

@Service
public class UserService {
    @Inject
    private UserRepository repository;
}
```

### Comparison

| Feature | @Autowired | @Inject |
|---------|-----------|----------|
| Source | Spring | JSR-330 |
| `required` attribute | ‚úÖ | ‚ùå |
| Provider support | ‚ùå | ‚úÖ |
| Portability | Spring only | Any DI framework |

### Provider<T> with @Inject

```java
@Service
public class UserService {
    @Inject
    private Provider<UserRepository> repositoryProvider;
    
    public User findUser(Long id) {
        UserRepository repo = repositoryProvider.get();  // Get instance
        return repo.findById(id);
    }
}
```

### Recommendation

Use **@Autowired** for Spring projects (more features).
Use **@Inject** for framework-agnostic code.

---

## üìå Best Practices

### 1. **Prefer Constructor Injection**

```java
// ‚úÖ Best practice
@Service
@RequiredArgsConstructor
public class UserService {
    private final UserRepository repository;
}
```

### 2. **Don't Overuse @Autowired**

```java
// ‚ùå Unnecessary since Spring 4.3
@Service
public class UserService {
    @Autowired
    public UserService(UserRepository repository) { }
}

// ‚úÖ @Autowired optional for single constructor
@Service
public class UserService {
    public UserService(UserRepository repository) { }
}
```

### 3. **Use required = false for Optional**

```java
// ‚úÖ Clear intent
@Service
public class NotificationService {
    @Autowired(required = false)
    public void setEmailService(EmailService email) {
        this.emailService = email;
    }
}
```

### 4. **Avoid Field Injection**

```java
// ‚ùå Avoid
@Autowired
private UserRepository repository;

// ‚úÖ Use constructor
private final UserRepository repository;

public UserService(UserRepository repository) {
    this.repository = repository;
}
```

### 5. **Use @Qualifier for Ambiguity**

```java
// ‚úÖ Explicit selection
@Autowired
public OrderService(@Qualifier("stripe") PaymentGateway gateway) {
    this.gateway = gateway;
}
```

### 6. **Inject Collections for Multiple Beans**

```java
// ‚úÖ All implementations
@Autowired
public NotificationService(List<NotificationChannel> channels) {
    this.channels = channels;
}
```

---

## üé§ Interview Questions

### Q1: What is autowiring in Spring?
**Answer:** Automatic dependency injection by Spring. Instead of manual configuration, Spring automatically finds and injects matching beans.

### Q2: What are autowiring modes?
**Answer:**
- **byType**: Match by class/interface (default)
- **byName**: Match by parameter name
- **constructor**: Constructor injection
- **no**: Disabled (manual wiring)

### Q3: Where can @Autowired be used?
**Answer:**
- Constructors
- Setters
- Fields
- Regular methods

### Q4: Do you need @Autowired on constructors?
**Answer:** No, if there's only one constructor (Spring 4.3+). Yes, if multiple constructors.

### Q5: How to handle optional dependencies?
**Answer:**
```java
// Option 1
@Autowired(required = false)

// Option 2
Optional<EmailService> emailService

// Option 3
@Nullable EmailService emailService
```

### Q6: How to inject all beans of a type?
**Answer:**
```java
@Autowired
public MyService(List<NotificationService> services) {
    // All NotificationService beans injected
}
```

### Q7: What happens if multiple beans match?
**Answer:** `NoUniqueBeanDefinitionException`. Solutions:
- Use `@Qualifier`
- Use `@Primary`
- Match by parameter name

### Q8: @Autowired vs @Inject?
**Answer:**
| @Autowired | @Inject |
|-----------|---------|
| Spring | JSR-330 |
| `required` attribute | No `required` |
| Spring only | Framework agnostic |

### Q9: Can you autowire collections?
**Answer:** Yes!
```java
List<T> - all beans of type T
Map<String, T> - bean name ‚Üí bean
T[] - array of beans
```

### Q10: How to resolve autowiring ambiguity?
**Answer:**
1. `@Qualifier("beanName")`
2. `@Primary` on preferred bean
3. Parameter name matching
4. Inject `List<T>` to get all

---

## üìö Summary

### Key Points

- **Autowiring**: Automatic dependency injection by Spring
- **@Autowired**: Main annotation for autowiring
- **Modes**: byType (default), byName, constructor, no
- **Locations**: Constructor, setter, field, method
- **Optional**: `required = false`, `Optional<T>`, `@Nullable`
- **Collections**: `List<T>`, `Map<String, T>`, `T[]`
- **Ambiguity**: Resolve with `@Qualifier` or `@Primary`

### Best Practices

```java
// ‚úÖ Constructor injection (preferred)
@Service
@RequiredArgsConstructor
public class UserService {
    private final UserRepository repository;
}

// ‚úÖ Optional dependencies
@Autowired(required = false)
public void setEmailService(EmailService email) { }

// ‚úÖ Multiple beans
@Autowired
public MyService(List<Validator> validators) { }

// ‚úÖ Resolve ambiguity
@Autowired
public OrderService(@Qualifier("stripe") PaymentGateway gateway) { }
```

### Common Patterns

```java
// Single bean
@Autowired
public UserService(UserRepository repository) { }

// Multiple beans
@Autowired
public NotificationService(List<NotificationChannel> channels) { }

// Optional bean
@Autowired(required = false)
public void setCache(CacheService cache) { }

// Named bean
@Autowired
public PaymentService(@Qualifier("stripe") PaymentGateway gateway) { }
```

**Next:** @Qualifier Annotation ‚Üí

