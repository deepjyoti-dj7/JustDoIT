# üìä HTTP Status Codes - Complete Guide

## üìã Table of Contents
- [Introduction](#introduction)
- [1xx Informational](#1xx-informational)
- [2xx Success](#2xx-success)
- [3xx Redirection](#3xx-redirection)
- [4xx Client Errors](#4xx-client-errors)
- [5xx Server Errors](#5xx-server-errors)
- [REST API Status Codes](#rest-api-status-codes)
- [Spring Boot Implementation](#spring-boot-implementation)
- [Best Practices](#best-practices)
- [Interview Questions](#interview-questions)

---

## üéØ Introduction

**HTTP Status Codes** indicate the result of HTTP requests:

- **1xx**: Informational responses
- **2xx**: Successful responses
- **3xx**: Redirection messages
- **4xx**: Client errors
- **5xx**: Server errors

---

## üì° 1xx Informational

### 100 Continue

```java
// Rarely used in REST APIs
// Indicates that client should continue with request
```

### 101 Switching Protocols

```java
// Used for WebSocket upgrades
@GetMapping("/ws")
public ResponseEntity<Void> upgradeToWebSocket() {
    return ResponseEntity
        .status(HttpStatus.SWITCHING_PROTOCOLS)
        .build();
}
```

### 102 Processing

```java
// WebDAV - request received, still processing
```

---

## ‚úÖ 2xx Success

### 200 OK

**Usage:** Successful GET, PUT, or PATCH request

```java
@GetMapping("/users/{id}")
public ResponseEntity<User> getUser(@PathVariable Long id) {
    return userService.findById(id)
        .map(ResponseEntity::ok)  // 200 OK
        .orElse(ResponseEntity.notFound().build());
}

@PutMapping("/users/{id}")
public ResponseEntity<User> updateUser(
        @PathVariable Long id,
        @RequestBody User user) {
    
    User updated = userService.update(id, user);
    return ResponseEntity.ok(updated);  // 200 OK
}
```

### 201 Created

**Usage:** Successfully created a new resource (POST)

```java
@PostMapping("/users")
public ResponseEntity<User> createUser(@RequestBody User user) {
    User created = userService.save(user);
    
    URI location = ServletUriComponentsBuilder
        .fromCurrentRequest()
        .path("/{id}")
        .buildAndExpand(created.getId())
        .toUri();
    
    return ResponseEntity
        .created(location)  // 201 Created
        .body(created);
}
```

### 202 Accepted

**Usage:** Request accepted but not yet processed (async operations)

```java
@PostMapping("/orders/process")
public ResponseEntity<OrderResponse> processOrder(@RequestBody Order order) {
    // Queue for async processing
    orderQueue.add(order);
    
    OrderResponse response = new OrderResponse(
        order.getId(),
        "Order queued for processing"
    );
    
    return ResponseEntity
        .status(HttpStatus.ACCEPTED)  // 202 Accepted
        .body(response);
}
```

### 204 No Content

**Usage:** Successful request with no response body (DELETE, sometimes PUT)

```java
@DeleteMapping("/users/{id}")
public ResponseEntity<Void> deleteUser(@PathVariable Long id) {
    userService.delete(id);
    return ResponseEntity.noContent().build();  // 204 No Content
}

@PutMapping("/users/{id}/activate")
public ResponseEntity<Void> activateUser(@PathVariable Long id) {
    userService.activate(id);
    return ResponseEntity.noContent().build();  // 204 No Content
}
```

### 206 Partial Content

**Usage:** Partial GET request (Range header)

```java
@GetMapping("/files/{id}")
public ResponseEntity<byte[]> getFile(
        @PathVariable Long id,
        @RequestHeader(value = "Range", required = false) String range) {
    
    byte[] fileContent = fileService.getContent(id);
    
    if (range != null) {
        // Parse range and return partial content
        byte[] partialContent = extractRange(fileContent, range);
        
        return ResponseEntity
            .status(HttpStatus.PARTIAL_CONTENT)  // 206 Partial Content
            .header("Content-Range", "bytes 0-999/5000")
            .body(partialContent);
    }
    
    return ResponseEntity.ok(fileContent);
}
```

---

## üîÑ 3xx Redirection

### 301 Moved Permanently

**Usage:** Resource permanently moved

```java
@GetMapping("/old-api/users")
public ResponseEntity<Void> oldEndpoint() {
    return ResponseEntity
        .status(HttpStatus.MOVED_PERMANENTLY)  // 301
        .location(URI.create("/api/v2/users"))
        .build();
}
```

### 302 Found

**Usage:** Temporary redirect

```java
@GetMapping("/redirect")
public ResponseEntity<Void> redirect() {
    return ResponseEntity
        .status(HttpStatus.FOUND)  // 302
        .location(URI.create("/new-location"))
        .build();
}
```

### 304 Not Modified

**Usage:** Resource not modified (caching)

```java
@GetMapping("/users/{id}")
public ResponseEntity<User> getUser(
        @PathVariable Long id,
        @RequestHeader(value = "If-None-Match", required = false) String ifNoneMatch) {
    
    User user = userService.findById(id);
    String etag = "\"" + user.hashCode() + "\"";
    
    if (etag.equals(ifNoneMatch)) {
        return ResponseEntity
            .status(HttpStatus.NOT_MODIFIED)  // 304
            .eTag(etag)
            .build();
    }
    
    return ResponseEntity.ok()
        .eTag(etag)
        .body(user);
}
```

### 307 Temporary Redirect

**Usage:** Temporary redirect preserving HTTP method

```java
@PostMapping("/temporary")
public ResponseEntity<Void> temporaryRedirect() {
    return ResponseEntity
        .status(HttpStatus.TEMPORARY_REDIRECT)  // 307
        .location(URI.create("/new-endpoint"))
        .build();
}
```

### 308 Permanent Redirect

**Usage:** Permanent redirect preserving HTTP method

```java
@PostMapping("/old-endpoint")
public ResponseEntity<Void> permanentRedirect() {
    return ResponseEntity
        .status(HttpStatus.PERMANENT_REDIRECT)  // 308
        .location(URI.create("/new-endpoint"))
        .build();
}
```

---

## ‚ùå 4xx Client Errors

### 400 Bad Request

**Usage:** Invalid request syntax or parameters

```java
@PostMapping("/users")
public ResponseEntity<User> createUser(@RequestBody User user) {
    if (user.getAge() != null && user.getAge() < 0) {
        return ResponseEntity
            .badRequest()  // 400 Bad Request
            .build();
    }
    
    User created = userService.save(user);
    return ResponseEntity.status(HttpStatus.CREATED).body(created);
}

// With validation
@PostMapping("/users")
public ResponseEntity<?> createUser(@Valid @RequestBody User user, BindingResult result) {
    if (result.hasErrors()) {
        Map<String, String> errors = new HashMap<>();
        result.getFieldErrors().forEach(error -> 
            errors.put(error.getField(), error.getDefaultMessage())
        );
        return ResponseEntity.badRequest().body(errors);  // 400
    }
    
    User created = userService.save(user);
    return ResponseEntity.status(HttpStatus.CREATED).body(created);
}
```

### 401 Unauthorized

**Usage:** Authentication required or failed

```java
@GetMapping("/profile")
public ResponseEntity<User> getProfile(@RequestHeader("Authorization") String token) {
    if (token == null || !authService.isValid(token)) {
        return ResponseEntity
            .status(HttpStatus.UNAUTHORIZED)  // 401 Unauthorized
            .build();
    }
    
    User user = authService.getUserFromToken(token);
    return ResponseEntity.ok(user);
}

// With Spring Security
@ExceptionHandler(AuthenticationException.class)
public ResponseEntity<ErrorResponse> handleAuthenticationException(
        AuthenticationException ex) {
    
    ErrorResponse error = new ErrorResponse(
        HttpStatus.UNAUTHORIZED.value(),
        "Authentication failed",
        ex.getMessage()
    );
    
    return ResponseEntity
        .status(HttpStatus.UNAUTHORIZED)
        .body(error);
}
```

### 403 Forbidden

**Usage:** Authenticated but not authorized

```java
@DeleteMapping("/users/{id}")
public ResponseEntity<Void> deleteUser(
        @PathVariable Long id,
        @AuthenticationPrincipal User currentUser) {
    
    if (!currentUser.isAdmin()) {
        return ResponseEntity
            .status(HttpStatus.FORBIDDEN)  // 403 Forbidden
            .build();
    }
    
    userService.delete(id);
    return ResponseEntity.noContent().build();
}

// With exception handler
@ExceptionHandler(AccessDeniedException.class)
public ResponseEntity<ErrorResponse> handleAccessDenied(AccessDeniedException ex) {
    ErrorResponse error = new ErrorResponse(
        HttpStatus.FORBIDDEN.value(),
        "Access denied",
        ex.getMessage()
    );
    
    return ResponseEntity
        .status(HttpStatus.FORBIDDEN)
        .body(error);
}
```

### 404 Not Found

**Usage:** Resource not found

```java
@GetMapping("/users/{id}")
public ResponseEntity<User> getUser(@PathVariable Long id) {
    return userService.findById(id)
        .map(ResponseEntity::ok)
        .orElse(ResponseEntity.notFound().build());  // 404 Not Found
}

// With exception
@GetMapping("/users/{id}")
public User getUser(@PathVariable Long id) {
    return userService.findById(id)
        .orElseThrow(() -> new ResourceNotFoundException("User not found: " + id));
}

@ExceptionHandler(ResourceNotFoundException.class)
public ResponseEntity<ErrorResponse> handleNotFound(ResourceNotFoundException ex) {
    ErrorResponse error = new ErrorResponse(
        HttpStatus.NOT_FOUND.value(),
        ex.getMessage(),
        LocalDateTime.now()
    );
    
    return ResponseEntity
        .status(HttpStatus.NOT_FOUND)
        .body(error);
}
```

### 405 Method Not Allowed

**Usage:** HTTP method not supported for endpoint

```java
// Automatically handled by Spring
// Example: POST to GET-only endpoint

@ExceptionHandler(HttpRequestMethodNotSupportedException.class)
public ResponseEntity<ErrorResponse> handleMethodNotAllowed(
        HttpRequestMethodNotSupportedException ex) {
    
    ErrorResponse error = new ErrorResponse(
        HttpStatus.METHOD_NOT_ALLOWED.value(),
        "Method not allowed: " + ex.getMethod(),
        "Supported methods: " + String.join(", ", ex.getSupportedMethods())
    );
    
    return ResponseEntity
        .status(HttpStatus.METHOD_NOT_ALLOWED)
        .allow(ex.getSupportedHttpMethods())
        .body(error);
}
```

### 406 Not Acceptable

**Usage:** Cannot produce response in requested format

```java
@GetMapping(value = "/users/{id}", produces = "application/json")
public User getUser(@PathVariable Long id) {
    return userService.findById(id).orElseThrow();
}

// Request with Accept: application/xml will return 406
```

### 409 Conflict

**Usage:** Request conflicts with current state

```java
@PostMapping("/users")
public ResponseEntity<?> createUser(@RequestBody User user) {
    if (userService.existsByEmail(user.getEmail())) {
        ErrorResponse error = new ErrorResponse(
            HttpStatus.CONFLICT.value(),
            "User already exists with email: " + user.getEmail(),
            LocalDateTime.now()
        );
        
        return ResponseEntity
            .status(HttpStatus.CONFLICT)  // 409 Conflict
            .body(error);
    }
    
    User created = userService.save(user);
    return ResponseEntity.status(HttpStatus.CREATED).body(created);
}
```

### 410 Gone

**Usage:** Resource permanently deleted

```java
@GetMapping("/users/{id}")
public ResponseEntity<User> getUser(@PathVariable Long id) {
    User user = userService.findById(id);
    
    if (user != null && user.isDeleted()) {
        return ResponseEntity
            .status(HttpStatus.GONE)  // 410 Gone
            .build();
    }
    
    return user != null 
        ? ResponseEntity.ok(user) 
        : ResponseEntity.notFound().build();
}
```

### 415 Unsupported Media Type

**Usage:** Request body format not supported

```java
@PostMapping(value = "/users", consumes = "application/json")
public User createUser(@RequestBody User user) {
    return userService.save(user);
}

// Request with Content-Type: application/xml will return 415

@ExceptionHandler(HttpMediaTypeNotSupportedException.class)
public ResponseEntity<ErrorResponse> handleUnsupportedMediaType(
        HttpMediaTypeNotSupportedException ex) {
    
    ErrorResponse error = new ErrorResponse(
        HttpStatus.UNSUPPORTED_MEDIA_TYPE.value(),
        "Unsupported media type: " + ex.getContentType(),
        "Supported types: " + ex.getSupportedMediaTypes()
    );
    
    return ResponseEntity
        .status(HttpStatus.UNSUPPORTED_MEDIA_TYPE)
        .body(error);
}
```

### 422 Unprocessable Entity

**Usage:** Semantic errors in request

```java
@PostMapping("/orders")
public ResponseEntity<?> createOrder(@RequestBody Order order) {
    // Syntax is valid but business rules violated
    if (order.getQuantity() > inventoryService.getAvailableStock(order.getProductId())) {
        ErrorResponse error = new ErrorResponse(
            422,
            "Insufficient stock",
            "Requested: " + order.getQuantity() + ", Available: " + 
                inventoryService.getAvailableStock(order.getProductId())
        );
        
        return ResponseEntity
            .status(HttpStatus.UNPROCESSABLE_ENTITY)  // 422
            .body(error);
    }
    
    Order created = orderService.create(order);
    return ResponseEntity.status(HttpStatus.CREATED).body(created);
}
```

### 429 Too Many Requests

**Usage:** Rate limiting

```java
@RestControllerAdvice
public class RateLimitExceptionHandler {
    
    @ExceptionHandler(RateLimitExceededException.class)
    public ResponseEntity<ErrorResponse> handleRateLimit(
            RateLimitExceededException ex) {
        
        ErrorResponse error = new ErrorResponse(
            HttpStatus.TOO_MANY_REQUESTS.value(),
            "Rate limit exceeded",
            "Retry after: " + ex.getRetryAfter() + " seconds"
        );
        
        return ResponseEntity
            .status(HttpStatus.TOO_MANY_REQUESTS)  // 429
            .header("Retry-After", String.valueOf(ex.getRetryAfter()))
            .body(error);
    }
}
```

---

## üî• 5xx Server Errors

### 500 Internal Server Error

**Usage:** Unexpected server error

```java
@RestControllerAdvice
public class GlobalExceptionHandler {
    
    @ExceptionHandler(Exception.class)
    public ResponseEntity<ErrorResponse> handleGeneralException(Exception ex) {
        logger.error("Unexpected error", ex);
        
        ErrorResponse error = new ErrorResponse(
            HttpStatus.INTERNAL_SERVER_ERROR.value(),
            "Internal server error",
            "An unexpected error occurred"
        );
        
        return ResponseEntity
            .status(HttpStatus.INTERNAL_SERVER_ERROR)  // 500
            .body(error);
    }
}
```

### 501 Not Implemented

**Usage:** Functionality not implemented

```java
@PostMapping("/users/bulk-import")
public ResponseEntity<String> bulkImport(@RequestBody List<User> users) {
    return ResponseEntity
        .status(HttpStatus.NOT_IMPLEMENTED)  // 501
        .body("Bulk import not yet implemented");
}
```

### 502 Bad Gateway

**Usage:** Invalid response from upstream server

```java
@GetMapping("/external-api/data")
public ResponseEntity<?> getExternalData() {
    try {
        ExternalData data = externalService.fetchData();
        return ResponseEntity.ok(data);
    } catch (InvalidResponseException ex) {
        return ResponseEntity
            .status(HttpStatus.BAD_GATEWAY)  // 502
            .body("Invalid response from external service");
    }
}
```

### 503 Service Unavailable

**Usage:** Service temporarily unavailable

```java
@GetMapping("/users")
public ResponseEntity<?> getUsers() {
    if (!applicationService.isHealthy()) {
        return ResponseEntity
            .status(HttpStatus.SERVICE_UNAVAILABLE)  // 503
            .header("Retry-After", "60")
            .body("Service temporarily unavailable");
    }
    
    List<User> users = userService.findAll();
    return ResponseEntity.ok(users);
}
```

### 504 Gateway Timeout

**Usage:** Timeout from upstream server

```java
@GetMapping("/slow-service/data")
public ResponseEntity<?> getSlowData() {
    try {
        Data data = slowService.fetchData();
        return ResponseEntity.ok(data);
    } catch (TimeoutException ex) {
        return ResponseEntity
            .status(HttpStatus.GATEWAY_TIMEOUT)  // 504
            .body("Request to upstream service timed out");
    }
}
```

---

## üéØ REST API Status Codes

### CRUD Operations

| Operation | Success | Error |
|-----------|---------|-------|
| **GET** (single) | 200 OK | 404 Not Found |
| **GET** (collection) | 200 OK | - |
| **POST** (create) | 201 Created | 400 Bad Request, 409 Conflict |
| **PUT** (update) | 200 OK | 404 Not Found, 400 Bad Request |
| **PATCH** (partial) | 200 OK | 404 Not Found, 400 Bad Request |
| **DELETE** | 204 No Content | 404 Not Found |

### Complete Example

```java
@RestController
@RequestMapping("/api/users")
public class UserController {
    
    // GET - 200 or 404
    @GetMapping("/{id}")
    public ResponseEntity<User> getUser(@PathVariable Long id) {
        return userService.findById(id)
            .map(ResponseEntity::ok)                    // 200 OK
            .orElse(ResponseEntity.notFound().build()); // 404 Not Found
    }
    
    // GET (collection) - 200
    @GetMapping
    public ResponseEntity<List<User>> getAllUsers() {
        return ResponseEntity.ok(userService.findAll()); // 200 OK
    }
    
    // POST - 201, 400, or 409
    @PostMapping
    public ResponseEntity<?> createUser(@Valid @RequestBody User user) {
        if (userService.existsByEmail(user.getEmail())) {
            return ResponseEntity
                .status(HttpStatus.CONFLICT)              // 409 Conflict
                .body("Email already exists");
        }
        
        User created = userService.save(user);
        
        URI location = ServletUriComponentsBuilder
            .fromCurrentRequest()
            .path("/{id}")
            .buildAndExpand(created.getId())
            .toUri();
        
        return ResponseEntity.created(location).body(created); // 201 Created
    }
    
    // PUT - 200, 404, or 400
    @PutMapping("/{id}")
    public ResponseEntity<User> updateUser(
            @PathVariable Long id,
            @Valid @RequestBody User user) {
        
        return userService.update(id, user)
            .map(ResponseEntity::ok)                    // 200 OK
            .orElse(ResponseEntity.notFound().build()); // 404 Not Found
    }
    
    // PATCH - 200, 404, or 400
    @PatchMapping("/{id}")
    public ResponseEntity<User> patchUser(
            @PathVariable Long id,
            @RequestBody Map<String, Object> updates) {
        
        return userService.patch(id, updates)
            .map(ResponseEntity::ok)                    // 200 OK
            .orElse(ResponseEntity.notFound().build()); // 404 Not Found
    }
    
    // DELETE - 204 or 404
    @DeleteMapping("/{id}")
    public ResponseEntity<Void> deleteUser(@PathVariable Long id) {
        if (!userService.exists(id)) {
            return ResponseEntity.notFound().build();   // 404 Not Found
        }
        
        userService.delete(id);
        return ResponseEntity.noContent().build();      // 204 No Content
    }
}
```

---

## üõ†Ô∏è Spring Boot Implementation

### Status Code Constants

```java
import org.springframework.http.HttpStatus;

// 2xx Success
HttpStatus.OK                    // 200
HttpStatus.CREATED               // 201
HttpStatus.ACCEPTED              // 202
HttpStatus.NO_CONTENT            // 204

// 3xx Redirection
HttpStatus.MOVED_PERMANENTLY     // 301
HttpStatus.FOUND                 // 302
HttpStatus.NOT_MODIFIED          // 304

// 4xx Client Errors
HttpStatus.BAD_REQUEST           // 400
HttpStatus.UNAUTHORIZED          // 401
HttpStatus.FORBIDDEN             // 403
HttpStatus.NOT_FOUND             // 404
HttpStatus.METHOD_NOT_ALLOWED    // 405
HttpStatus.CONFLICT              // 409
HttpStatus.UNPROCESSABLE_ENTITY  // 422

// 5xx Server Errors
HttpStatus.INTERNAL_SERVER_ERROR // 500
HttpStatus.SERVICE_UNAVAILABLE   // 503
```

### @ResponseStatus

```java
@ResponseStatus(HttpStatus.NOT_FOUND)
public class ResourceNotFoundException extends RuntimeException {
    public ResourceNotFoundException(String message) {
        super(message);
    }
}

@ResponseStatus(HttpStatus.BAD_REQUEST)
public class InvalidRequestException extends RuntimeException {
    public InvalidRequestException(String message) {
        super(message);
    }
}

// Usage
@GetMapping("/users/{id}")
public User getUser(@PathVariable Long id) {
    return userService.findById(id)
        .orElseThrow(() -> new ResourceNotFoundException("User not found"));
}
```

### Exception Handling

```java
@RestControllerAdvice
public class GlobalExceptionHandler {
    
    @ExceptionHandler(ResourceNotFoundException.class)
    public ResponseEntity<ErrorResponse> handleNotFound(ResourceNotFoundException ex) {
        ErrorResponse error = new ErrorResponse(
            HttpStatus.NOT_FOUND.value(),
            ex.getMessage(),
            LocalDateTime.now()
        );
        return ResponseEntity.status(HttpStatus.NOT_FOUND).body(error);
    }
    
    @ExceptionHandler(MethodArgumentNotValidException.class)
    public ResponseEntity<ErrorResponse> handleValidation(
            MethodArgumentNotValidException ex) {
        
        Map<String, String> errors = new HashMap<>();
        ex.getBindingResult().getFieldErrors().forEach(error ->
            errors.put(error.getField(), error.getDefaultMessage())
        );
        
        ErrorResponse response = new ErrorResponse(
            HttpStatus.BAD_REQUEST.value(),
            "Validation failed",
            errors
        );
        
        return ResponseEntity.status(HttpStatus.BAD_REQUEST).body(response);
    }
    
    @ExceptionHandler(Exception.class)
    public ResponseEntity<ErrorResponse> handleGeneral(Exception ex) {
        ErrorResponse error = new ErrorResponse(
            HttpStatus.INTERNAL_SERVER_ERROR.value(),
            "Internal server error",
            LocalDateTime.now()
        );
        return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body(error);
    }
}
```

---

## üìå Best Practices

### 1. Use Appropriate Status Codes

```java
// ‚úÖ Good
@PostMapping("/users")
public ResponseEntity<User> createUser(@RequestBody User user) {
    User created = userService.save(user);
    return ResponseEntity.status(HttpStatus.CREATED).body(created); // 201
}

// ‚ùå Bad
@PostMapping("/users")
public ResponseEntity<User> createUser(@RequestBody User user) {
    User created = userService.save(user);
    return ResponseEntity.ok(created); // Wrong! Should be 201
}
```

### 2. Return 404 for Missing Resources

```java
// ‚úÖ Good
@GetMapping("/users/{id}")
public ResponseEntity<User> getUser(@PathVariable Long id) {
    return userService.findById(id)
        .map(ResponseEntity::ok)
        .orElse(ResponseEntity.notFound().build());
}

// ‚ùå Bad
@GetMapping("/users/{id}")
public User getUser(@PathVariable Long id) {
    return userService.findById(id).orElse(null); // Returns null
}
```

### 3. Include Location Header for 201

```java
// ‚úÖ Good
@PostMapping("/users")
public ResponseEntity<User> createUser(@RequestBody User user) {
    User created = userService.save(user);
    
    URI location = ServletUriComponentsBuilder
        .fromCurrentRequest()
        .path("/{id}")
        .buildAndExpand(created.getId())
        .toUri();
    
    return ResponseEntity.created(location).body(created);
}
```

### 4. Use 204 for Successful DELETE

```java
// ‚úÖ Good
@DeleteMapping("/users/{id}")
public ResponseEntity<Void> deleteUser(@PathVariable Long id) {
    userService.delete(id);
    return ResponseEntity.noContent().build(); // 204
}

// ‚ùå Bad
@DeleteMapping("/users/{id}")
public ResponseEntity<String> deleteUser(@PathVariable Long id) {
    userService.delete(id);
    return ResponseEntity.ok("Deleted"); // Unnecessary body
}
```

### 5. Distinguish 401 vs 403

```java
// 401 - Not authenticated
@GetMapping("/profile")
public ResponseEntity<User> getProfile(@RequestHeader("Authorization") String token) {
    if (token == null || !authService.isValid(token)) {
        return ResponseEntity.status(HttpStatus.UNAUTHORIZED).build(); // 401
    }
    return ResponseEntity.ok(authService.getUserFromToken(token));
}

// 403 - Authenticated but not authorized
@DeleteMapping("/users/{id}")
public ResponseEntity<Void> deleteUser(
        @PathVariable Long id,
        @AuthenticationPrincipal User currentUser) {
    
    if (!currentUser.isAdmin()) {
        return ResponseEntity.status(HttpStatus.FORBIDDEN).build(); // 403
    }
    userService.delete(id);
    return ResponseEntity.noContent().build();
}
```

### 6. Provide Error Details

```java
@Data
@AllArgsConstructor
public class ErrorResponse {
    private int status;
    private String message;
    private LocalDateTime timestamp;
    private List<String> errors;
}

@ExceptionHandler(MethodArgumentNotValidException.class)
public ResponseEntity<ErrorResponse> handleValidation(
        MethodArgumentNotValidException ex) {
    
    List<String> errors = ex.getBindingResult()
        .getFieldErrors()
        .stream()
        .map(error -> error.getField() + ": " + error.getDefaultMessage())
        .collect(Collectors.toList());
    
    ErrorResponse response = new ErrorResponse(
        HttpStatus.BAD_REQUEST.value(),
        "Validation failed",
        LocalDateTime.now(),
        errors
    );
    
    return ResponseEntity.status(HttpStatus.BAD_REQUEST).body(response);
}
```

### 7. Be Consistent

```java
// ‚úÖ Good - Consistent status codes across API
// POST -> 201
// GET -> 200 or 404
// PUT/PATCH -> 200 or 404
// DELETE -> 204 or 404

// ‚ùå Bad - Inconsistent
// Some POSTs return 200, others 201
// Some DELETEs return 200, others 204
```

---

## üé§ Interview Questions

### Q1: What are HTTP status codes?
**Answer:** Three-digit codes indicating result of HTTP request: 1xx (informational), 2xx (success), 3xx (redirection), 4xx (client error), 5xx (server error).

### Q2: Difference between 200 and 201?
**Answer:**
- **200 OK**: Successful request (GET, PUT, PATCH)
- **201 Created**: Successfully created resource (POST)

### Q3: When to use 204 No Content?
**Answer:** Successful request with no response body, typically DELETE or some PUT operations.

### Q4: Difference between 401 and 403?
**Answer:**
- **401 Unauthorized**: Not authenticated (missing/invalid credentials)
- **403 Forbidden**: Authenticated but not authorized (insufficient permissions)

### Q5: When to use 404 vs 410?
**Answer:**
- **404 Not Found**: Resource doesn't exist or never existed
- **410 Gone**: Resource existed but permanently deleted

### Q6: What is 409 Conflict?
**Answer:** Request conflicts with current server state, e.g., duplicate email, concurrent modification.

### Q7: Difference between 400 and 422?
**Answer:**
- **400 Bad Request**: Syntax error, malformed request
- **422 Unprocessable Entity**: Syntax correct but semantic/business rule violation

### Q8: What are 5xx errors?
**Answer:** Server errors indicating problem on server side: 500 (internal error), 502 (bad gateway), 503 (unavailable), 504 (timeout).

### Q9: What is 304 Not Modified?
**Answer:** Resource not changed since last request (based on ETag/Last-Modified), client can use cached version.

### Q10: REST API status codes for CRUD?
**Answer:**
- **GET**: 200 (found), 404 (not found)
- **POST**: 201 (created), 400 (invalid), 409 (conflict)
- **PUT/PATCH**: 200 (updated), 404 (not found)
- **DELETE**: 204 (deleted), 404 (not found)

---

## üìö Summary

### Common Status Codes

```
2xx Success
‚îú‚îÄ‚îÄ 200 OK - Successful GET, PUT, PATCH
‚îú‚îÄ‚îÄ 201 Created - Successful POST
‚îú‚îÄ‚îÄ 202 Accepted - Async processing
‚îî‚îÄ‚îÄ 204 No Content - Successful DELETE

4xx Client Errors
‚îú‚îÄ‚îÄ 400 Bad Request - Invalid syntax
‚îú‚îÄ‚îÄ 401 Unauthorized - Not authenticated
‚îú‚îÄ‚îÄ 403 Forbidden - Not authorized
‚îú‚îÄ‚îÄ 404 Not Found - Resource not found
‚îú‚îÄ‚îÄ 409 Conflict - Duplicate/conflict
‚îî‚îÄ‚îÄ 422 Unprocessable Entity - Business rule violation

5xx Server Errors
‚îú‚îÄ‚îÄ 500 Internal Server Error - Unexpected error
‚îú‚îÄ‚îÄ 502 Bad Gateway - Invalid upstream response
‚îú‚îÄ‚îÄ 503 Service Unavailable - Temporarily down
‚îî‚îÄ‚îÄ 504 Gateway Timeout - Upstream timeout
```

### CRUD Status Codes

```java
// GET
200 OK - Found
404 Not Found - Not found

// POST
201 Created - Created successfully
400 Bad Request - Invalid data
409 Conflict - Duplicate

// PUT/PATCH
200 OK - Updated successfully
404 Not Found - Resource not found
400 Bad Request - Invalid data

// DELETE
204 No Content - Deleted successfully
404 Not Found - Resource not found
```

**Next:** Content Negotiation ‚Üí

