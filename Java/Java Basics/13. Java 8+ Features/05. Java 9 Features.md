# üéØ Java 9 Features

## üìñ Overview

**Java 9** introduced significant features including the module system, JShell REPL, improved APIs, and performance enhancements.

---

## üíª Module System (JPMS)

```java
// module-info.java
module com.example.myapp {
    requires java.sql;
    requires java.logging;
    
    exports com.example.myapp.api;
    exports com.example.myapp.utils to com.example.other;
    
    opens com.example.myapp.internal to com.fasterxml.jackson.databind;
}
```

**Benefits:**
- Strong encapsulation
- Reliable configuration
- Better performance
- Reduced memory footprint

---

## üíª JShell - REPL

```bash
# Start JShell
jshell

# Execute Java code interactively
jshell> int x = 10;
x ==> 10

jshell> int y = 20;
y ==> 20

jshell> x + y
$3 ==> 30

jshell> void greet(String name) {
   ...>     System.out.println("Hello, " + name);
   ...> }

jshell> greet("Alice")
Hello, Alice

# List variables
jshell> /vars

# List methods
jshell> /methods

# Exit
jshell> /exit
```

---

## üíª Collection Factory Methods

```java
import java.util.*;

public class CollectionFactoryDemo {
    public static void main(String[] args) {
        // Immutable List
        List<String> list = List.of("Java", "Python", "JavaScript");
        System.out.println(list);
        // list.add("C++");  // UnsupportedOperationException
        
        // Immutable Set
        Set<Integer> set = Set.of(1, 2, 3, 4, 5);
        System.out.println(set);
        
        // Immutable Map
        Map<String, Integer> map = Map.of(
            "Alice", 25,
            "Bob", 30,
            "Charlie", 35
        );
        System.out.println(map);
        
        // Map with entries (for more than 10 entries)
        Map<String, String> largeMap = Map.ofEntries(
            Map.entry("key1", "value1"),
            Map.entry("key2", "value2"),
            Map.entry("key3", "value3")
        );
        System.out.println(largeMap);
    }
}
```

---

## üíª Stream API Enhancements

```java
import java.util.*;
import java.util.stream.*;

public class StreamEnhancementsDemo {
    public static void main(String[] args) {
        // takeWhile - take elements while predicate is true
        List<Integer> numbers = List.of(1, 2, 3, 4, 5, 6, 7, 8);
        List<Integer> result1 = numbers.stream()
            .takeWhile(n -> n < 5)
            .collect(Collectors.toList());
        System.out.println("takeWhile: " + result1);  // [1, 2, 3, 4]
        
        // dropWhile - drop elements while predicate is true
        List<Integer> result2 = numbers.stream()
            .dropWhile(n -> n < 5)
            .collect(Collectors.toList());
        System.out.println("dropWhile: " + result2);  // [5, 6, 7, 8]
        
        // iterate with predicate
        Stream.iterate(1, n -> n <= 10, n -> n + 1)
            .forEach(System.out::print);  // 12345678910
        System.out.println();
        
        // ofNullable
        Stream<String> stream1 = Stream.ofNullable("Hello");
        stream1.forEach(System.out::println);  // Hello
        
        Stream<String> stream2 = Stream.ofNullable(null);
        stream2.forEach(System.out::println);  // Nothing printed
    }
}
```

---

## üíª Optional Enhancements

```java
import java.util.*;

public class OptionalEnhancementsDemo {
    public static void main(String[] args) {
        // ifPresentOrElse
        Optional<String> optional1 = Optional.of("Hello");
        optional1.ifPresentOrElse(
            value -> System.out.println("Present: " + value),
            () -> System.out.println("Empty")
        );
        
        Optional<String> optional2 = Optional.empty();
        optional2.ifPresentOrElse(
            value -> System.out.println("Present: " + value),
            () -> System.out.println("Empty")
        );
        
        // or - provide alternative Optional
        Optional<String> result = Optional.empty()
            .or(() -> Optional.of("Default value"));
        System.out.println(result.get());
        
        // stream
        List<String> list = Optional.of("Java")
            .stream()
            .collect(Collectors.toList());
        System.out.println(list);
    }
}
```

---

## üíª Process API Improvements

```java
import java.io.IOException;

public class ProcessAPIDemo {
    public static void main(String[] args) throws IOException {
        // Current process info
        ProcessHandle current = ProcessHandle.current();
        System.out.println("PID: " + current.pid());
        
        ProcessHandle.Info info = current.info();
        System.out.println("Command: " + info.command().orElse("N/A"));
        System.out.println("User: " + info.user().orElse("N/A"));
        System.out.println("Start time: " + info.startInstant().orElse(null));
        
        // All processes
        ProcessHandle.allProcesses()
            .limit(5)
            .forEach(p -> System.out.println("Process: " + p.pid()));
        
        // Destroy process
        ProcessHandle ph = ProcessHandle.of(12345).orElse(null);
        if (ph != null) {
            ph.destroy();
        }
    }
}
```

---

## üíª Try-With-Resources Enhancement

```java
import java.io.*;

public class TryWithResourcesDemo {
    public static void main(String[] args) throws IOException {
        // Java 7 - declare inside try
        try (BufferedReader reader1 = new BufferedReader(new FileReader("file.txt"))) {
            System.out.println(reader1.readLine());
        }
        
        // Java 9 - use effectively final variables
        BufferedReader reader2 = new BufferedReader(new FileReader("file.txt"));
        try (reader2) {
            System.out.println(reader2.readLine());
        }
        
        // Multiple resources
        FileInputStream fis = new FileInputStream("file1.txt");
        FileOutputStream fos = new FileOutputStream("file2.txt");
        try (fis; fos) {
            // Use resources
        }
    }
}
```

---

## üíª Private Methods in Interfaces

```java
interface Calculator {
    default int add(int a, int b) {
        log("Adding " + a + " and " + b);
        return a + b;
    }
    
    default int multiply(int a, int b) {
        log("Multiplying " + a + " and " + b);
        return a * b;
    }
    
    // Private method - code reuse in interface
    private void log(String message) {
        System.out.println("LOG: " + message);
    }
    
    // Private static method
    private static void validate(int value) {
        if (value < 0) {
            throw new IllegalArgumentException("Negative value");
        }
    }
}

public class PrivateMethodsDemo implements Calculator {
    public static void main(String[] args) {
        PrivateMethodsDemo calc = new PrivateMethodsDemo();
        System.out.println(calc.add(5, 3));
        System.out.println(calc.multiply(4, 7));
    }
}
```

---

## üíª HTTP/2 Client (Incubator)

```java
import jdk.incubator.http.*;
import java.net.URI;

public class HttpClientDemo {
    public static void main(String[] args) throws Exception {
        // Create HTTP client
        HttpClient client = HttpClient.newHttpClient();
        
        // Create request
        HttpRequest request = HttpRequest.newBuilder()
            .uri(new URI("https://api.github.com/users/octocat"))
            .GET()
            .build();
        
        // Send request
        HttpResponse<String> response = client.send(request, 
            HttpResponse.BodyHandler.asString());
        
        System.out.println("Status: " + response.statusCode());
        System.out.println("Body: " + response.body());
    }
}
```

---

## üìä Key Features Summary

| Feature | Description |
|---------|-------------|
| **Module System** | JPMS for modular applications |
| **JShell** | Interactive REPL for Java |
| **Factory Methods** | List.of(), Set.of(), Map.of() |
| **Stream API** | takeWhile, dropWhile, iterate |
| **Optional** | ifPresentOrElse, or, stream |
| **Process API** | ProcessHandle for process info |
| **Private Methods** | In interfaces for code reuse |
| **Try-With-Resources** | Effectively final variables |
| **HTTP/2 Client** | Modern HTTP client (incubator) |

---

## ‚ö° Best Practices

| Practice | Description |
|----------|-------------|
| ‚úÖ Use factory methods | Immutable collections |
| ‚úÖ Adopt modules | For large applications |
| ‚úÖ Try JShell | Quick prototyping |
| ‚úÖ Use takeWhile/dropWhile | Cleaner stream code |
| ‚úÖ Private interface methods | Reduce code duplication |
| ‚ùå Don't modify factory collections | Immutable by design |

---

## üí° Key Takeaways

- Module system (JPMS) for better structure
- JShell REPL for interactive Java
- Collection factory methods create immutable collections
- Stream API enhancements: takeWhile, dropWhile, iterate
- Optional improvements: ifPresentOrElse, or, stream
- Process API for process management
- Private methods in interfaces
- Try-with-resources supports effectively final variables
- HTTP/2 client (incubator, standardized in Java 11)
