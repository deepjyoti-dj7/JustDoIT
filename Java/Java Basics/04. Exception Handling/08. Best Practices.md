# ‚ú® Best Practices

## üìñ Overview

Exception handling best practices help write robust, maintainable, and debuggable code. Following these practices prevents common pitfalls and improves code quality.

---

## üíª Example 1: Catch Specific Exceptions

```java
import java.io.*;

public class CatchSpecific {
    // ‚ùå BAD: Catching Exception too broad
    static void badPractice(String filename) {
        try {
            FileReader fr = new FileReader(filename);
            int data = fr.read();
            fr.close();
        } catch (Exception e) {  // Too general
            System.out.println("Error occurred");
        }
    }
    
    // ‚úÖ GOOD: Catch specific exceptions
    static void goodPractice(String filename) {
        try {
            FileReader fr = new FileReader(filename);
            int data = fr.read();
            fr.close();
        } catch (FileNotFoundException e) {
            System.out.println("File not found: " + filename);
            System.out.println("Action: Check file path");
        } catch (IOException e) {
            System.out.println("I/O error: " + e.getMessage());
            System.out.println("Action: Check file permissions");
        }
    }
    
    public static void main(String[] args) {
        System.out.println("=== Catch Specific Exceptions ===\n");
        
        System.out.println("Bad practice:");
        badPractice("nonexistent.txt");
        
        System.out.println("\nGood practice:");
        goodPractice("nonexistent.txt");
    }
}
```

---

## üíª Example 2: Don't Swallow Exceptions

```java
public class DontSwallow {
    // ‚ùå BAD: Silent failure
    static void badPractice1() {
        try {
            int result = 10 / 0;
        } catch (ArithmeticException e) {
            // Empty catch - exception swallowed!
        }
    }
    
    // ‚ùå BAD: Generic message loses information
    static void badPractice2() {
        try {
            int result = 10 / 0;
        } catch (ArithmeticException e) {
            System.out.println("Error occurred");  // Lost details
        }
    }
    
    // ‚úÖ GOOD: Log exception details
    static void goodPractice1() {
        try {
            int result = 10 / 0;
        } catch (ArithmeticException e) {
            System.err.println("Arithmetic error: " + e.getMessage());
            e.printStackTrace();
        }
    }
    
    // ‚úÖ GOOD: Wrap and rethrow with context
    static void goodPractice2() throws Exception {
        try {
            int result = 10 / 0;
        } catch (ArithmeticException e) {
            throw new Exception("Failed to calculate result", e);
        }
    }
    
    public static void main(String[] args) {
        System.out.println("=== Don't Swallow Exceptions ===\n");
        
        System.out.println("Bad practice 1 (silent):");
        badPractice1();
        System.out.println("No output - exception swallowed!\n");
        
        System.out.println("Bad practice 2 (generic message):");
        badPractice2();
        System.out.println();
        
        System.out.println("Good practice (with details):");
        goodPractice1();
    }
}
```

---

## üíª Example 3: Use try-with-resources

```java
import java.io.*;

public class UseTryWithResources {
    // ‚ùå BAD: Manual resource management
    static void badPractice(String filename) {
        BufferedReader reader = null;
        try {
            reader = new BufferedReader(new FileReader(filename));
            System.out.println(reader.readLine());
        } catch (IOException e) {
            e.printStackTrace();
        } finally {
            try {
                if (reader != null) {
                    reader.close();
                }
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
    }
    
    // ‚úÖ GOOD: Automatic resource management
    static void goodPractice(String filename) {
        try (BufferedReader reader = new BufferedReader(new FileReader(filename))) {
            System.out.println(reader.readLine());
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
    
    public static void main(String[] args) {
        System.out.println("=== Use try-with-resources ===\n");
        
        System.out.println("Good practice (automatic cleanup):");
        goodPractice("test.txt");
    }
}
```

---

## üíª Example 4: Validate Early, Fail Fast

```java
public class ValidateEarly {
    // ‚ùå BAD: Late validation
    static class BadBankAccount {
        void withdraw(double amount) {
            try {
                // ... lots of processing ...
                // ... database operations ...
                // ... network calls ...
                
                // Validation too late
                if (amount <= 0) {
                    throw new IllegalArgumentException("Invalid amount");
                }
            } catch (IllegalArgumentException e) {
                System.out.println("Error: " + e.getMessage());
            }
        }
    }
    
    // ‚úÖ GOOD: Early validation
    static class GoodBankAccount {
        void withdraw(double amount) {
            // Validate immediately
            if (amount <= 0) {
                throw new IllegalArgumentException("Amount must be positive: " + amount);
            }
            if (amount > 10000) {
                throw new IllegalArgumentException("Amount exceeds daily limit: " + amount);
            }
            
            // Now do processing with valid input
            System.out.println("Withdrawal successful: " + amount);
        }
    }
    
    public static void main(String[] args) {
        System.out.println("=== Validate Early, Fail Fast ===\n");
        
        GoodBankAccount account = new GoodBankAccount();
        
        try {
            account.withdraw(-100);
        } catch (IllegalArgumentException e) {
            System.out.println("Caught immediately: " + e.getMessage());
        }
        
        try {
            account.withdraw(500);
        } catch (IllegalArgumentException e) {
            System.out.println("Error: " + e.getMessage());
        }
    }
}
```

---

## üíª Example 5: Provide Meaningful Error Messages

```java
public class MeaningfulMessages {
    // ‚ùå BAD: Vague messages
    static class BadValidator {
        void validateUser(String name, int age, String email) {
            if (name == null || name.isEmpty()) {
                throw new IllegalArgumentException("Invalid input");  // Vague
            }
            if (age < 0) {
                throw new IllegalArgumentException("Invalid value");  // Vague
            }
            if (!email.contains("@")) {
                throw new IllegalArgumentException("Error");  // Very vague
            }
        }
    }
    
    // ‚úÖ GOOD: Descriptive messages
    static class GoodValidator {
        void validateUser(String name, int age, String email) {
            if (name == null || name.isEmpty()) {
                throw new IllegalArgumentException(
                    "Name cannot be null or empty");
            }
            if (age < 0 || age > 150) {
                throw new IllegalArgumentException(
                    "Age must be between 0 and 150, got: " + age);
            }
            if (!email.contains("@")) {
                throw new IllegalArgumentException(
                    "Email must contain @ symbol, got: " + email);
            }
            System.out.println("User validated successfully");
        }
    }
    
    public static void main(String[] args) {
        System.out.println("=== Meaningful Error Messages ===\n");
        
        GoodValidator validator = new GoodValidator();
        
        // Test 1
        try {
            validator.validateUser("", 25, "user@example.com");
        } catch (IllegalArgumentException e) {
            System.out.println("Clear error: " + e.getMessage());
        }
        
        // Test 2
        System.out.println();
        try {
            validator.validateUser("John", -5, "user@example.com");
        } catch (IllegalArgumentException e) {
            System.out.println("Clear error: " + e.getMessage());
        }
        
        // Test 3
        System.out.println();
        try {
            validator.validateUser("John", 25, "invalidemail");
        } catch (IllegalArgumentException e) {
            System.out.println("Clear error: " + e.getMessage());
        }
    }
}
```

---

## üíª Example 6: Don't Use Exceptions for Flow Control

```java
public class NoFlowControl {
    // ‚ùå BAD: Exception for flow control
    static class BadParser {
        int parseNumber(String str) {
            try {
                return Integer.parseInt(str);
            } catch (NumberFormatException e) {
                return 0;  // Using exception as flow control
            }
        }
        
        void processItems(String[] items) {
            try {
                for (int i = 0; ; i++) {  // Intentional infinite loop
                    System.out.println(items[i]);
                }
            } catch (ArrayIndexOutOfBoundsException e) {
                // Using exception to exit loop - BAD!
            }
        }
    }
    
    // ‚úÖ GOOD: Proper flow control
    static class GoodParser {
        Integer parseNumber(String str) {
            // Validate first
            if (str == null || str.isEmpty()) {
                return null;
            }
            
            // Check if valid number
            if (!str.matches("-?\\d+")) {
                return null;
            }
            
            try {
                return Integer.parseInt(str);
            } catch (NumberFormatException e) {
                // Only for unexpected errors
                System.err.println("Unexpected parse error: " + e.getMessage());
                return null;
            }
        }
        
        void processItems(String[] items) {
            // Proper loop with condition
            for (int i = 0; i < items.length; i++) {
                System.out.println(items[i]);
            }
            
            // Or enhanced for loop
            // for (String item : items) {
            //     System.out.println(item);
            // }
        }
    }
    
    public static void main(String[] args) {
        System.out.println("=== Don't Use Exceptions for Flow Control ===\n");
        
        GoodParser parser = new GoodParser();
        
        System.out.println("Parsing numbers:");
        System.out.println("'123': " + parser.parseNumber("123"));
        System.out.println("'abc': " + parser.parseNumber("abc"));
        System.out.println("null: " + parser.parseNumber(null));
        
        System.out.println("\nProcessing items:");
        parser.processItems(new String[]{"A", "B", "C"});
    }
}
```

---

## üíª Example 7: Log Exceptions Properly

```java
import java.io.*;
import java.time.LocalDateTime;
import java.time.format.DateTimeFormatter;

public class LogExceptions {
    static DateTimeFormatter formatter = DateTimeFormatter.ofPattern("yyyy-MM-dd HH:mm:ss");
    
    // ‚ùå BAD: Poor logging
    static void badLogging() {
        try {
            FileReader fr = new FileReader("nonexistent.txt");
        } catch (IOException e) {
            System.out.println("Error");  // No context
        }
    }
    
    // ‚úÖ GOOD: Comprehensive logging
    static void goodLogging(String operation, String filename) {
        try {
            FileReader fr = new FileReader(filename);
        } catch (FileNotFoundException e) {
            logError("FileNotFound", operation, filename, e);
        } catch (IOException e) {
            logError("IOException", operation, filename, e);
        }
    }
    
    static void logError(String type, String operation, String context, Exception e) {
        String timestamp = LocalDateTime.now().format(formatter);
        
        System.err.println("=== ERROR LOG ===");
        System.err.println("Timestamp: " + timestamp);
        System.err.println("Type: " + type);
        System.err.println("Operation: " + operation);
        System.err.println("Context: " + context);
        System.err.println("Message: " + e.getMessage());
        System.err.println("Exception: " + e.getClass().getName());
        
        System.err.println("\nStack Trace:");
        for (StackTraceElement element : e.getStackTrace()) {
            System.err.println("  at " + element);
        }
        System.err.println("================\n");
    }
    
    public static void main(String[] args) {
        System.out.println("=== Log Exceptions Properly ===\n");
        
        System.out.println("Bad logging:");
        badLogging();
        
        System.out.println("\nGood logging:");
        goodLogging("readFile", "nonexistent.txt");
    }
}
```

---

## üíª Example 8: Clean Up Resources

```java
import java.io.*;

public class CleanUpResources {
    // ‚ùå BAD: Resource leak
    static class BadFileHandler {
        void processFile(String filename) {
            try {
                BufferedReader reader = new BufferedReader(new FileReader(filename));
                System.out.println(reader.readLine());
                // Reader never closed - resource leak!
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
    }
    
    // ‚úÖ GOOD: Proper cleanup with try-with-resources
    static class GoodFileHandler {
        void processFile(String filename) {
            try (BufferedReader reader = new BufferedReader(new FileReader(filename))) {
                String line;
                while ((line = reader.readLine()) != null) {
                    System.out.println(line);
                }
                // Reader automatically closed
            } catch (IOException e) {
                System.err.println("Error processing file: " + filename);
                e.printStackTrace();
            }
        }
        
        // Multiple resources
        void copyFile(String source, String dest) {
            try (
                BufferedReader reader = new BufferedReader(new FileReader(source));
                BufferedWriter writer = new BufferedWriter(new FileWriter(dest))
            ) {
                String line;
                while ((line = reader.readLine()) != null) {
                    writer.write(line);
                    writer.newLine();
                }
                System.out.println("File copied successfully");
            } catch (IOException e) {
                System.err.println("Error copying file");
                e.printStackTrace();
            }
        }
    }
    
    public static void main(String[] args) {
        System.out.println("=== Clean Up Resources ===\n");
        
        GoodFileHandler handler = new GoodFileHandler();
        handler.processFile("test.txt");
    }
}
```

---

## üíª Example 9: Document Exceptions

```java
import java.io.*;

public class DocumentExceptions {
    // ‚ùå BAD: No documentation
    static int divide(int a, int b) {
        return a / b;  // What if b is zero?
    }
    
    /**
     * ‚úÖ GOOD: Well documented
     * 
     * Divides two numbers.
     * 
     * @param dividend The number to be divided
     * @param divisor The number to divide by
     * @return The result of division
     * @throws IllegalArgumentException if divisor is zero
     */
    static double divideNumbers(int dividend, int divisor) {
        if (divisor == 0) {
            throw new IllegalArgumentException("Divisor cannot be zero");
        }
        return (double) dividend / divisor;
    }
    
    /**
     * ‚úÖ GOOD: Document checked exceptions
     * 
     * Reads the first line from a file.
     * 
     * @param filename Path to the file to read
     * @return The first line of the file
     * @throws FileNotFoundException if the file doesn't exist
     * @throws IOException if an I/O error occurs
     */
    static String readFirstLine(String filename) throws IOException {
        try (BufferedReader reader = new BufferedReader(new FileReader(filename))) {
            return reader.readLine();
        }
    }
    
    /**
     * ‚úÖ GOOD: Document unchecked exceptions too
     * 
     * Validates and processes user input.
     * 
     * @param input User input string
     * @throws NullPointerException if input is null
     * @throws IllegalArgumentException if input is empty or invalid format
     */
    static void processInput(String input) {
        if (input == null) {
            throw new NullPointerException("Input cannot be null");
        }
        if (input.isEmpty()) {
            throw new IllegalArgumentException("Input cannot be empty");
        }
        System.out.println("Processing: " + input);
    }
    
    public static void main(String[] args) {
        System.out.println("=== Document Exceptions ===\n");
        
        System.out.println("Division: " + divideNumbers(10, 2));
        
        try {
            readFirstLine("test.txt");
        } catch (IOException e) {
            System.out.println("File error: " + e.getMessage());
        }
        
        processInput("valid input");
    }
}
```

---

## üíª Example 10: Real-World Example - User Service

```java
import java.util.*;

// Custom exceptions
class UserNotFoundException extends Exception {
    public UserNotFoundException(String userId) {
        super("User not found: " + userId);
    }
}

class InvalidUserDataException extends RuntimeException {
    public InvalidUserDataException(String message) {
        super(message);
    }
}

class User {
    private String id;
    private String name;
    private String email;
    
    public User(String id, String name, String email) {
        this.id = id;
        this.name = name;
        this.email = email;
    }
    
    public String getId() { return id; }
    public String getName() { return name; }
    public String getEmail() { return email; }
}

class UserService {
    private Map<String, User> users = new HashMap<>();
    
    /**
     * Creates a new user.
     * 
     * @param id User ID
     * @param name User name
     * @param email User email
     * @return Created user
     * @throws InvalidUserDataException if validation fails
     */
    public User createUser(String id, String name, String email) {
        // ‚úÖ Validate early
        validateUserId(id);
        validateName(name);
        validateEmail(email);
        
        // ‚úÖ Check business rules
        if (users.containsKey(id)) {
            throw new InvalidUserDataException("User ID already exists: " + id);
        }
        
        User user = new User(id, name, email);
        users.put(id, user);
        
        // ‚úÖ Log success
        System.out.println("User created: " + id);
        
        return user;
    }
    
    /**
     * Gets a user by ID.
     * 
     * @param userId User ID
     * @return User object
     * @throws UserNotFoundException if user doesn't exist
     */
    public User getUser(String userId) throws UserNotFoundException {
        // ‚úÖ Validate input
        if (userId == null || userId.isEmpty()) {
            throw new InvalidUserDataException("User ID cannot be null or empty");
        }
        
        User user = users.get(userId);
        
        // ‚úÖ Throw specific exception
        if (user == null) {
            throw new UserNotFoundException(userId);
        }
        
        return user;
    }
    
    // ‚úÖ Private validation methods with meaningful messages
    private void validateUserId(String id) {
        if (id == null || id.isEmpty()) {
            throw new InvalidUserDataException("User ID cannot be null or empty");
        }
        if (id.length() < 3) {
            throw new InvalidUserDataException(
                "User ID must be at least 3 characters, got: " + id.length());
        }
    }
    
    private void validateName(String name) {
        if (name == null || name.isEmpty()) {
            throw new InvalidUserDataException("Name cannot be null or empty");
        }
        if (name.length() < 2) {
            throw new InvalidUserDataException(
                "Name must be at least 2 characters, got: " + name.length());
        }
    }
    
    private void validateEmail(String email) {
        if (email == null || email.isEmpty()) {
            throw new InvalidUserDataException("Email cannot be null or empty");
        }
        if (!email.contains("@")) {
            throw new InvalidUserDataException("Email must contain @: " + email);
        }
    }
}

public class UserServiceExample {
    public static void main(String[] args) {
        System.out.println("=== Best Practices Example: User Service ===\n");
        
        UserService service = new UserService();
        
        // Test 1: Valid user creation
        System.out.println("1. Creating valid user:");
        try {
            User user1 = service.createUser("user001", "John Doe", "john@example.com");
            System.out.println("Success: " + user1.getName());
        } catch (InvalidUserDataException e) {
            System.err.println("Validation error: " + e.getMessage());
        }
        
        // Test 2: Invalid user ID
        System.out.println("\n2. Invalid user ID:");
        try {
            service.createUser("ab", "Jane", "jane@example.com");
        } catch (InvalidUserDataException e) {
            System.err.println("Validation error: " + e.getMessage());
        }
        
        // Test 3: Invalid email
        System.out.println("\n3. Invalid email:");
        try {
            service.createUser("user002", "Jane", "invalidemail");
        } catch (InvalidUserDataException e) {
            System.err.println("Validation error: " + e.getMessage());
        }
        
        // Test 4: Get existing user
        System.out.println("\n4. Getting existing user:");
        try {
            User user = service.getUser("user001");
            System.out.println("Found: " + user.getName());
        } catch (UserNotFoundException e) {
            System.err.println("Error: " + e.getMessage());
        }
        
        // Test 5: Get non-existent user
        System.out.println("\n5. Getting non-existent user:");
        try {
            service.getUser("user999");
        } catch (UserNotFoundException e) {
            System.err.println("Error: " + e.getMessage());
        }
    }
}
```

---

## üìä Best Practices Summary

| Practice | ‚ùå Don't | ‚úÖ Do |
|----------|---------|------|
| **Catch** | Catch Exception | Catch specific types |
| **Handling** | Empty catch block | Log or handle properly |
| **Resources** | Manual close in finally | Use try-with-resources |
| **Validation** | Late validation | Validate early, fail fast |
| **Messages** | Generic messages | Descriptive messages |
| **Flow** | Exception for control | Proper conditions |
| **Logging** | System.out | Proper logger with context |
| **Cleanup** | Forget to close | Always clean up |
| **Documentation** | No documentation | Document all exceptions |
| **Throwing** | throw new Exception() | Throw specific exceptions |

---

## üéØ Interview Questions

1. **What are exception handling best practices?**
2. **Why catch specific exceptions?**
3. **Why not use empty catch blocks?**
4. **Benefits of try-with-resources?**
5. **What is fail-fast principle?**
6. **How to log exceptions properly?**
7. **What is exception swallowing?**
8. **Should we use exceptions for flow control?**
9. **How to clean up resources?**
10. **Why document exceptions?**
11. **Checked or unchecked for validation?**
12. **How to provide meaningful error messages?**
13. **What is resource leak?**
14. **When to create custom exceptions?**
15. **Common exception handling mistakes?**

---

## üìö Related Topics

- [Exception Basics](01.%20Exception%20Basics.md)
- [try-catch-finally](02.%20try-catch-finally.md)
- [Custom Exceptions](06.%20Custom%20Exceptions.md)
- [try-with-resources](07.%20try-with-resources.md)
