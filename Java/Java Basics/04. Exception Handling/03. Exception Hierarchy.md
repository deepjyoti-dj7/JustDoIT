# üå≥ Exception Hierarchy

## üìñ Overview

Java's exception hierarchy is a well-organized tree structure with **Throwable** as the root class. Understanding this hierarchy is crucial for effective exception handling.

```
                    Object
                      |
                  Throwable
                   /     \
              Error      Exception
               |            |
          (Unchecked)    RuntimeException    IOException
                            |                    |
                      (Unchecked)           (Checked)
```

---

## üéØ Throwable Class (Root)

**Throwable** is the superclass of all errors and exceptions in Java.

**Two main branches:**
1. **Error** - Serious problems (unchecked)
2. **Exception** - Recoverable problems

**Key methods:**
- `getMessage()` - Returns error message
- `printStackTrace()` - Prints stack trace
- `toString()` - Returns string representation
- `getCause()` - Returns cause of exception

---

## üíª Example 1: Throwable Class Hierarchy

```java
public class ThrowableHierarchy {
    public static void main(String[] args) {
        System.out.println("=== Throwable Hierarchy ===\n");
        
        // Creating different exceptions
        ArithmeticException ae = new ArithmeticException("Division by zero");
        NullPointerException npe = new NullPointerException("Null reference");
        IOException ioe = new IOException("File not found");
        
        // All are Throwable
        System.out.println("ArithmeticException instanceof Throwable: " 
            + (ae instanceof Throwable));
        System.out.println("NullPointerException instanceof Throwable: " 
            + (npe instanceof Throwable));
        System.out.println("IOException instanceof Throwable: " 
            + (ioe instanceof Throwable));
        
        System.out.println("\n=== Hierarchy Check ===");
        System.out.println("ArithmeticException instanceof Exception: " 
            + (ae instanceof Exception));
        System.out.println("ArithmeticException instanceof RuntimeException: " 
            + (ae instanceof RuntimeException));
        
        System.out.println("\n=== Class Names ===");
        System.out.println("ArithmeticException superclass: " 
            + ae.getClass().getSuperclass().getSimpleName());
        System.out.println("RuntimeException superclass: " 
            + RuntimeException.class.getSuperclass().getSimpleName());
        System.out.println("Exception superclass: " 
            + Exception.class.getSuperclass().getSimpleName());
    }
}
```

---

## üíª Example 2: Error vs Exception

```java
public class ErrorVsException {
    public static void main(String[] args) {
        System.out.println("=== Demonstrating Error vs Exception ===\n");
        
        // Exception - Can be caught and handled
        System.out.println("1. Exception (Recoverable):");
        try {
            int result = 10 / 0;
        } catch (ArithmeticException e) {
            System.out.println("   Caught and handled: " + e.getClass().getSimpleName());
        }
        
        // Error - Serious, usually shouldn't catch
        System.out.println("\n2. Error (Usually not recoverable):");
        try {
            recursiveMethod(0);
        } catch (StackOverflowError e) {
            System.out.println("   Caught StackOverflowError (not recommended)");
            System.out.println("   Error: " + e.getClass().getSimpleName());
        }
        
        System.out.println("\n3. Hierarchy comparison:");
        System.out.println("   Error extends Throwable: " 
            + Throwable.class.isAssignableFrom(Error.class));
        System.out.println("   Exception extends Throwable: " 
            + Throwable.class.isAssignableFrom(Exception.class));
    }
    
    static void recursiveMethod(int count) {
        recursiveMethod(count + 1);  // Causes StackOverflowError
    }
}
```

---

## üíª Example 3: RuntimeException (Unchecked)

```java
public class RuntimeExceptions {
    public static void main(String[] args) {
        System.out.println("=== Common RuntimeExceptions ===\n");
        
        // 1. ArithmeticException
        try {
            int x = 10 / 0;
        } catch (ArithmeticException e) {
            System.out.println("1. ArithmeticException: " + e.getMessage());
        }
        
        // 2. NullPointerException
        try {
            String str = null;
            str.length();
        } catch (NullPointerException e) {
            System.out.println("2. NullPointerException: " + e.getClass().getSimpleName());
        }
        
        // 3. ArrayIndexOutOfBoundsException
        try {
            int[] arr = {1, 2, 3};
            int x = arr[5];
        } catch (ArrayIndexOutOfBoundsException e) {
            System.out.println("3. ArrayIndexOutOfBoundsException: " + e.getMessage());
        }
        
        // 4. NumberFormatException
        try {
            int num = Integer.parseInt("abc");
        } catch (NumberFormatException e) {
            System.out.println("4. NumberFormatException: " + e.getMessage());
        }
        
        // 5. IllegalArgumentException
        try {
            Thread.sleep(-100);
        } catch (IllegalArgumentException e) {
            System.out.println("5. IllegalArgumentException: " + e.getMessage());
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        
        // 6. ClassCastException
        try {
            Object obj = "Hello";
            Integer num = (Integer) obj;
        } catch (ClassCastException e) {
            System.out.println("6. ClassCastException: " + e.getMessage());
        }
        
        System.out.println("\nAll RuntimeExceptions extend RuntimeException class");
    }
}
```

---

## üíª Example 4: Checked Exceptions

```java
import java.io.*;
import java.sql.*;

public class CheckedExceptions {
    public static void main(String[] args) {
        System.out.println("=== Checked Exceptions (Must Handle) ===\n");
        
        // 1. IOException
        System.out.println("1. IOException:");
        try {
            FileReader fr = new FileReader("nonexistent.txt");
        } catch (FileNotFoundException e) {
            System.out.println("   Caught: " + e.getClass().getSimpleName());
        }
        
        // 2. ClassNotFoundException
        System.out.println("\n2. ClassNotFoundException:");
        try {
            Class.forName("com.nonexistent.Class");
        } catch (ClassNotFoundException e) {
            System.out.println("   Caught: " + e.getClass().getSimpleName());
        }
        
        // 3. InterruptedException
        System.out.println("\n3. InterruptedException:");
        try {
            Thread.sleep(1000);
            System.out.println("   Thread slept successfully");
        } catch (InterruptedException e) {
            System.out.println("   Caught: " + e.getClass().getSimpleName());
        }
        
        // 4. SQLException (simulated)
        System.out.println("\n4. SQLException:");
        try {
            throw new SQLException("Database connection failed");
        } catch (SQLException e) {
            System.out.println("   Caught: " + e.getClass().getSimpleName());
            System.out.println("   Message: " + e.getMessage());
        }
        
        System.out.println("\nChecked exceptions must be caught or declared");
    }
}
```

---

## üíª Example 5: Complete Hierarchy Tree

```java
public class CompleteHierarchy {
    static void demonstrateHierarchy(Throwable t) {
        System.out.println("\nAnalyzing: " + t.getClass().getSimpleName());
        System.out.println("  Message: " + t.getMessage());
        System.out.println("  Hierarchy:");
        
        Class<?> clazz = t.getClass();
        int level = 0;
        while (clazz != null) {
            System.out.println("    " + "  ".repeat(level) + "‚îî‚îÄ " + clazz.getSimpleName());
            clazz = clazz.getSuperclass();
            level++;
        }
    }
    
    public static void main(String[] args) {
        System.out.println("=== Java Exception Hierarchy ===");
        
        // RuntimeException branch
        demonstrateHierarchy(new ArithmeticException("Division by zero"));
        demonstrateHierarchy(new NullPointerException("Null reference"));
        demonstrateHierarchy(new ArrayIndexOutOfBoundsException("Index 5"));
        
        // Checked Exception branch
        demonstrateHierarchy(new IOException("I/O error"));
        demonstrateHierarchy(new SQLException("DB error"));
        
        // Error branch
        demonstrateHierarchy(new OutOfMemoryError("Heap space"));
    }
}
```

---

## üíª Example 6: Catching at Different Levels

```java
public class CatchingAtLevels {
    public static void main(String[] args) {
        // Level 1: Catch specific exception
        System.out.println("=== Level 1: Specific Exception ===");
        try {
            int result = 10 / 0;
        } catch (ArithmeticException e) {
            System.out.println("Caught ArithmeticException");
        }
        
        // Level 2: Catch RuntimeException
        System.out.println("\n=== Level 2: RuntimeException ===");
        try {
            int result = 10 / 0;
        } catch (RuntimeException e) {
            System.out.println("Caught RuntimeException: " + e.getClass().getSimpleName());
        }
        
        // Level 3: Catch Exception
        System.out.println("\n=== Level 3: Exception ===");
        try {
            int result = 10 / 0;
        } catch (Exception e) {
            System.out.println("Caught Exception: " + e.getClass().getSimpleName());
        }
        
        // Level 4: Catch Throwable
        System.out.println("\n=== Level 4: Throwable ===");
        try {
            int result = 10 / 0;
        } catch (Throwable t) {
            System.out.println("Caught Throwable: " + t.getClass().getSimpleName());
        }
        
        System.out.println("\nAll catch the same exception at different hierarchy levels");
    }
}
```

---

## üíª Example 7: Common Error Types

```java
public class CommonErrors {
    public static void main(String[] args) {
        System.out.println("=== Common Error Types ===\n");
        
        // 1. StackOverflowError
        System.out.println("1. StackOverflowError (commented out to prevent crash)");
        // recursiveMethod();
        
        // 2. OutOfMemoryError (simulated)
        System.out.println("2. OutOfMemoryError (simulated)");
        try {
            int[] largeArray = new int[Integer.MAX_VALUE];
        } catch (OutOfMemoryError e) {
            System.out.println("   Caught: " + e.getClass().getSimpleName());
        }
        
        // 3. NoClassDefFoundError (simulated with message)
        System.out.println("\n3. NoClassDefFoundError");
        System.out.println("   Occurs when: Class not found at runtime");
        System.out.println("   Type: " + NoClassDefFoundError.class.getSuperclass().getSimpleName());
        
        // 4. ExceptionInInitializerError
        System.out.println("\n4. ExceptionInInitializerError");
        try {
            Class.forName("ErrorClass");
        } catch (ClassNotFoundException e) {
            System.out.println("   Related to static initialization");
        }
        
        System.out.println("\n=== Error Hierarchy ===");
        System.out.println("Error ‚Üí Throwable ‚Üí Object");
        System.out.println("VirtualMachineError ‚Üí Error");
        System.out.println("  ‚îú‚îÄ StackOverflowError");
        System.out.println("  ‚îú‚îÄ OutOfMemoryError");
        System.out.println("LinkageError ‚Üí Error");
        System.out.println("  ‚îú‚îÄ NoClassDefFoundError");
        System.out.println("  ‚îî‚îÄ ExceptionInInitializerError");
    }
    
    static void recursiveMethod() {
        recursiveMethod();
    }
}
```

---

## üíª Example 8: instanceof with Exception Hierarchy

```java
public class InstanceOfHierarchy {
    public static void main(String[] args) {
        Exception[] exceptions = {
            new ArithmeticException("Math error"),
            new NullPointerException("Null error"),
            new IOException("I/O error"),
            new SQLException("DB error"),
            new RuntimeException("Runtime error")
        };
        
        System.out.println("=== instanceof Checks ===\n");
        
        for (Exception e : exceptions) {
            System.out.println(e.getClass().getSimpleName() + ":");
            System.out.println("  instanceof Throwable: " + (e instanceof Throwable));
            System.out.println("  instanceof Exception: " + (e instanceof Exception));
            System.out.println("  instanceof RuntimeException: " + (e instanceof RuntimeException));
            System.out.println("  instanceof IOException: " + (e instanceof IOException));
            System.out.println();
        }
    }
}
```

---

## üíª Example 9: Custom Exception in Hierarchy

```java
// Custom checked exception
class CustomCheckedException extends Exception {
    public CustomCheckedException(String message) {
        super(message);
    }
}

// Custom unchecked exception
class CustomUncheckedException extends RuntimeException {
    public CustomUncheckedException(String message) {
        super(message);
    }
}

public class CustomExceptionHierarchy {
    public static void main(String[] args) {
        System.out.println("=== Custom Exception Hierarchy ===\n");
        
        // Checked exception
        System.out.println("1. Custom Checked Exception:");
        try {
            throw new CustomCheckedException("Custom checked error");
        } catch (CustomCheckedException e) {
            System.out.println("   Caught: " + e.getClass().getSimpleName());
            System.out.println("   Is Exception: " + (e instanceof Exception));
            System.out.println("   Is RuntimeException: " + (e instanceof RuntimeException));
        }
        
        // Unchecked exception
        System.out.println("\n2. Custom Unchecked Exception:");
        try {
            throw new CustomUncheckedException("Custom runtime error");
        } catch (CustomUncheckedException e) {
            System.out.println("   Caught: " + e.getClass().getSimpleName());
            System.out.println("   Is RuntimeException: " + (e instanceof RuntimeException));
            System.out.println("   Is Exception: " + (e instanceof Exception));
        }
        
        System.out.println("\n=== Hierarchy ===");
        System.out.println("CustomCheckedException ‚Üí Exception ‚Üí Throwable");
        System.out.println("CustomUncheckedException ‚Üí RuntimeException ‚Üí Exception ‚Üí Throwable");
    }
}
```

---

## üíª Example 10: Polymorphic Exception Handling

```java
class ExceptionHandler {
    void handleException(Throwable t) {
        System.out.println("\nHandling: " + t.getClass().getSimpleName());
        
        if (t instanceof Error) {
            System.out.println("  Type: Error (Serious problem)");
            System.out.println("  Action: Log and terminate");
        } else if (t instanceof RuntimeException) {
            System.out.println("  Type: RuntimeException (Unchecked)");
            System.out.println("  Action: Log and continue");
        } else if (t instanceof IOException) {
            System.out.println("  Type: IOException (Checked)");
            System.out.println("  Action: Retry or inform user");
        } else if (t instanceof Exception) {
            System.out.println("  Type: Exception (Checked)");
            System.out.println("  Action: Handle appropriately");
        }
        
        System.out.println("  Message: " + t.getMessage());
    }
}

public class PolymorphicHandling {
    public static void main(String[] args) {
        ExceptionHandler handler = new ExceptionHandler();
        
        System.out.println("=== Polymorphic Exception Handling ===");
        
        handler.handleException(new ArithmeticException("Division by zero"));
        handler.handleException(new IOException("File not found"));
        handler.handleException(new NullPointerException("Null reference"));
        handler.handleException(new SQLException("DB connection failed"));
        handler.handleException(new OutOfMemoryError("Heap space"));
    }
}
```

---

## üìä Exception Hierarchy Diagram

```
                        Throwable
                       /         \
                   Error          Exception
                     |               |
          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îú‚îÄ‚îÄ‚îÄ IOException
          |                   |      |      ‚îú‚îÄ FileNotFoundException
  VirtualMachineError  LinkageError |      ‚îî‚îÄ EOFException
          |                   |      |
  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îú‚îÄ‚îÄ‚îÄ SQLException
  |               |   |           | |
StackOverflow OutOfMemory NoClassDef  ‚îú‚îÄ‚îÄ‚îÄ ClassNotFoundException
Error         Error      FoundError   |
                                      ‚îú‚îÄ‚îÄ‚îÄ InterruptedException
                                      |
                                  RuntimeException
                                      |
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    |                 |                 |
            ArithmeticException NullPointer   ArrayIndexOutOf
                              Exception    BoundsException
                                      |
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    |                 |                 |
            NumberFormat    IllegalArgument  ClassCast
            Exception         Exception      Exception
```

---

## üìä Exception Types Comparison

| Category | Type | Checked? | Example | When to Use |
|----------|------|----------|---------|-------------|
| **Error** | VirtualMachineError | No | StackOverflowError | JVM problems |
| | LinkageError | No | NoClassDefFoundError | Class loading |
| **Checked Exception** | IOException | Yes | FileNotFoundException | File operations |
| | SQLException | Yes | SQLException | Database ops |
| | ClassNotFoundException | Yes | ClassNotFoundException | Reflection |
| **Unchecked Exception** | ArithmeticException | No | Division by zero | Math errors |
| | NullPointerException | No | Null reference | Null checks |
| | ArrayIndexOutOfBoundsException | No | Invalid index | Array access |

---

## üí° Best Practices

1. ‚úÖ **Catch specific exceptions first**
   ```java
   try { }
   catch (FileNotFoundException e) { }  // Specific
   catch (IOException e) { }            // General
   ```

2. ‚úÖ **Don't catch Error**
   ```java
   // Bad
   try { } catch (Error e) { }
   
   // Good - let JVM handle errors
   try { } catch (Exception e) { }
   ```

3. ‚úÖ **Create meaningful exception hierarchy**
   ```java
   class AppException extends Exception { }
   class ValidationException extends AppException { }
   class BusinessException extends AppException { }
   ```

4. ‚úÖ **Use checked for recoverable, unchecked for programming errors**
   ```java
   // Checked - user can fix
   throw new FileNotFoundException();
   
   // Unchecked - programming error
   throw new IllegalArgumentException();
   ```

---

## ‚ö†Ô∏è Common Pitfalls

```java
public class HierarchyPitfalls {
    void demonstrate() {
        // 1. Catching parent before child
        // try { }
        // catch (Exception e) { }
        // catch (IOException e) { }  // ERROR: Unreachable
        
        // 2. Catching Error unnecessarily
        try {
            // code
        } catch (OutOfMemoryError e) {  // Usually shouldn't catch
            // Can't recover from this
        }
        
        // 3. Not using hierarchy properly
        try {
            // code
        } catch (Throwable t) {  // Too broad, catches Error too
            // Handle
        }
    }
}
```

---

## üéØ Interview Questions

1. **What is the root of exception hierarchy?**
2. **Difference between Error and Exception?**
3. **What is RuntimeException?**
4. **What are checked exceptions?**
5. **What are unchecked exceptions?**
6. **Can we catch Error class?**
7. **Common RuntimeException types?**
8. **Common checked exception types?**
9. **What is Throwable class?**
10. **Difference between Exception and RuntimeException?**
11. **What is OutOfMemoryError?**
12. **What is StackOverflowError?**
13. **Order of catch blocks in hierarchy?**
14. **Can custom exceptions extend Error?**
15. **What is VirtualMachineError?**

---

## üìö Related Topics

- [Exception Basics](01.%20Exception%20Basics.md)
- [Checked vs Unchecked Exceptions](04.%20Checked%20vs%20Unchecked%20Exceptions.md)
- [Custom Exceptions](06.%20Custom%20Exceptions.md)
- [throw & throws](05.%20throw%20%26%20throws.md)
