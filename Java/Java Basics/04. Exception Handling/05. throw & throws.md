# ðŸš€ throw & throws

## ðŸ“– Overview

**throw** and **throws** are keywords used for exception handling in Java, but they serve different purposes:

- **throw** - Used to explicitly throw an exception
- **throws** - Used to declare exceptions that a method might throw

---

## ðŸŽ¯ Key Differences

| Feature | throw | throws |
|---------|-------|--------|
| **Purpose** | Throw exception | Declare exception |
| **Location** | Inside method body | Method signature |
| **Followed by** | Exception object | Exception class(es) |
| **Number** | Single exception | Multiple exceptions |
| **Syntax** | `throw new Exception()` | `throws Exception1, Exception2` |
| **Type** | Keyword | Keyword |

---

## ðŸ’» Example 1: Basic throw

```java
public class BasicThrow {
    static void validateAge(int age) {
        if (age < 18) {
            // Explicitly throwing exception
            throw new IllegalArgumentException("Age must be 18 or above");
        }
        System.out.println("Age is valid: " + age);
    }
    
    static void divide(int a, int b) {
        if (b == 0) {
            throw new ArithmeticException("Cannot divide by zero");
        }
        System.out.println("Result: " + (a / b));
    }
    
    public static void main(String[] args) {
        System.out.println("=== throw Keyword Examples ===\n");
        
        // Example 1: Valid age
        System.out.println("1. Valid age:");
        validateAge(20);
        
        // Example 2: Invalid age
        System.out.println("\n2. Invalid age:");
        try {
            validateAge(15);
        } catch (IllegalArgumentException e) {
            System.out.println("Error: " + e.getMessage());
        }
        
        // Example 3: Division
        System.out.println("\n3. Division:");
        divide(10, 2);
        
        // Example 4: Division by zero
        System.out.println("\n4. Division by zero:");
        try {
            divide(10, 0);
        } catch (ArithmeticException e) {
            System.out.println("Error: " + e.getMessage());
        }
    }
}
```

---

## ðŸ’» Example 2: Basic throws

```java
import java.io.*;

public class BasicThrows {
    // Declaring that method might throw IOException
    static void readFile(String filename) throws IOException {
        FileReader fr = new FileReader(filename);
        System.out.println("File opened successfully");
        fr.close();
    }
    
    // Multiple exceptions
    static void processFile(String filename) throws IOException, ClassNotFoundException {
        readFile(filename);
        Class.forName("SomeClass");
    }
    
    // No throws needed for unchecked exceptions
    static void divide(int a, int b) {
        int result = a / b;  // May throw ArithmeticException (unchecked)
        System.out.println("Result: " + result);
    }
    
    public static void main(String[] args) {
        System.out.println("=== throws Keyword Examples ===\n");
        
        // Must handle declared exceptions
        System.out.println("1. Handling IOException:");
        try {
            readFile("test.txt");
        } catch (IOException e) {
            System.out.println("Error: " + e.getClass().getSimpleName());
        }
        
        System.out.println("\n2. Handling multiple exceptions:");
        try {
            processFile("test.txt");
        } catch (IOException e) {
            System.out.println("I/O Error: " + e.getMessage());
        } catch (ClassNotFoundException e) {
            System.out.println("Class Error: " + e.getMessage());
        }
        
        System.out.println("\n3. Unchecked exception (no throws needed):");
        try {
            divide(10, 0);
        } catch (ArithmeticException e) {
            System.out.println("Error: " + e.getMessage());
        }
    }
}
```

---

## ðŸ’» Example 3: throw with Custom Messages

```java
class BankAccount {
    private double balance;
    
    public BankAccount(double balance) {
        if (balance < 0) {
            throw new IllegalArgumentException(
                "Initial balance cannot be negative: " + balance);
        }
        this.balance = balance;
    }
    
    public void withdraw(double amount) {
        if (amount <= 0) {
            throw new IllegalArgumentException(
                "Withdrawal amount must be positive: " + amount);
        }
        if (amount > balance) {
            throw new IllegalStateException(
                "Insufficient balance. Balance: " + balance + ", Requested: " + amount);
        }
        balance -= amount;
        System.out.println("Withdrawn: " + amount + ", New balance: " + balance);
    }
    
    public void deposit(double amount) {
        if (amount <= 0) {
            throw new IllegalArgumentException(
                "Deposit amount must be positive: " + amount);
        }
        balance += amount;
        System.out.println("Deposited: " + amount + ", New balance: " + balance);
    }
}

public class ThrowCustomMessages {
    public static void main(String[] args) {
        System.out.println("=== throw with Custom Messages ===\n");
        
        // Test 1: Invalid initial balance
        System.out.println("1. Invalid initial balance:");
        try {
            BankAccount acc = new BankAccount(-100);
        } catch (IllegalArgumentException e) {
            System.out.println("Error: " + e.getMessage());
        }
        
        // Test 2: Valid account
        System.out.println("\n2. Valid operations:");
        BankAccount account = new BankAccount(1000);
        account.deposit(500);
        account.withdraw(300);
        
        // Test 3: Invalid withdrawal
        System.out.println("\n3. Invalid withdrawal:");
        try {
            account.withdraw(-50);
        } catch (IllegalArgumentException e) {
            System.out.println("Error: " + e.getMessage());
        }
        
        // Test 4: Insufficient balance
        System.out.println("\n4. Insufficient balance:");
        try {
            account.withdraw(2000);
        } catch (IllegalStateException e) {
            System.out.println("Error: " + e.getMessage());
        }
    }
}
```

---

## ðŸ’» Example 4: throws with Exception Propagation

```java
import java.io.*;

public class ThrowsPropagation {
    // Level 3: Throws to level 2
    static void readData() throws IOException {
        throw new IOException("Data read error");
    }
    
    // Level 2: Propagates to level 1
    static void processData() throws IOException {
        System.out.println("Processing data...");
        readData();
    }
    
    // Level 1: Propagates to main
    static void handleData() throws IOException {
        System.out.println("Handling data...");
        processData();
    }
    
    public static void main(String[] args) {
        System.out.println("=== Exception Propagation with throws ===\n");
        
        try {
            handleData();
        } catch (IOException e) {
            System.out.println("Caught in main: " + e.getMessage());
            
            System.out.println("\nStack trace:");
            for (StackTraceElement element : e.getStackTrace()) {
                System.out.println("  " + element.getMethodName());
            }
        }
        
        System.out.println("\nException propagated through method chain");
    }
}
```

---

## ðŸ’» Example 5: throw vs throws Together

```java
import java.io.*;

class CustomException extends Exception {
    public CustomException(String message) {
        super(message);
    }
}

public class ThrowAndThrows {
    // throws declares, throw creates and throws the exception
    static void method1(int value) throws CustomException {
        if (value < 0) {
            throw new CustomException("Value cannot be negative: " + value);
        }
        System.out.println("Value is valid: " + value);
    }
    
    // Can throw multiple times, declare once
    static void method2(String str) throws IOException, CustomException {
        if (str == null) {
            throw new CustomException("String cannot be null");
        }
        if (str.isEmpty()) {
            throw new IOException("String cannot be empty");
        }
        System.out.println("String is valid: " + str);
    }
    
    public static void main(String[] args) {
        System.out.println("=== throw and throws Together ===\n");
        
        // Test 1: Valid value
        System.out.println("1. Valid value:");
        try {
            method1(10);
        } catch (CustomException e) {
            System.out.println("Error: " + e.getMessage());
        }
        
        // Test 2: Invalid value
        System.out.println("\n2. Invalid value:");
        try {
            method1(-5);
        } catch (CustomException e) {
            System.out.println("Error: " + e.getMessage());
        }
        
        // Test 3: Null string
        System.out.println("\n3. Null string:");
        try {
            method2(null);
        } catch (CustomException | IOException e) {
            System.out.println("Error: " + e.getMessage());
        }
        
        // Test 4: Empty string
        System.out.println("\n4. Empty string:");
        try {
            method2("");
        } catch (CustomException | IOException e) {
            System.out.println("Error: " + e.getMessage());
        }
        
        // Test 5: Valid string
        System.out.println("\n5. Valid string:");
        try {
            method2("Hello");
        } catch (CustomException | IOException e) {
            System.out.println("Error: " + e.getMessage());
        }
    }
}
```

---

## ðŸ’» Example 6: Rethrowing Exceptions

```java
import java.io.*;

public class RethrowingExceptions {
    static void method1() throws IOException {
        throw new IOException("Original exception");
    }
    
    static void method2() throws IOException {
        try {
            method1();
        } catch (IOException e) {
            System.out.println("Caught in method2: " + e.getMessage());
            System.out.println("Logging and rethrowing...");
            throw e;  // Rethrowing same exception
        }
    }
    
    static void method3() throws Exception {
        try {
            throw new IOException("I/O error");
        } catch (IOException e) {
            System.out.println("Wrapping IOException");
            throw new Exception("Wrapped exception", e);  // Throw new with cause
        }
    }
    
    public static void main(String[] args) {
        System.out.println("=== Rethrowing Exceptions ===\n");
        
        // Example 1: Rethrow same exception
        System.out.println("1. Rethrowing same exception:");
        try {
            method2();
        } catch (IOException e) {
            System.out.println("Caught in main: " + e.getMessage());
        }
        
        // Example 2: Throw new exception with cause
        System.out.println("\n2. Throwing new exception with cause:");
        try {
            method3();
        } catch (Exception e) {
            System.out.println("Caught: " + e.getMessage());
            System.out.println("Cause: " + e.getCause().getMessage());
        }
    }
}
```

---

## ðŸ’» Example 7: Overriding with throws

```java
import java.io.*;

class Parent {
    // Parent method throws IOException
    void method1() throws IOException {
        System.out.println("Parent method1");
    }
    
    // Parent method throws no exception
    void method2() {
        System.out.println("Parent method2");
    }
    
    // Parent throws Exception
    void method3() throws Exception {
        System.out.println("Parent method3");
    }
}

class Child extends Parent {
    // Valid: Same exception
    @Override
    void method1() throws IOException {
        System.out.println("Child method1");
    }
    
    // Valid: Child can throw exception even if parent doesn't
    @Override
    void method2() throws RuntimeException {  // Unchecked OK
        System.out.println("Child method2");
    }
    
    // Valid: Subclass of parent's exception
    @Override
    void method3() throws IOException {  // IOException extends Exception
        System.out.println("Child method3");
    }
    
    // Invalid: Cannot throw broader checked exception
    // @Override
    // void method1() throws Exception {  // ERROR: Exception is broader than IOException
    //     System.out.println("Child method1");
    // }
}

public class OverridingWithThrows {
    public static void main(String[] args) {
        System.out.println("=== Overriding with throws ===\n");
        
        Parent p = new Child();
        
        try {
            p.method1();
            p.method2();
            p.method3();
        } catch (Exception e) {
            System.out.println("Error: " + e.getMessage());
        }
        
        System.out.println("\nRules:");
        System.out.println("- Child can throw same or narrower checked exception");
        System.out.println("- Child can throw any unchecked exception");
        System.out.println("- Child cannot throw broader checked exception");
    }
}
```

---

## ðŸ’» Example 8: throw with Different Exception Types

```java
public class ThrowDifferentTypes {
    static void testThrow(int scenario) {
        switch (scenario) {
            case 1:
                throw new RuntimeException("Runtime exception");
            case 2:
                throw new IllegalArgumentException("Illegal argument");
            case 3:
                throw new NullPointerException("Null pointer");
            case 4:
                throw new ArithmeticException("Arithmetic error");
            case 5:
                throw new IllegalStateException("Illegal state");
            default:
                System.out.println("No exception");
        }
    }
    
    public static void main(String[] args) {
        System.out.println("=== throw with Different Types ===\n");
        
        for (int i = 1; i <= 5; i++) {
            System.out.println("Scenario " + i + ":");
            try {
                testThrow(i);
            } catch (RuntimeException e) {
                System.out.println("Caught: " + e.getClass().getSimpleName());
                System.out.println("Message: " + e.getMessage());
                System.out.println();
            }
        }
        
        testThrow(6);  // No exception
    }
}
```

---

## ðŸ’» Example 9: throws with Method Chaining

```java
import java.io.*;

class FileService {
    File openFile(String filename) throws FileNotFoundException {
        return new File(filename);
    }
    
    BufferedReader getReader(File file) throws FileNotFoundException {
        return new BufferedReader(new FileReader(file));
    }
    
    String readLine(BufferedReader reader) throws IOException {
        return reader.readLine();
    }
    
    // Chain all operations
    String readFirstLine(String filename) throws IOException {
        File file = openFile(filename);
        BufferedReader reader = getReader(file);
        return readLine(reader);
    }
}

public class ThrowsMethodChaining {
    public static void main(String[] args) {
        System.out.println("=== throws with Method Chaining ===\n");
        
        FileService service = new FileService();
        
        // Each method throws, all handled together
        try {
            String line = service.readFirstLine("test.txt");
            System.out.println("First line: " + line);
        } catch (FileNotFoundException e) {
            System.out.println("File not found: " + e.getMessage());
        } catch (IOException e) {
            System.out.println("I/O error: " + e.getMessage());
        }
        
        System.out.println("\nException propagates through chain");
    }
}
```

---

## ðŸ’» Example 10: Real-World Example - Validation Service

```java
class ValidationException extends Exception {
    public ValidationException(String message) {
        super(message);
    }
}

class User {
    private String username;
    private String email;
    private int age;
    
    public User(String username, String email, int age) throws ValidationException {
        validateUsername(username);
        validateEmail(email);
        validateAge(age);
        
        this.username = username;
        this.email = email;
        this.age = age;
    }
    
    private void validateUsername(String username) throws ValidationException {
        if (username == null || username.isEmpty()) {
            throw new ValidationException("Username cannot be empty");
        }
        if (username.length() < 3) {
            throw new ValidationException("Username must be at least 3 characters");
        }
        if (!username.matches("[a-zA-Z0-9]+")) {
            throw new ValidationException("Username can only contain letters and numbers");
        }
    }
    
    private void validateEmail(String email) throws ValidationException {
        if (email == null || email.isEmpty()) {
            throw new ValidationException("Email cannot be empty");
        }
        if (!email.contains("@")) {
            throw new ValidationException("Email must contain @");
        }
    }
    
    private void validateAge(int age) {
        if (age < 0) {
            throw new IllegalArgumentException("Age cannot be negative");
        }
        if (age < 18) {
            throw new IllegalArgumentException("Must be 18 or older");
        }
    }
    
    @Override
    public String toString() {
        return "User{username='" + username + "', email='" + email + "', age=" + age + "}";
    }
}

public class ValidationService {
    public static void main(String[] args) {
        System.out.println("=== Validation Service Example ===\n");
        
        // Test 1: Valid user
        System.out.println("1. Valid user:");
        try {
            User user1 = new User("john123", "john@example.com", 25);
            System.out.println("Created: " + user1);
        } catch (ValidationException e) {
            System.out.println("Validation error: " + e.getMessage());
        } catch (IllegalArgumentException e) {
            System.out.println("Argument error: " + e.getMessage());
        }
        
        // Test 2: Invalid username (checked exception)
        System.out.println("\n2. Invalid username:");
        try {
            User user2 = new User("ab", "user@example.com", 20);
        } catch (ValidationException e) {
            System.out.println("Validation error: " + e.getMessage());
        }
        
        // Test 3: Invalid email (checked exception)
        System.out.println("\n3. Invalid email:");
        try {
            User user3 = new User("user123", "invalidemail", 20);
        } catch (ValidationException e) {
            System.out.println("Validation error: " + e.getMessage());
        }
        
        // Test 4: Invalid age (unchecked exception)
        System.out.println("\n4. Invalid age:");
        try {
            User user4 = new User("user123", "user@example.com", 15);
        } catch (ValidationException e) {
            System.out.println("Validation error: " + e.getMessage());
        } catch (IllegalArgumentException e) {
            System.out.println("Argument error: " + e.getMessage());
        }
        
        System.out.println("\nthrow: Creates exception objects");
        System.out.println("throws: Declares exceptions in signature");
    }
}
```

---

## ðŸ“Š throw vs throws Summary

| Aspect | throw | throws |
|--------|-------|--------|
| **Keyword type** | Used to throw | Used to declare |
| **Usage** | Inside method | In method signature |
| **Syntax** | `throw new Exception()` | `throws Exception` |
| **Purpose** | Create exception | Declare exception |
| **Instance/Class** | Exception instance | Exception class |
| **Count** | One at a time | Multiple classes |
| **Followed by** | Object | Class name(s) |

---

## ðŸ’¡ Best Practices

1. âœ… **throw with descriptive messages**
   ```java
   throw new IllegalArgumentException("Age must be between 0 and 150, got: " + age);
   ```

2. âœ… **Declare checked exceptions with throws**
   ```java
   void readFile(String filename) throws IOException { }
   ```

3. âœ… **Don't declare unchecked exceptions**
   ```java
   // Not necessary
   void divide(int a, int b) throws ArithmeticException { }
   
   // Better
   void divide(int a, int b) { }
   ```

4. âœ… **Rethrow with additional context**
   ```java
   catch (IOException e) {
       throw new ApplicationException("Failed to process file", e);
   }
   ```

5. âœ… **Validate early, throw early**
   ```java
   if (input == null) {
       throw new IllegalArgumentException("Input cannot be null");
   }
   ```

---

## âš ï¸ Common Pitfalls

```java
public class ThrowThrowsPitfalls {
    // 1. Throwing without throws declaration (for checked)
    // void method() {
    //     throw new IOException();  // ERROR: Must declare with throws
    // }
    
    // 2. Declaring exception but never throwing
    void unnecessaryThrows() throws IOException {
        // No IOException thrown - misleading
        System.out.println("Hello");
    }
    
    // 3. Throwing null
    void throwNull() {
        // throw null;  // NullPointerException at runtime
    }
    
    // 4. Swallowing exception when rethrowing
    void lostException() {
        try {
            // code
        } catch (Exception e) {
            throw new RuntimeException("Error");  // Lost original exception!
        }
    }
}
```

---

## ðŸŽ¯ Interview Questions

1. **What is throw keyword?**
2. **What is throws keyword?**
3. **Difference between throw and throws?**
4. **Can we throw multiple exceptions?**
5. **Can we use throw and throws together?**
6. **Can we throw checked exceptions without throws?**
7. **Can we rethrow an exception?**
8. **What is exception propagation?**
9. **Can child method throw broader exception than parent?**
10. **Can we throw null?**
11. **Do we need throws for unchecked exceptions?**
12. **Can we have multiple exceptions in throws?**
13. **What happens if we don't handle thrown exception?**
14. **Can we use throw without new?**
15. **Best practices for throw and throws?**

---

## ðŸ“š Related Topics

- [Exception Basics](01.%20Exception%20Basics.md)
- [Checked vs Unchecked Exceptions](04.%20Checked%20vs%20Unchecked%20Exceptions.md)
- [Custom Exceptions](06.%20Custom%20Exceptions.md)
- [Best Practices](08.%20Best%20Practices.md)
