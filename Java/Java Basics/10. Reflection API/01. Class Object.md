# üîç Class Object

## üìñ Overview

The **Class object** is the entry point to Java Reflection. Every type in Java (classes, interfaces, enums, arrays, primitives) has a `Class<?>` object that contains metadata about the type.

**Key Capabilities:**
- Inspect class structure
- Access fields, methods, constructors
- Create instances dynamically
- Check type information

---

## üíª Obtaining Class Objects

### Method 1: .class Syntax

```java
// For any type
Class<String> stringClass = String.class;
Class<Integer> intClass = int.class;
Class<List> listClass = List.class;

// For arrays
Class<int[]> intArrayClass = int[].class;
Class<String[]> stringArrayClass = String[].class;
```

### Method 2: Object.getClass()

```java
String str = "Hello";
Class<? extends String> clazz = str.getClass();

List<Integer> list = new ArrayList<>();
Class<? extends List> listClass = list.getClass();  // ArrayList.class
```

### Method 3: Class.forName()

```java
try {
    // Fully qualified name
    Class<?> clazz = Class.forName("java.lang.String");
    Class<?> arrayListClass = Class.forName("java.util.ArrayList");
    
    // Array types
    Class<?> intArrayClass = Class.forName("[I");  // int[]
    Class<?> stringArrayClass = Class.forName("[Ljava.lang.String;");  // String[]
    
} catch (ClassNotFoundException e) {
    e.printStackTrace();
}
```

### Comparison

```java
// All three methods for same class
Class<String> c1 = String.class;                    // Compile-time
Class<?> c2 = "Hello".getClass();                   // Runtime
Class<?> c3 = Class.forName("java.lang.String");    // Dynamic loading

System.out.println(c1 == c2);  // true
System.out.println(c2 == c3);  // true
```

---

## üíª Class Metadata

### Basic Information

```java
Class<?> clazz = String.class;

// Name information
String name = clazz.getName();              // java.lang.String
String simpleName = clazz.getSimpleName();  // String
String canonicalName = clazz.getCanonicalName();  // java.lang.String
Package pkg = clazz.getPackage();           // package java.lang

// Modifiers
int modifiers = clazz.getModifiers();
boolean isPublic = Modifier.isPublic(modifiers);
boolean isFinal = Modifier.isFinal(modifiers);
boolean isAbstract = Modifier.isAbstract(modifiers);

System.out.println("Public: " + isPublic);    // true
System.out.println("Final: " + isFinal);      // true
System.out.println("Abstract: " + isAbstract);  // false
```

### Type Checking

```java
Class<?> clazz = ArrayList.class;

// Type queries
boolean isInterface = clazz.isInterface();        // false
boolean isEnum = clazz.isEnum();                  // false
boolean isArray = clazz.isArray();                // false
boolean isPrimitive = clazz.isPrimitive();        // false
boolean isAnnotation = clazz.isAnnotation();      // false

// Primitive check
Class<?> intClass = int.class;
System.out.println(intClass.isPrimitive());  // true
```

### Superclass and Interfaces

```java
Class<?> clazz = ArrayList.class;

// Superclass
Class<?> superClass = clazz.getSuperclass();  // AbstractList

// Interfaces
Class<?>[] interfaces = clazz.getInterfaces();
for (Class<?> iface : interfaces) {
    System.out.println(iface.getName());
    // java.util.List
    // java.util.RandomAccess
    // java.lang.Cloneable
    // java.io.Serializable
}
```

---

## üíª Type Checking with instanceof

### Class.isInstance()

```java
Object obj = "Hello";
Class<?> stringClass = String.class;

// Similar to instanceof
boolean result = stringClass.isInstance(obj);
System.out.println(result);  // true

// Dynamic type checking
if (String.class.isInstance(obj)) {
    String str = (String) obj;
    System.out.println(str.toUpperCase());
}
```

### Class.isAssignableFrom()

```java
// Check if one class is assignable from another
Class<?> listClass = List.class;
Class<?> arrayListClass = ArrayList.class;

// Is ArrayList assignable to List?
boolean assignable = listClass.isAssignableFrom(arrayListClass);
System.out.println(assignable);  // true

// Common use case - checking hierarchy
if (Collection.class.isAssignableFrom(ArrayList.class)) {
    System.out.println("ArrayList is a Collection");
}
```

---

## üéØ Complete Examples

### Example 1: Class Inspector

```java
public class ClassInspector {
    
    public static void inspect(Class<?> clazz) {
        System.out.println("=== Class Information ===");
        System.out.println("Name: " + clazz.getName());
        System.out.println("Simple Name: " + clazz.getSimpleName());
        System.out.println("Package: " + clazz.getPackage().getName());
        
        // Modifiers
        int modifiers = clazz.getModifiers();
        System.out.println("Modifiers: " + Modifier.toString(modifiers));
        
        // Type
        System.out.println("Is Interface: " + clazz.isInterface());
        System.out.println("Is Enum: " + clazz.isEnum());
        System.out.println("Is Array: " + clazz.isArray());
        
        // Hierarchy
        Class<?> superClass = clazz.getSuperclass();
        if (superClass != null) {
            System.out.println("Superclass: " + superClass.getName());
        }
        
        // Interfaces
        Class<?>[] interfaces = clazz.getInterfaces();
        if (interfaces.length > 0) {
            System.out.println("Interfaces:");
            for (Class<?> iface : interfaces) {
                System.out.println("  - " + iface.getName());
            }
        }
    }
    
    public static void main(String[] args) {
        inspect(ArrayList.class);
    }
}
```

### Example 2: Creating Instances

```java
public class InstanceCreator {
    
    public static <T> T createInstance(Class<T> clazz) {
        try {
            // Using default constructor
            return clazz.getDeclaredConstructor().newInstance();
        } catch (Exception e) {
            throw new RuntimeException("Failed to create instance", e);
        }
    }
    
    public static void main(String[] args) {
        // Create ArrayList instance
        List<String> list = createInstance(ArrayList.class);
        list.add("Hello");
        System.out.println(list);
        
        // Create HashMap instance
        Map<String, Integer> map = createInstance(HashMap.class);
        map.put("one", 1);
        System.out.println(map);
    }
}
```

### Example 3: Type Registry

```java
public class TypeRegistry {
    private Map<String, Class<?>> registry = new HashMap<>();
    
    public void register(String name, Class<?> clazz) {
        registry.put(name, clazz);
    }
    
    public Object createInstance(String name) {
        try {
            Class<?> clazz = registry.get(name);
            if (clazz == null) {
                throw new IllegalArgumentException("Type not registered: " + name);
            }
            return clazz.getDeclaredConstructor().newInstance();
        } catch (Exception e) {
            throw new RuntimeException("Failed to create instance", e);
        }
    }
    
    public boolean isInstanceOf(String name, Object obj) {
        Class<?> clazz = registry.get(name);
        return clazz != null && clazz.isInstance(obj);
    }
    
    public static void main(String[] args) {
        TypeRegistry registry = new TypeRegistry();
        
        // Register types
        registry.register("list", ArrayList.class);
        registry.register("map", HashMap.class);
        
        // Create instances
        Object list = registry.createInstance("list");
        System.out.println(list.getClass().getName());  // java.util.ArrayList
        
        // Type checking
        System.out.println(registry.isInstanceOf("list", list));  // true
    }
}
```

### Example 4: Plugin Loader

```java
// Plugin interface
interface Plugin {
    String getName();
    void execute();
}

// Plugins
class LoggingPlugin implements Plugin {
    public String getName() { return "Logger"; }
    public void execute() { System.out.println("Logging..."); }
}

class DatabasePlugin implements Plugin {
    public String getName() { return "Database"; }
    public void execute() { System.out.println("Database operation..."); }
}

// Plugin loader
public class PluginLoader {
    
    public static Plugin loadPlugin(String className) {
        try {
            Class<?> clazz = Class.forName(className);
            
            // Check if implements Plugin interface
            if (!Plugin.class.isAssignableFrom(clazz)) {
                throw new IllegalArgumentException("Not a plugin: " + className);
            }
            
            // Create instance
            return (Plugin) clazz.getDeclaredConstructor().newInstance();
            
        } catch (Exception e) {
            throw new RuntimeException("Failed to load plugin", e);
        }
    }
    
    public static void main(String[] args) {
        // Load plugins dynamically
        Plugin logger = loadPlugin("LoggingPlugin");
        System.out.println("Loaded: " + logger.getName());
        logger.execute();
        
        Plugin db = loadPlugin("DatabasePlugin");
        System.out.println("Loaded: " + db.getName());
        db.execute();
    }
}
```

---

## üìä Class Object Methods Summary

| Method | Description |
|--------|-------------|
| getName() | Fully qualified name |
| getSimpleName() | Simple class name |
| getPackage() | Package information |
| getModifiers() | Access modifiers |
| getSuperclass() | Parent class |
| getInterfaces() | Implemented interfaces |
| isInterface() | Check if interface |
| isEnum() | Check if enum |
| isArray() | Check if array |
| isPrimitive() | Check if primitive |
| isInstance(obj) | Like instanceof |
| isAssignableFrom(clazz) | Check inheritance |

---

## üìä Ways to Obtain Class Object

| Method | Use Case | Example |
|--------|----------|---------|
| .class | Known at compile time | String.class |
| getClass() | From object instance | obj.getClass() |
| Class.forName() | Dynamic loading | Class.forName("java.lang.String") |

---

## ‚ö° Best Practices

| Practice | Description |
|----------|-------------|
| ‚úÖ Use .class when type known | Faster, type-safe |
| ‚úÖ Cache Class objects | Avoid repeated lookups |
| ‚úÖ Handle ClassNotFoundException | For forName() |
| ‚úÖ Check isAssignableFrom() | Before casting |
| ‚úÖ Use generics with Class<T> | Type safety |
| ‚ùå Don't use forName() unnecessarily | Performance overhead |
| ‚ùå Don't ignore exceptions | Proper error handling |

---

## üéØ Common Patterns

### Pattern 1: Factory Method
```java
public static <T> T create(Class<T> clazz) throws Exception {
    return clazz.getDeclaredConstructor().newInstance();
}
```

### Pattern 2: Type Checking
```java
public static boolean isCollection(Object obj) {
    return Collection.class.isInstance(obj);
}
```

### Pattern 3: Dynamic Loading
```java
public static Class<?> loadClass(String name) {
    try {
        return Class.forName(name);
    } catch (ClassNotFoundException e) {
        return null;
    }
}
```

---

## üîó Related Topics

- [Inspecting Classes](02.%20Inspecting%20Classes.md)
- [Invoking Methods](03.%20Invoking%20Methods.md)
- [Accessing Fields](04.%20Accessing%20Fields.md)
- [Dynamic Proxies](05.%20Dynamic%20Proxies.md)

---

## üí° Key Takeaways

- Class object represents type metadata
- Three ways to obtain: .class, getClass(), forName()
- Use .class for known types (compile-time)
- Use getClass() for runtime type checking
- Use forName() for dynamic class loading
- isInstance() is dynamic instanceof
- isAssignableFrom() checks inheritance hierarchy
- Cache Class objects for performance
- Handle ClassNotFoundException with forName()
- Class objects are singletons per ClassLoader
