# ðŸ”Ž Inspecting Classes

## ðŸ“– Overview

**Class Inspection** allows examining the structure of classes at runtime - fields, methods, constructors, annotations, and more using the Reflection API.

**What You Can Inspect:**
- Fields (public, private, inherited)
- Methods (public, private, inherited)
- Constructors
- Annotations
- Modifiers

---

## ðŸ’» Inspecting Fields

### Getting Fields

```java
Class<?> clazz = String.class;

// Public fields (including inherited)
Field[] publicFields = clazz.getFields();

// All declared fields (not inherited)
Field[] declaredFields = clazz.getDeclaredFields();

// Specific field
Field field = clazz.getDeclaredField("value");
```

### Field Information

```java
public class Person {
    public String name;
    private int age;
    protected String email;
}

Class<?> clazz = Person.class;

for (Field field : clazz.getDeclaredFields()) {
    System.out.println("Name: " + field.getName());
    System.out.println("Type: " + field.getType());
    System.out.println("Modifiers: " + Modifier.toString(field.getModifiers()));
    System.out.println("---");
}
// Name: name, Type: class java.lang.String, Modifiers: public
// Name: age, Type: int, Modifiers: private
// Name: email, Type: class java.lang.String, Modifiers: protected
```

---

## ðŸ’» Inspecting Methods

### Getting Methods

```java
Class<?> clazz = String.class;

// Public methods (including inherited)
Method[] publicMethods = clazz.getMethods();

// All declared methods (not inherited)
Method[] declaredMethods = clazz.getDeclaredMethods();

// Specific method
Method method = clazz.getMethod("substring", int.class, int.class);
```

### Method Information

```java
public class Calculator {
    public int add(int a, int b) {
        return a + b;
    }
    
    private double multiply(double x, double y) {
        return x * y;
    }
}

Class<?> clazz = Calculator.class;

for (Method method : clazz.getDeclaredMethods()) {
    System.out.println("Name: " + method.getName());
    System.out.println("Return Type: " + method.getReturnType());
    System.out.println("Parameters: " + Arrays.toString(method.getParameterTypes()));
    System.out.println("Modifiers: " + Modifier.toString(method.getModifiers()));
    System.out.println("---");
}
```

---

## ðŸ’» Inspecting Constructors

### Getting Constructors

```java
Class<?> clazz = ArrayList.class;

// Public constructors
Constructor<?>[] publicConstructors = clazz.getConstructors();

// All declared constructors
Constructor<?>[] declaredConstructors = clazz.getDeclaredConstructors();

// Specific constructor
Constructor<?> constructor = clazz.getConstructor(int.class);
```

### Constructor Information

```java
public class User {
    public User() {}
    
    public User(String name) {}
    
    private User(String name, int age) {}
}

Class<?> clazz = User.class;

for (Constructor<?> constructor : clazz.getDeclaredConstructors()) {
    System.out.println("Constructor: " + constructor.getName());
    System.out.println("Parameters: " + Arrays.toString(constructor.getParameterTypes()));
    System.out.println("Modifiers: " + Modifier.toString(constructor.getModifiers()));
    System.out.println("---");
}
```

---

## ðŸ’» Inspecting Annotations

### Class Annotations

```java
@Entity
@Table("users")
public class User {
    @Column("id")
    private Long id;
    
    @NotNull
    @Column("name")
    private String name;
}

// Inspect class annotations
Class<?> clazz = User.class;
Annotation[] annotations = clazz.getAnnotations();

for (Annotation annotation : annotations) {
    System.out.println(annotation);
}

// Check specific annotation
if (clazz.isAnnotationPresent(Entity.class)) {
    Entity entity = clazz.getAnnotation(Entity.class);
    // Process annotation
}
```

### Field Annotations

```java
for (Field field : clazz.getDeclaredFields()) {
    System.out.println("Field: " + field.getName());
    
    Annotation[] annotations = field.getAnnotations();
    for (Annotation annotation : annotations) {
        System.out.println("  " + annotation);
    }
}
```

### Method Annotations

```java
for (Method method : clazz.getDeclaredMethods()) {
    if (method.isAnnotationPresent(Test.class)) {
        Test test = method.getAnnotation(Test.class);
        System.out.println("Test: " + test.description());
    }
}
```

---

## ðŸŽ¯ Complete Examples

### Example 1: Class Structure Printer

```java
public class ClassStructurePrinter {
    
    public static void printStructure(Class<?> clazz) {
        System.out.println("Class: " + clazz.getName());
        System.out.println();
        
        // Fields
        System.out.println("=== Fields ===");
        for (Field field : clazz.getDeclaredFields()) {
            String modifiers = Modifier.toString(field.getModifiers());
            String type = field.getType().getSimpleName();
            String name = field.getName();
            System.out.println(modifiers + " " + type + " " + name);
        }
        System.out.println();
        
        // Constructors
        System.out.println("=== Constructors ===");
        for (Constructor<?> constructor : clazz.getDeclaredConstructors()) {
            String modifiers = Modifier.toString(constructor.getModifiers());
            String params = Arrays.stream(constructor.getParameterTypes())
                .map(Class::getSimpleName)
                .collect(Collectors.joining(", "));
            System.out.println(modifiers + " " + clazz.getSimpleName() + "(" + params + ")");
        }
        System.out.println();
        
        // Methods
        System.out.println("=== Methods ===");
        for (Method method : clazz.getDeclaredMethods()) {
            String modifiers = Modifier.toString(method.getModifiers());
            String returnType = method.getReturnType().getSimpleName();
            String name = method.getName();
            String params = Arrays.stream(method.getParameterTypes())
                .map(Class::getSimpleName)
                .collect(Collectors.joining(", "));
            System.out.println(modifiers + " " + returnType + " " + name + "(" + params + ")");
        }
    }
    
    public static void main(String[] args) {
        printStructure(ArrayList.class);
    }
}
```

### Example 2: Finding Getters and Setters

```java
public class GetterSetterFinder {
    
    public static List<Method> findGetters(Class<?> clazz) {
        List<Method> getters = new ArrayList<>();
        
        for (Method method : clazz.getDeclaredMethods()) {
            String name = method.getName();
            
            // Getter pattern: getName(), isActive()
            if ((name.startsWith("get") || name.startsWith("is"))
                && method.getParameterCount() == 0
                && method.getReturnType() != void.class
                && Modifier.isPublic(method.getModifiers())) {
                getters.add(method);
            }
        }
        
        return getters;
    }
    
    public static List<Method> findSetters(Class<?> clazz) {
        List<Method> setters = new ArrayList<>();
        
        for (Method method : clazz.getDeclaredMethods()) {
            String name = method.getName();
            
            // Setter pattern: setName(String)
            if (name.startsWith("set")
                && method.getParameterCount() == 1
                && method.getReturnType() == void.class
                && Modifier.isPublic(method.getModifiers())) {
                setters.add(method);
            }
        }
        
        return setters;
    }
    
    public static void main(String[] args) {
        List<Method> getters = findGetters(Person.class);
        System.out.println("Getters: " + getters.size());
        
        List<Method> setters = findSetters(Person.class);
        System.out.println("Setters: " + setters.size());
    }
}
```

### Example 3: Annotation Scanner

```java
public class AnnotationScanner {
    
    public static List<Field> findAnnotatedFields(Class<?> clazz, 
                                                   Class<? extends Annotation> annotationClass) {
        List<Field> fields = new ArrayList<>();
        
        for (Field field : clazz.getDeclaredFields()) {
            if (field.isAnnotationPresent(annotationClass)) {
                fields.add(field);
            }
        }
        
        return fields;
    }
    
    public static List<Method> findAnnotatedMethods(Class<?> clazz,
                                                     Class<? extends Annotation> annotationClass) {
        List<Method> methods = new ArrayList<>();
        
        for (Method method : clazz.getDeclaredMethods()) {
            if (method.isAnnotationPresent(annotationClass)) {
                methods.add(method);
            }
        }
        
        return methods;
    }
    
    public static void main(String[] args) {
        // Find @Column fields
        List<Field> columnFields = findAnnotatedFields(User.class, Column.class);
        System.out.println("Fields with @Column: " + columnFields.size());
        
        // Find @Test methods
        List<Method> testMethods = findAnnotatedMethods(TestClass.class, Test.class);
        System.out.println("Methods with @Test: " + testMethods.size());
    }
}
```

### Example 4: Bean Inspector

```java
public class BeanInspector {
    
    public static void inspect(Object bean) {
        Class<?> clazz = bean.getClass();
        
        System.out.println("Bean: " + clazz.getSimpleName());
        System.out.println();
        
        // Find all properties (fields with getters/setters)
        for (Field field : clazz.getDeclaredFields()) {
            String fieldName = field.getName();
            String capitalizedName = Character.toUpperCase(fieldName.charAt(0)) 
                                   + fieldName.substring(1);
            
            try {
                // Find getter
                Method getter = null;
                try {
                    getter = clazz.getMethod("get" + capitalizedName);
                } catch (NoSuchMethodException e) {
                    try {
                        getter = clazz.getMethod("is" + capitalizedName);
                    } catch (NoSuchMethodException ex) {
                        // No getter
                    }
                }
                
                // Find setter
                Method setter = null;
                try {
                    setter = clazz.getMethod("set" + capitalizedName, field.getType());
                } catch (NoSuchMethodException e) {
                    // No setter
                }
                
                // Print property info
                System.out.println("Property: " + fieldName);
                System.out.println("  Type: " + field.getType().getSimpleName());
                System.out.println("  Getter: " + (getter != null ? "Yes" : "No"));
                System.out.println("  Setter: " + (setter != null ? "Yes" : "No"));
                
                if (getter != null) {
                    Object value = getter.invoke(bean);
                    System.out.println("  Value: " + value);
                }
                System.out.println();
                
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
    }
    
    public static void main(String[] args) {
        Person person = new Person("Alice", 30);
        inspect(person);
    }
}
```

---

## ðŸ“Š Reflection Methods Comparison

| Method | Scope | Inherited |
|--------|-------|-----------|
| getFields() | Public only | âœ… Yes |
| getDeclaredFields() | All (public, private, protected) | âŒ No |
| getMethods() | Public only | âœ… Yes |
| getDeclaredMethods() | All (public, private, protected) | âŒ No |
| getConstructors() | Public only | N/A |
| getDeclaredConstructors() | All | N/A |

---

## ðŸ“Š Field/Method/Constructor Properties

| Property | Description |
|----------|-------------|
| getName() | Member name |
| getType() | Field type / Return type |
| getModifiers() | Access modifiers (int) |
| getParameterTypes() | Method/Constructor parameters |
| getAnnotations() | All annotations |
| isAnnotationPresent() | Check specific annotation |

---

## âš¡ Best Practices

| Practice | Description |
|----------|-------------|
| âœ… Use getDeclared* for all members | Including private |
| âœ… Cache reflection results | Performance |
| âœ… Check modifiers before accessing | Public/private/protected |
| âœ… Handle NoSuchFieldException | When field doesn't exist |
| âœ… Use streams for filtering | Cleaner code |
| âŒ Don't inspect in tight loops | Performance overhead |
| âŒ Don't ignore access modifiers | Security concerns |

---

## ðŸŽ¯ Common Patterns

### Pattern 1: Find All Public Methods
```java
Method[] methods = Arrays.stream(clazz.getDeclaredMethods())
    .filter(m -> Modifier.isPublic(m.getModifiers()))
    .toArray(Method[]::new);
```

### Pattern 2: Find Fields by Type
```java
Field[] stringFields = Arrays.stream(clazz.getDeclaredFields())
    .filter(f -> f.getType() == String.class)
    .toArray(Field[]::new);
```

### Pattern 3: Find Annotated Methods
```java
List<Method> testMethods = Arrays.stream(clazz.getDeclaredMethods())
    .filter(m -> m.isAnnotationPresent(Test.class))
    .collect(Collectors.toList());
```

---

## ðŸ”— Related Topics

- [Class Object](01.%20Class%20Object.md)
- [Invoking Methods](03.%20Invoking%20Methods.md)
- [Accessing Fields](04.%20Accessing%20Fields.md)
- [Dynamic Proxies](05.%20Dynamic%20Proxies.md)

---

## ðŸ’¡ Key Takeaways

- Use getDeclaredFields/Methods for all members including private
- Use getFields/Methods for public members including inherited
- Field.getType() returns field type
- Method.getReturnType() returns return type
- Method.getParameterTypes() returns parameter types
- Modifier.toString() converts int to readable string
- isAnnotationPresent() checks for specific annotation
- Cache reflection results for performance
- Handle NoSuchFieldException and NoSuchMethodException
- Use streams for filtering and transforming reflection results
