# ‚úçÔ∏è Writing Files

## üìñ Overview

Java provides multiple ways to write files, from simple one-liners to buffered streams for better performance.

---

## üíª Method 1: Files.writeString() - Java 11+

```java
import java.nio.file.*;
import java.io.IOException;

try {
    // Simple write
    Files.writeString(Paths.get("output.txt"), "Hello, World!");
    
    // With charset
    Files.writeString(
        Paths.get("output.txt"),
        "Hello, World!",
        StandardCharsets.UTF_8
    );
    
    // Append mode
    Files.writeString(
        Paths.get("output.txt"),
        "\nNew line",
        StandardOpenOption.APPEND
    );
    
} catch (IOException e) {
    e.printStackTrace();
}
```

---

## üíª Method 2: Files.write() - Write Lines or Bytes

```java
// Write list of lines
List<String> lines = Arrays.asList("Line 1", "Line 2", "Line 3");

try {
    Files.write(Paths.get("output.txt"), lines);
    
    // With charset and options
    Files.write(
        Paths.get("output.txt"),
        lines,
        StandardCharsets.UTF_8,
        StandardOpenOption.CREATE,
        StandardOpenOption.APPEND
    );
    
} catch (IOException e) {
    e.printStackTrace();
}

// Write byte array
try {
    byte[] bytes = "Hello".getBytes();
    Files.write(Paths.get("output.bin"), bytes);
} catch (IOException e) {
    e.printStackTrace();
}
```

---

## üíª Method 3: BufferedWriter - Efficient Writing

```java
try (BufferedWriter writer = new BufferedWriter(new FileWriter("output.txt"))) {
    
    writer.write("Line 1");
    writer.newLine();
    writer.write("Line 2");
    writer.newLine();
    
} catch (IOException e) {
    e.printStackTrace();
}

// With charset
try (BufferedWriter writer = new BufferedWriter(
        new OutputStreamWriter(
            new FileOutputStream("output.txt"),
            StandardCharsets.UTF_8))) {
    
    writer.write("Hello, UTF-8!");
    
} catch (IOException e) {
    e.printStackTrace();
}

// Append mode
try (BufferedWriter writer = new BufferedWriter(
        new FileWriter("output.txt", true))) {  // true = append
    
    writer.write("Appended line");
    writer.newLine();
}
```

---

## üíª Method 4: FileWriter - Simple Writing

```java
try (FileWriter writer = new FileWriter("output.txt")) {
    
    writer.write("Hello, World!");
    
} catch (IOException e) {
    e.printStackTrace();
}

// Append mode
try (FileWriter writer = new FileWriter("output.txt", true)) {
    writer.write("\nAppended text");
}
```

**Note:** FileWriter uses default charset - prefer BufferedWriter with OutputStreamWriter

---

## üíª Method 5: PrintWriter - Formatted Output

```java
try (PrintWriter writer = new PrintWriter("output.txt")) {
    
    writer.println("Line 1");
    writer.println("Line 2");
    writer.printf("Number: %d%n", 42);
    writer.printf("Pi: %.2f%n", Math.PI);
    
} catch (FileNotFoundException e) {
    e.printStackTrace();
}

// With auto-flush
try (PrintWriter writer = new PrintWriter(
        new BufferedWriter(new FileWriter("output.txt")), true)) {
    
    writer.println("Auto-flushed");
}
```

---

## üíª Method 6: FileOutputStream - Byte Stream

```java
try (FileOutputStream fos = new FileOutputStream("output.bin")) {
    
    fos.write("Hello".getBytes());
    
} catch (IOException e) {
    e.printStackTrace();
}

// Write byte array
try (FileOutputStream fos = new FileOutputStream("output.bin")) {
    byte[] data = {72, 101, 108, 108, 111};  // "Hello"
    fos.write(data);
    
    // Write subset
    fos.write(data, 0, 3);  // Write first 3 bytes
}

// Append mode
try (FileOutputStream fos = new FileOutputStream("output.bin", true)) {
    fos.write(" World".getBytes());
}
```

---

## üíª Method 7: RandomAccessFile - Random Access

```java
try (RandomAccessFile raf = new RandomAccessFile("output.txt", "rw")) {
    
    // Write at current position
    raf.writeBytes("Hello, World!");
    
    // Write at specific position
    raf.seek(0);  // Beginning
    raf.writeBytes("HELLO");
    
    // Write at end
    raf.seek(raf.length());
    raf.writeBytes(" Appended");
    
} catch (IOException e) {
    e.printStackTrace();
}
```

---

## üíª Method 8: Channel & Buffer - NIO

```java
import java.nio.channels.*;
import java.nio.*;

try (FileChannel channel = FileChannel.open(
        Paths.get("output.txt"),
        StandardOpenOption.WRITE,
        StandardOpenOption.CREATE)) {
    
    ByteBuffer buffer = ByteBuffer.wrap("Hello, NIO!".getBytes());
    channel.write(buffer);
    
} catch (IOException e) {
    e.printStackTrace();
}
```

---

## üéØ Complete Examples

### Example 1: Write Collection to File

```java
public class CollectionWriter {
    public static void writeCollection(List<String> data, String filename) {
        try (BufferedWriter writer = new BufferedWriter(
                new FileWriter(filename))) {
            
            for (String line : data) {
                writer.write(line);
                writer.newLine();
            }
            
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
    
    public static void main(String[] args) {
        List<String> names = Arrays.asList("Alice", "Bob", "Charlie");
        writeCollection(names, "names.txt");
    }
}
```

### Example 2: Write CSV File

```java
public class CSVWriter {
    public static void writeCSV(List<String[]> data, String filename) {
        try (PrintWriter writer = new PrintWriter(filename)) {
            
            for (String[] row : data) {
                String line = String.join(",", row);
                writer.println(line);
            }
            
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        }
    }
    
    public static void main(String[] args) {
        List<String[]> data = Arrays.asList(
            new String[]{"Name", "Age", "City"},
            new String[]{"Alice", "25", "NYC"},
            new String[]{"Bob", "30", "LA"}
        );
        writeCSV(data, "people.csv");
    }
}
```

### Example 3: Write Properties File

```java
public class PropertiesWriter {
    public static void writeProperties(String filename) {
        Properties props = new Properties();
        props.setProperty("db.host", "localhost");
        props.setProperty("db.port", "5432");
        props.setProperty("db.name", "mydb");
        
        try (FileOutputStream fos = new FileOutputStream(filename)) {
            props.store(fos, "Database Configuration");
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
```

### Example 4: Write JSON (using StringBuilder)

```java
public class JSONWriter {
    public static void writeJSON(Map<String, Object> data, String filename) {
        StringBuilder json = new StringBuilder("{\n");
        
        data.forEach((key, value) -> {
            json.append("  \"").append(key).append("\": ");
            if (value instanceof String) {
                json.append("\"").append(value).append("\"");
            } else {
                json.append(value);
            }
            json.append(",\n");
        });
        
        // Remove last comma
        if (json.length() > 2) {
            json.setLength(json.length() - 2);
            json.append("\n");
        }
        json.append("}");
        
        try {
            Files.writeString(Paths.get(filename), json.toString());
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
```

### Example 5: Atomic Write (Temp + Rename)

```java
public class AtomicWriter {
    public static void atomicWrite(String content, String filename) {
        Path target = Paths.get(filename);
        Path temp = Paths.get(filename + ".tmp");
        
        try {
            // Write to temp file
            Files.writeString(temp, content);
            
            // Atomic move
            Files.move(temp, target, StandardCopyOption.ATOMIC_MOVE,
                                    StandardCopyOption.REPLACE_EXISTING);
                                    
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
```

---

## üìä StandardOpenOption

| Option | Description |
|--------|-------------|
| CREATE | Create if doesn't exist |
| CREATE_NEW | Create, fail if exists |
| APPEND | Append to end |
| TRUNCATE_EXISTING | Clear existing content |
| WRITE | Open for writing |
| READ | Open for reading |
| DELETE_ON_CLOSE | Delete when closed |
| SYNC | Synchronous writes |

```java
Files.write(
    Paths.get("file.txt"),
    content.getBytes(),
    StandardOpenOption.CREATE,
    StandardOpenOption.TRUNCATE_EXISTING
);
```

---

## üìä Writing Methods Comparison

| Method | Use Case | Performance | Ease |
|--------|----------|-------------|------|
| Files.writeString() | Small text | Fast | Easy |
| Files.write() | Lists or bytes | Fast | Easy |
| BufferedWriter | Large files | Fast | Medium |
| PrintWriter | Formatted output | Medium | Easy |
| FileWriter | Simple text | Medium | Easy |
| FileOutputStream | Binary data | Fast | Medium |
| RandomAccessFile | Random access | Fast | Hard |
| Channel/Buffer | High performance | Very Fast | Hard |

---

## ‚ö° Best Practices

| Practice | Description |
|----------|-------------|
| ‚úÖ Use try-with-resources | Auto-close and flush |
| ‚úÖ BufferedWriter for large files | Better performance |
| ‚úÖ Specify charset explicitly | UTF-8 recommended |
| ‚úÖ Use Files.write() for simple cases | Clean and modern |
| ‚úÖ Flush when needed | Especially with buffers |
| ‚úÖ Atomic writes for critical files | Temp + rename |
| ‚ùå Don't forget to close streams | Resource leaks |
| ‚ùå Don't use FileWriter without charset | Platform-dependent |
| ‚ùå Don't mix byte and character streams | Data corruption |

---

## üéØ Performance Tips

```java
// SLOW - multiple small writes
try (FileWriter writer = new FileWriter("output.txt")) {
    for (int i = 0; i < 10000; i++) {
        writer.write("Line " + i + "\n");
    }
}

// FAST - buffered writes
try (BufferedWriter writer = new BufferedWriter(new FileWriter("output.txt"))) {
    for (int i = 0; i < 10000; i++) {
        writer.write("Line " + i);
        writer.newLine();
    }
}

// FASTEST - batch write
List<String> lines = new ArrayList<>();
for (int i = 0; i < 10000; i++) {
    lines.add("Line " + i);
}
Files.write(Paths.get("output.txt"), lines);
```

---

## üîó Related Topics

- [Reading Files](02.%20Reading%20Files.md)
- [BufferedReader & BufferedWriter](04.%20BufferedReader%20%26%20BufferedWriter.md)
- [NIO Files Class](05.%20NIO%20Files%20Class.md)

---

## üí° Key Takeaways

- Files.writeString() - simplest for small text
- Files.write() - modern, handles lines or bytes
- BufferedWriter - best for large files
- PrintWriter - convenient for formatted output
- Always use try-with-resources
- Specify charset explicitly (UTF-8)
- Use atomic writes for critical data
- BufferedWriter provides best performance for loops
- StandardOpenOption controls write behavior
