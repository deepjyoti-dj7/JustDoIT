# üëª Anonymous Classes

## üìñ Overview

**Anonymous Class** is an inner class without a name that is declared and instantiated at the same time. It's used to make code more concise when you need to override methods of a class or implement an interface on-the-fly.

**Key Points:**
- No name (anonymous)
- Declared and instantiated in single expression
- Can extend one class OR implement one interface
- Cannot have constructors (no name!)
- Used for one-time use implementations
- Commonly used for event handlers

---

## üéØ Syntax

```java
// Extending class
ClassName obj = new ClassName() {
    // Override methods
};

// Implementing interface
InterfaceName obj = new InterfaceName() {
    // Implement methods
};
```

---

## üíª Example 1: Basic Anonymous Class

```java
abstract class Animal {
    abstract void makeSound();
    
    void sleep() {
        System.out.println("Animal is sleeping");
    }
}

public class BasicAnonymousDemo {
    public static void main(String[] args) {
        // Anonymous class extending Animal
        Animal dog = new Animal() {
            @Override
            void makeSound() {
                System.out.println("Dog barks: Woof!");
            }
        };
        
        dog.makeSound();
        dog.sleep();
        
        System.out.println();
        
        // Another anonymous class
        Animal cat = new Animal() {
            @Override
            void makeSound() {
                System.out.println("Cat meows: Meow!");
            }
            
            // Can add new methods (but cannot call them via reference)
            void scratch() {
                System.out.println("Cat scratches");
            }
        };
        
        cat.makeSound();
        cat.sleep();
        // cat.scratch();  // ERROR: method not in Animal
    }
}
```

**Output:**
```
Dog barks: Woof!
Animal is sleeping

Cat meows: Meow!
Animal is sleeping
```

---

## üíª Example 2: Anonymous Class with Interface

```java
interface Greeting {
    void greet(String name);
}

public class InterfaceAnonymousDemo {
    public static void main(String[] args) {
        // Anonymous class implementing interface
        Greeting english = new Greeting() {
            @Override
            public void greet(String name) {
                System.out.println("Hello, " + name + "!");
            }
        };
        
        Greeting spanish = new Greeting() {
            @Override
            public void greet(String name) {
                System.out.println("Hola, " + name + "!");
            }
        };
        
        Greeting french = new Greeting() {
            @Override
            public void greet(String name) {
                System.out.println("Bonjour, " + name + "!");
            }
        };
        
        english.greet("Alice");
        spanish.greet("Bob");
        french.greet("Charlie");
    }
}
```

---

## üíª Example 3: Thread Creation

```java
public class ThreadAnonymousDemo {
    public static void main(String[] args) {
        System.out.println("Main thread: " + Thread.currentThread().getName());
        
        // Anonymous class extending Thread
        Thread thread1 = new Thread() {
            @Override
            public void run() {
                for (int i = 1; i <= 5; i++) {
                    System.out.println("Thread 1: " + i);
                    try {
                        Thread.sleep(500);
                    } catch (InterruptedException e) {
                        e.printStackTrace();
                    }
                }
            }
        };
        
        // Anonymous class implementing Runnable
        Runnable task = new Runnable() {
            @Override
            public void run() {
                for (int i = 1; i <= 5; i++) {
                    System.out.println("Thread 2: " + i);
                    try {
                        Thread.sleep(500);
                    } catch (InterruptedException e) {
                        e.printStackTrace();
                    }
                }
            }
        };
        
        Thread thread2 = new Thread(task);
        
        thread1.start();
        thread2.start();
    }
}
```

---

## üíª Example 4: Button Click Handler

```java
interface ClickListener {
    void onClick();
}

class Button {
    private String label;
    private ClickListener listener;
    
    Button(String label) {
        this.label = label;
    }
    
    void setClickListener(ClickListener listener) {
        this.listener = listener;
    }
    
    void click() {
        System.out.println("Button '" + label + "' clicked");
        if (listener != null) {
            listener.onClick();
        }
    }
}

public class ClickHandlerDemo {
    public static void main(String[] args) {
        Button submitButton = new Button("Submit");
        Button cancelButton = new Button("Cancel");
        Button deleteButton = new Button("Delete");
        
        // Anonymous class for submit button
        submitButton.setClickListener(new ClickListener() {
            @Override
            public void onClick() {
                System.out.println("  -> Form submitted successfully!");
                System.out.println("  -> Saving data...");
            }
        });
        
        // Anonymous class for cancel button
        cancelButton.setClickListener(new ClickListener() {
            @Override
            public void onClick() {
                System.out.println("  -> Action cancelled!");
            }
        });
        
        // Anonymous class for delete button
        deleteButton.setClickListener(new ClickListener() {
            @Override
            public void onClick() {
                System.out.println("  -> Are you sure?");
                System.out.println("  -> Deleting item...");
            }
        });
        
        submitButton.click();
        System.out.println();
        cancelButton.click();
        System.out.println();
        deleteButton.click();
    }
}
```

---

## üíª Example 5: Comparator with Anonymous Class

```java
import java.util.*;

class Student {
    String name;
    int age;
    double gpa;
    
    Student(String name, int age, double gpa) {
        this.name = name;
        this.age = age;
        this.gpa = gpa;
    }
    
    @Override
    public String toString() {
        return String.format("%s (age=%d, gpa=%.2f)", name, age, gpa);
    }
}

public class ComparatorDemo {
    public static void main(String[] args) {
        List<Student> students = new ArrayList<>();
        students.add(new Student("Alice", 20, 3.8));
        students.add(new Student("Bob", 22, 3.5));
        students.add(new Student("Charlie", 21, 3.9));
        students.add(new Student("David", 19, 3.7));
        
        System.out.println("Original list:");
        students.forEach(System.out::println);
        
        // Sort by name using anonymous Comparator
        Collections.sort(students, new Comparator<Student>() {
            @Override
            public int compare(Student s1, Student s2) {
                return s1.name.compareTo(s2.name);
            }
        });
        
        System.out.println("\nSorted by name:");
        students.forEach(System.out::println);
        
        // Sort by age using anonymous Comparator
        Collections.sort(students, new Comparator<Student>() {
            @Override
            public int compare(Student s1, Student s2) {
                return Integer.compare(s1.age, s2.age);
            }
        });
        
        System.out.println("\nSorted by age:");
        students.forEach(System.out::println);
        
        // Sort by GPA (descending) using anonymous Comparator
        Collections.sort(students, new Comparator<Student>() {
            @Override
            public int compare(Student s1, Student s2) {
                return Double.compare(s2.gpa, s1.gpa);
            }
        });
        
        System.out.println("\nSorted by GPA (descending):");
        students.forEach(System.out::println);
    }
}
```

---

## üíª Example 6: Accessing Local Variables

```java
public class LocalVariableDemo {
    void demonstrateAccess() {
        final String prefix = "Message: ";  // Effectively final
        int count = 5;  // Effectively final (not modified)
        
        // Anonymous class accessing local variables
        Runnable task = new Runnable() {
            @Override
            public void run() {
                // Can access effectively final local variables
                System.out.println(prefix + "Task running");
                System.out.println("Count: " + count);
                
                // Cannot modify local variables
                // count++;  // ERROR!
            }
        };
        
        task.run();
    }
    
    public static void main(String[] args) {
        LocalVariableDemo demo = new LocalVariableDemo();
        demo.demonstrateAccess();
    }
}
```

---

## üíª Example 7: Callback Pattern

```java
interface Callback {
    void onSuccess(String result);
    void onError(String error);
}

class DataFetcher {
    void fetchData(String url, Callback callback) {
        System.out.println("Fetching data from: " + url);
        
        // Simulate network operation
        try {
            Thread.sleep(1000);
            
            // Simulate success/failure
            if (url.contains("valid")) {
                callback.onSuccess("Data received successfully!");
            } else {
                callback.onError("Invalid URL!");
            }
        } catch (InterruptedException e) {
            callback.onError("Operation interrupted!");
        }
    }
}

public class CallbackDemo {
    public static void main(String[] args) {
        DataFetcher fetcher = new DataFetcher();
        
        System.out.println("=== Valid URL ===");
        fetcher.fetchData("https://api.valid.com/data", new Callback() {
            @Override
            public void onSuccess(String result) {
                System.out.println("‚úì Success: " + result);
            }
            
            @Override
            public void onError(String error) {
                System.out.println("‚úó Error: " + error);
            }
        });
        
        System.out.println("\n=== Invalid URL ===");
        fetcher.fetchData("https://api.invalid.com/data", new Callback() {
            @Override
            public void onSuccess(String result) {
                System.out.println("‚úì Success: " + result);
            }
            
            @Override
            public void onError(String error) {
                System.out.println("‚úó Error: " + error);
            }
        });
    }
}
```

---

## üíª Example 8: Filter Pattern

```java
interface Filter<T> {
    boolean test(T item);
}

class FilterEngine {
    static <T> void filter(T[] items, Filter<T> filter) {
        System.out.print("Filtered items: ");
        for (T item : items) {
            if (filter.test(item)) {
                System.out.print(item + " ");
            }
        }
        System.out.println();
    }
}

public class FilterDemo {
    public static void main(String[] args) {
        Integer[] numbers = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10};
        String[] words = {"apple", "banana", "apricot", "cherry", "avocado"};
        
        // Filter even numbers
        System.out.println("Even numbers:");
        FilterEngine.filter(numbers, new Filter<Integer>() {
            @Override
            public boolean test(Integer num) {
                return num % 2 == 0;
            }
        });
        
        // Filter numbers greater than 5
        System.out.println("Numbers > 5:");
        FilterEngine.filter(numbers, new Filter<Integer>() {
            @Override
            public boolean test(Integer num) {
                return num > 5;
            }
        });
        
        // Filter words starting with 'a'
        System.out.println("Words starting with 'a':");
        FilterEngine.filter(words, new Filter<String>() {
            @Override
            public boolean test(String word) {
                return word.startsWith("a");
            }
        });
        
        // Filter words longer than 6 characters
        System.out.println("Words with length > 6:");
        FilterEngine.filter(words, new Filter<String>() {
            @Override
            public boolean test(String word) {
                return word.length() > 6;
            }
        });
    }
}
```

---

## üíª Example 9: Abstract Class Override

```java
abstract class Shape {
    abstract double calculateArea();
    abstract double calculatePerimeter();
    
    void displayInfo(String name) {
        System.out.println("Shape: " + name);
        System.out.println("Area: " + calculateArea());
        System.out.println("Perimeter: " + calculatePerimeter());
    }
}

public class ShapeDemo {
    public static void main(String[] args) {
        // Anonymous class for circle
        Shape circle = new Shape() {
            double radius = 5;
            
            @Override
            double calculateArea() {
                return 3.14 * radius * radius;
            }
            
            @Override
            double calculatePerimeter() {
                return 2 * 3.14 * radius;
            }
        };
        
        circle.displayInfo("Circle");
        System.out.println();
        
        // Anonymous class for rectangle
        Shape rectangle = new Shape() {
            double length = 10;
            double width = 5;
            
            @Override
            double calculateArea() {
                return length * width;
            }
            
            @Override
            double calculatePerimeter() {
                return 2 * (length + width);
            }
        };
        
        rectangle.displayInfo("Rectangle");
    }
}
```

---

## üíª Example 10: Timer Task

```java
import java.util.Timer;
import java.util.TimerTask;

public class TimerDemo {
    public static void main(String[] args) {
        Timer timer = new Timer();
        
        System.out.println("Timer started...");
        
        // Anonymous TimerTask 1 - runs once after 2 seconds
        timer.schedule(new TimerTask() {
            @Override
            public void run() {
                System.out.println("Task 1: Executed after 2 seconds");
            }
        }, 2000);
        
        // Anonymous TimerTask 2 - runs every 1 second, 5 times
        timer.schedule(new TimerTask() {
            int count = 0;
            
            @Override
            public void run() {
                count++;
                System.out.println("Task 2: Periodic execution #" + count);
                
                if (count >= 5) {
                    this.cancel();
                    timer.cancel();
                    System.out.println("Timer cancelled");
                }
            }
        }, 3000, 1000);  // Start after 3 seconds, repeat every 1 second
    }
}
```

---

## üìä Anonymous Class vs Other Approaches

| Feature | Anonymous Class | Lambda (Java 8+) | Named Class |
|---------|----------------|------------------|-------------|
| **Syntax** | Verbose | Concise | Most verbose |
| **Reusability** | One-time use | One-time use | Reusable |
| **Debugging** | Harder | Harder | Easier |
| **Can extend class** | ‚úÖ Yes | ‚ùå No | ‚úÖ Yes |
| **Can implement interface** | ‚úÖ Yes (one only) | ‚úÖ Yes (functional) | ‚úÖ Yes (multiple) |
| **Can have state** | ‚úÖ Yes | ‚ùå No | ‚úÖ Yes |

---

## üìä Anonymous Class Characteristics

```
‚úÖ No name (anonymous)
‚úÖ Can extend one class OR implement one interface
‚úÖ Can access outer class members
‚úÖ Can access effectively final local variables
‚úÖ Cannot have constructors (use instance initializer)
‚úÖ Cannot have static members (except static final constants)
‚úÖ Created and instantiated in single expression
‚úÖ Used for one-time implementations
```

---

## üí° Best Practices

1. ‚úÖ **Use for short, one-time implementations**
   ```java
   button.setListener(new ClickListener() {
       public void onClick() { }
   });
   ```

2. ‚úÖ **Consider lambda for functional interfaces (Java 8+)**
   ```java
   button.setListener(() -> { });  // Better
   ```

3. ‚úÖ **Keep anonymous classes small**
   ```java
   // If code > 10 lines, consider named class
   ```

4. ‚úÖ **Use for event handlers**
   ```java
   addActionListener(new ActionListener() {
       public void actionPerformed(ActionEvent e) { }
   });
   ```

5. ‚úÖ **Access effectively final variables only**
   ```java
   final String msg = "Hello";
   new Runnable() {
       public void run() {
           System.out.println(msg);
       }
   };
   ```

---

## ‚ö†Ô∏è Common Pitfalls

```java
public class AnonymousPitfalls {
    void demonstrate() {
        // 1. Cannot have constructors
        Animal animal = new Animal() {
            // Animal() { }  // ERROR! No constructors allowed
            
            // Use instance initializer instead
            {
                System.out.println("Instance initializer");
            }
        };
        
        // 2. Cannot access non-effectively-final variables
        int x = 10;
        x = 20;  // Now x is not effectively final
        Runnable task = new Runnable() {
            public void run() {
                // System.out.println(x);  // ERROR!
            }
        };
        
        // 3. Cannot have static members (except constants)
        Runnable r = new Runnable() {
            // static int count = 0;  // ERROR!
            static final int MAX = 100;  // OK - constant
            
            public void run() { }
        };
        
        // 4. New methods not accessible
        Animal dog = new Animal() {
            void makeSound() { }
            void newMethod() { }  // Cannot call this!
        };
        // dog.newMethod();  // ERROR!
        
        // 5. Can only extend one class OR implement one interface
        // Not both!
    }
}
```

---

## üéØ Interview Questions

1. **What is an anonymous class?**
2. **When to use anonymous classes?**
3. **Can anonymous class have constructor?**
4. **Can anonymous class extend and implement simultaneously?**
5. **Can anonymous class have static members?**
6. **Difference between anonymous class and lambda?**
7. **Can anonymous class access local variables?**
8. **What is effectively final?**
9. **Can we create multiple instances of anonymous class?**
10. **Performance implications of anonymous classes?**
11. **Can anonymous class have instance initializer?**
12. **Real-world use cases of anonymous classes?**
13. **Limitations of anonymous classes?**
14. **How to debug anonymous classes?**
15. **Anonymous class vs inner class?**

---

## üìö Related Topics

- [Inner Classes](03.%20Inner%20Classes.md)
- [Lambda Expressions](../06.%20Lambda%20%26%20Functional%20Programming/01.%20Lambda%20Expressions.md)
- [Functional Interfaces](../06.%20Lambda%20%26%20Functional%20Programming/02.%20Functional%20Interfaces.md)
- [Interfaces](../02.%20Object-Oriented%20Programming/08.%20Interfaces.md)
- [Abstract Classes](../02.%20Object-Oriented%20Programming/07.%20Abstraction.md)
