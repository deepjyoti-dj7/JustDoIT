# Filtering & Searching

## filter()

### Basic Filtering
```javascript
const numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];

const evens = numbers.filter(n => n % 2 === 0);
console.log(evens);  // [2, 4, 6, 8, 10]

const greaterThan5 = numbers.filter(n => n > 5);
console.log(greaterThan5);  // [6, 7, 8, 9, 10]
```

### Object Filtering
```javascript
const users = [
  {name: 'John', age: 25, active: true},
  {name: 'Jane', age: 30, active: false},
  {name: 'Bob', age: 35, active: true}
];

const activeUsers = users.filter(u => u.active);
const adults = users.filter(u => u.age >= 18);
const youngActive = users.filter(u => u.age < 30 && u.active);
```

### Multiple Conditions
```javascript
const products = [
  {name: 'Laptop', price: 1000, inStock: true},
  {name: 'Mouse', price: 25, inStock: false},
  {name: 'Keyboard', price: 75, inStock: true}
];

const available = products.filter(p => 
  p.inStock && p.price < 500
);

console.log(available);  // [{name: 'Keyboard', ...}]
```

### Removing Falsy Values
```javascript
const arr = [0, 1, false, 2, '', 3, null, undefined, NaN, 4];

const truthy = arr.filter(Boolean);
console.log(truthy);  // [1, 2, 3, 4]

// Remove specific values
const noNulls = arr.filter(x => x !== null && x !== undefined);
```

### Using Index
```javascript
const arr = [1, 2, 3, 4, 5];

// Get elements at even indices
const evenIndices = arr.filter((_, index) => index % 2 === 0);
console.log(evenIndices);  // [1, 3, 5]

// Remove duplicates
const withDupes = [1, 2, 2, 3, 3, 3, 4];
const unique = withDupes.filter((val, index, arr) => 
  arr.indexOf(val) === index
);
console.log(unique);  // [1, 2, 3, 4]
```

## find()

### Find First Match
```javascript
const numbers = [1, 2, 3, 4, 5];

const firstEven = numbers.find(n => n % 2 === 0);
console.log(firstEven);  // 2 (stops at first match)

const notFound = numbers.find(n => n > 10);
console.log(notFound);  // undefined
```

### Find Object
```javascript
const users = [
  {id: 1, name: 'John'},
  {id: 2, name: 'Jane'},
  {id: 3, name: 'Bob'}
];

const user = users.find(u => u.id === 2);
console.log(user);  // {id: 2, name: 'Jane'}

const byName = users.find(u => u.name === 'Bob');
console.log(byName);  // {id: 3, name: 'Bob'}
```

### With Default Value
```javascript
const users = [{id: 1, name: 'John'}];

const user = users.find(u => u.id === 999) ?? {id: 0, name: 'Guest'};
console.log(user);  // {id: 0, name: 'Guest'}
```

## findLast() & findLastIndex() (ES2023)

### findLast() - Find from End
```javascript
const numbers = [1, 2, 3, 4, 5, 4, 3, 2, 1];

const lastEven = numbers.findLast(n => n % 2 === 0);
console.log(lastEven);  // 2 (last even number)

const last = numbers.findLast(n => n === 3);
console.log(last);  // 3 (last occurrence)
```

### findLastIndex() - Last Index
```javascript
const arr = ['a', 'b', 'c', 'b', 'a'];

const lastBIndex = arr.findLastIndex(x => x === 'b');
console.log(lastBIndex);  // 3

const notFound = arr.findLastIndex(x => x === 'z');
console.log(notFound);  // -1
```

### Use Case: Latest Entry
```javascript
const logs = [
  {user: 'John', action: 'login', time: 1000},
  {user: 'Jane', action: 'view', time: 2000},
  {user: 'John', action: 'edit', time: 3000}
];

const lastJohnAction = logs.findLast(log => log.user === 'John');
console.log(lastJohnAction);  // {user: 'John', action: 'edit', ...}
```

## findIndex()

### Find Index
```javascript
const numbers = [10, 20, 30, 40, 50];

const index = numbers.findIndex(n => n > 25);
console.log(index);  // 2 (index of 30)

const notFound = numbers.findIndex(n => n > 100);
console.log(notFound);  // -1
```

### Update Element by Condition
```javascript
const users = [
  {id: 1, name: 'John', active: false},
  {id: 2, name: 'Jane', active: true}
];

const index = users.findIndex(u => u.id === 1);
if (index !== -1) {
  users[index].active = true;
}

console.log(users[0].active);  // true
```

### Remove Element by Condition
```javascript
const arr = [1, 2, 3, 4, 5];

const index = arr.findIndex(n => n === 3);
if (index !== -1) {
  arr.splice(index, 1);
}

console.log(arr);  // [1, 2, 4, 5]
```

## some()

### Check if Any Match
```javascript
const numbers = [1, 2, 3, 4, 5];

const hasEven = numbers.some(n => n % 2 === 0);
console.log(hasEven);  // true

const hasNegative = numbers.some(n => n < 0);
console.log(hasNegative);  // false
```

### Short-Circuit Evaluation
```javascript
const numbers = [1, 3, 5, 7, 8, 9, 11];

const hasEven = numbers.some(n => {
  console.log('Checking:', n);
  return n % 2 === 0;
});
// Logs: 1, 3, 5, 7, 8 (stops at first even)
console.log(hasEven);  // true
```

### Validation
```javascript
const users = [
  {name: 'John', email: 'john@example.com'},
  {name: 'Jane', email: ''},
  {name: 'Bob', email: 'bob@example.com'}
];

const hasMissingEmail = users.some(u => !u.email);
console.log(hasMissingEmail);  // true

const hasAdmin = users.some(u => u.role === 'admin');
console.log(hasAdmin);  // false
```

## every()

### Check if All Match
```javascript
const numbers = [2, 4, 6, 8, 10];

const allEven = numbers.every(n => n % 2 === 0);
console.log(allEven);  // true

const allPositive = numbers.every(n => n > 0);
console.log(allPositive);  // true

const allGreater = numbers.every(n => n > 5);
console.log(allGreater);  // false
```

### Short-Circuit on False
```javascript
const numbers = [2, 4, 6, 7, 8, 10];

const allEven = numbers.every(n => {
  console.log('Checking:', n);
  return n % 2 === 0;
});
// Logs: 2, 4, 6, 7 (stops at first odd)
console.log(allEven);  // false
```

### Form Validation
```javascript
const fields = [
  {name: 'username', value: 'john', required: true},
  {name: 'email', value: 'john@example.com', required: true},
  {name: 'phone', value: '', required: false}
];

const allRequiredFilled = fields.every(field => 
  !field.required || field.value.trim() !== ''
);

console.log(allRequiredFilled);  // true
```

## includes()

### Simple Membership Test
```javascript
const fruits = ['apple', 'banana', 'orange'];

console.log(fruits.includes('banana'));  // true
console.log(fruits.includes('grape'));   // false

// Case sensitive
console.log(fruits.includes('Apple'));   // false
```

### From Index
```javascript
const arr = [1, 2, 3, 4, 5, 3, 2, 1];

console.log(arr.includes(3));     // true
console.log(arr.includes(3, 4));  // true (starts search from index 4)
console.log(arr.includes(2, 6));  // true
```

### NaN Handling
```javascript
const arr = [1, NaN, 3];

console.log(arr.includes(NaN));  // true
console.log(arr.indexOf(NaN));   // -1 (indexOf can't find NaN)
```

### Type Checking
```javascript
const arr = [1, 2, 3];

console.log(arr.includes(2));    // true
console.log(arr.includes('2'));  // false (type matters)
```

## Best Practices

### Use find() vs filter()[0]
```javascript
const users = [{id: 1}, {id: 2}, {id: 3}];

// ❌ Inefficient: checks all elements
const user1 = users.filter(u => u.id === 2)[0];

// ✅ Efficient: stops at first match
const user2 = users.find(u => u.id === 2);
```

### Use some() vs filter().length
```javascript
const numbers = [1, 2, 3, 4, 5];

// ❌ Creates intermediate array
const hasEven1 = numbers.filter(n => n % 2 === 0).length > 0;

// ✅ Short-circuits, no array creation
const hasEven2 = numbers.some(n => n % 2 === 0);
```

### Use every() vs filter().length
```javascript
const numbers = [2, 4, 6, 8];

// ❌ Creates intermediate array
const allEven1 = numbers.filter(n => n % 2 === 0).length === numbers.length;

// ✅ Short-circuits, more readable
const allEven2 = numbers.every(n => n % 2 === 0);
```

### Use includes() vs indexOf()
```javascript
const arr = [1, 2, 3];

// ❌ Less readable
if (arr.indexOf(2) !== -1) { }

// ✅ More readable
if (arr.includes(2)) { }
```

### Combine Methods Wisely
```javascript
const products = [
  {name: 'Laptop', price: 1000, category: 'electronics'},
  {name: 'Phone', price: 500, category: 'electronics'},
  {name: 'Shirt', price: 30, category: 'clothing'}
];

// Find first affordable electronic
const result = products
  .filter(p => p.category === 'electronics')
  .find(p => p.price < 600);

// Or more efficient:
const result2 = products.find(p => 
  p.category === 'electronics' && p.price < 600
);
```

### Early Return in Predicates
```javascript
const users = [{name: 'John', age: 25}];

// ❌ Unnecessary logic
const hasAdult = users.some(u => {
  if (u.age >= 18) {
    return true;
  } else {
    return false;
  }
});

// ✅ Simple and clear
const hasAdult2 = users.some(u => u.age >= 18);
```

## Performance Comparison

### Method Selection
```javascript
const arr = Array.from({length: 1000000}, (_, i) => i);

// find: Fast (stops early)
console.time('find');
arr.find(n => n === 500);
console.timeEnd('find');

// filter: Slow (checks all)
console.time('filter');
arr.filter(n => n === 500);
console.timeEnd('filter');

// some: Fast (stops early)
console.time('some');
arr.some(n => n === 500);
console.timeEnd('some');
```

### includes vs indexOf vs find
```javascript
const arr = Array.from({length: 1000000}, (_, i) => i);

// includes: O(n) but optimized
console.time('includes');
arr.includes(999999);
console.timeEnd('includes');

// indexOf: O(n) similar to includes
console.time('indexOf');
arr.indexOf(999999);
console.timeEnd('indexOf');

// find: O(n) with callback overhead
console.time('find');
arr.find(n => n === 999999);
console.timeEnd('find');
```

## Key Takeaways

- **filter()** returns new array with all matches (checks all elements)
- **find()** returns first match (stops early)
- **findLast()** returns last match (searches backward)
- **findIndex()/findLastIndex()** return index or -1
- **some()** returns true if any match (short-circuits)
- **every()** returns true if all match (short-circuits)
- **includes()** checks membership, handles NaN correctly
- Use **find()** over **filter()[0]** for single item
- Use **some()/every()** over **filter().length** checks
- Choose methods that **short-circuit** for better performance
- **includes()** is more readable than **indexOf() !== -1**
