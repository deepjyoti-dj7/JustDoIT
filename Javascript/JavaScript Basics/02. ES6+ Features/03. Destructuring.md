# Destructuring

Destructuring allows extracting values from arrays or properties from objects into distinct variables.

---

## Array Destructuring

Extract values from arrays using position.

### Basic Usage
```javascript
const arr = [1, 2, 3];

// Old way
const a = arr[0];
const b = arr[1];
const c = arr[2];

// Destructuring
const [a, b, c] = arr;  // a=1, b=2, c=3
```

### Skip Elements
```javascript
const arr = [1, 2, 3, 4, 5];

const [first, , third] = arr;  // first=1, third=3
const [, , , fourth] = arr;    // fourth=4
```

### Rest Pattern
```javascript
const arr = [1, 2, 3, 4, 5];

const [first, second, ...rest] = arr;
// first=1, second=2, rest=[3,4,5]

const [head, ...tail] = arr;
// head=1, tail=[2,3,4,5]
```

### Default Values
```javascript
const arr = [1];

const [a, b = 10] = arr;  // a=1, b=10 (default)
const [x, y, z = 99] = arr;  // x=1, y=undefined, z=99
```

### Swapping Variables
```javascript
let a = 1;
let b = 2;

[a, b] = [b, a];  // a=2, b=1
```

### Function Returns
```javascript
function getCoordinates() {
  return [10, 20];
}

const [x, y] = getCoordinates();  // x=10, y=20
```

---

## Object Destructuring

Extract properties from objects using names.

### Basic Usage
```javascript
const user = { name: "John", age: 30, city: "NY" };

// Old way
const name = user.name;
const age = user.age;

// Destructuring
const { name, age } = user;  // name="John", age=30
```

### Different Variable Names
```javascript
const user = { name: "John", age: 30 };

const { name: userName, age: userAge } = user;
// userName="John", userAge=30
```

### Default Values
```javascript
const user = { name: "John" };

const { name, age = 25 } = user;
// name="John", age=25 (default)

const { city = "Unknown" } = user;
// city="Unknown"
```

### Rest Pattern
```javascript
const user = { name: "John", age: 30, city: "NY", country: "USA" };

const { name, ...details } = user;
// name="John"
// details={ age: 30, city: "NY", country: "USA" }
```

### Nested Destructuring
```javascript
const user = {
  name: "John",
  address: {
    city: "NY",
    country: "USA"
  }
};

const { name, address: { city, country } } = user;
// name="John", city="NY", country="USA"

// Note: address is not defined, only city and country
```

### Function Parameters
```javascript
// Old way
function greet(user) {
  console.log(`Hello, ${user.name}!`);
}

// Destructuring
function greet({ name, age }) {
  console.log(`Hello, ${name}! You are ${age}.`);
}

greet({ name: "John", age: 30 });

// With defaults
function createUser({ name, age = 18, role = "user" }) {
  return { name, age, role };
}
```

---

## Combining Array and Object Destructuring

```javascript
const users = [
  { name: "John", age: 30 },
  { name: "Jane", age: 25 }
];

const [{ name: firstName }, { age: secondAge }] = users;
// firstName="John", secondAge=25

const response = {
  data: {
    users: ["Alice", "Bob", "Charlie"]
  }
};

const { data: { users: [first, second] } } = response;
// first="Alice", second="Bob"
```

---

## Practical Examples

### API Response Handling
```javascript
fetch('/api/user')
  .then(res => res.json())
  .then(({ id, name, email }) => {
    console.log(`User ${name} (${email})`);
  });
```

### React Props
```javascript
function UserCard({ name, age, avatar }) {
  return `
    <div>
      <img src="${avatar}" />
      <h2>${name}</h2>
      <p>Age: ${age}</p>
    </div>
  `;
}
```

### Configuration Objects
```javascript
function connect({ host = 'localhost', port = 3000, timeout = 5000 }) {
  console.log(`Connecting to ${host}:${port}`);
}

connect({ host: 'api.example.com' });  // Uses default port and timeout
```

### Module Imports
```javascript
// Import specific exports
import { useState, useEffect } from 'react';

const { readFile, writeFile } = require('fs');
```

### Iterating Objects
```javascript
const users = [
  { name: "John", age: 30 },
  { name: "Jane", age: 25 }
];

for (const { name, age } of users) {
  console.log(`${name} is ${age}`);
}
```

---

## Advanced Patterns

### Computed Property Names
```javascript
const key = 'name';
const { [key]: value } = { name: 'John' };
// value="John"
```

### Multiple Assignment
```javascript
const obj = { a: 1, b: 2, c: 3 };

let a, b, c;
({ a, b, c } = obj);  // Parentheses required for statement
```

### Destructuring in Catch
```javascript
try {
  throw { code: 404, message: "Not found" };
} catch ({ code, message }) {
  console.log(`Error ${code}: ${message}`);
}
```

---

## Common Pitfalls

### Undefined Properties
```javascript
const obj = { name: "John" };
const { name, age } = obj;  // age is undefined

// Use defaults
const { name, age = 0 } = obj;  // age=0
```

### Mixing Declaration and Assignment
```javascript
let a, b;
{ a, b } = { a: 1, b: 2 };  // SyntaxError

// Fix: wrap in parentheses
({ a, b } = { a: 1, b: 2 });
```

### Deep Nesting Errors
```javascript
const obj = { user: null };
const { user: { name } } = obj;  // TypeError: Cannot read property 'name' of null

// Fix: use optional chaining or check
const { user } = obj;
const name = user?.name;
```

---

## Best Practices

1. **Use for clear variable extraction**
   ```javascript
   // ✓ Clear
   const { name, email } = user;
   
   // ✗ Verbose
   const name = user.name;
   const email = user.email;
   ```

2. **Provide defaults for optional properties**
   ```javascript
   function config({ port = 3000, host = 'localhost' }) {
     // defaults ensure values exist
   }
   ```

3. **Don't over-nest**
   ```javascript
   // ✗ Hard to read
   const { a: { b: { c: { d } } } } = obj;
   
   // ✓ Step by step
   const { a } = obj;
   const { b } = a;
   const { c } = b;
   ```

4. **Use meaningful variable names**
   ```javascript
   // When renaming
   const { n: userName, e: userEmail } = data;  // ✗ Cryptic
   const { name: userName, email: userEmail } = data;  // ✓ Clear
   ```

---

## Key Takeaways

- **Extract multiple values** in one statement
- **Array destructuring** uses position `[a, b]`
- **Object destructuring** uses property names `{a, b}`
- **Rest pattern** collects remaining items `...rest`
- **Default values** prevent undefined `= value`
- **Rename variables** with `name: newName`
- **Nested destructuring** for deep properties
- Perfect for **function parameters** and **API responses**