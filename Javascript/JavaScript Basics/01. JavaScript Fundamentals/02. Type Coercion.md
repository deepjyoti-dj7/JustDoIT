# Type Coercion

Type coercion is the automatic or explicit conversion of values from one data type to another. JavaScript performs coercion in many situations, which can lead to unexpected results.

---

## Implicit Coercion (Automatic)

JavaScript automatically converts types when needed.

### String Coercion
The `+` operator with a string converts other values to strings.

```javascript
"5" + 3           // "53" (3 converted to string)
"Hello" + true    // "Hellotrue"
"Result: " + 42   // "Result: 42"
null + "value"    // "nullvalue"

// Common in concatenation
let age = 25;
let message = "Age: " + age;  // "Age: 25"
```

### Number Coercion
Math operators (except `+`) convert strings to numbers.

```javascript
"5" - 3           // 2 (string "5" → number 5)
"10" * "2"        // 20 (both converted to numbers)
"20" / "4"        // 5
"15" % 4          // 3

// With non-numeric strings
"hello" - 5       // NaN (cannot convert "hello")
```

### Boolean Coercion
Happens in conditions and logical operations.

```javascript
if ("hello") {     // "hello" is truthy
  console.log("Runs");
}

if (0) {           // 0 is falsy
  console.log("Doesn't run");
}

true + 1          // 2 (true → 1)
false + 1         // 1 (false → 0)
```

---

## Explicit Coercion (Manual)

You control the conversion.

### To String
```javascript
String(123)           // "123"
String(true)          // "true"
String(null)          // "null"
String(undefined)     // "undefined"

// Alternative: .toString()
(123).toString()      // "123"
true.toString()       // "true"
```

### To Number
```javascript
Number("456")         // 456
Number("3.14")        // 3.14
Number(true)          // 1
Number(false)         // 0
Number(null)          // 0
Number(undefined)     // NaN
Number("hello")       // NaN

// Parsing strings
parseInt("42px")      // 42 (stops at non-digit)
parseInt("3.14")      // 3 (integer only)
parseFloat("3.14")    // 3.14 (keeps decimal)
parseInt("ff", 16)    // 255 (hexadecimal)

// Unary plus operator
+"100"                // 100
+true                 // 1
```

### To Boolean
```javascript
Boolean(1)            // true
Boolean(0)            // false
Boolean("hello")      // true
Boolean("")           // false
Boolean(null)         // false

// Double NOT operator (same result)
!!"hello"             // true
!!0                   // false
```

---

## Truthy and Falsy Values

In boolean contexts, values are coerced to true or false.

### Falsy Values (Only 6!)
```javascript
false
0
"" (empty string)
null
undefined
NaN
```

### Everything Else is Truthy
```javascript
"0"               // truthy (non-empty string)
"false"           // truthy (non-empty string)
[]                // truthy (empty array)
{}                // truthy (empty object)
function(){}      // truthy
" " (space)       // truthy (non-empty string)
-1                // truthy (non-zero number)
```

**Practical use:**
```javascript
let userName = "";
if (userName) {
  console.log("Welcome", userName);
} else {
  console.log("Guest user");  // Runs (empty string is falsy)
}

let items = [];
if (items.length) {
  console.log("Has items");
} else {
  console.log("Empty");  // Runs (0 is falsy)
}
```

---

## Equality Comparison

### Loose Equality (==)
Performs type coercion before comparison.

```javascript
5 == "5"          // true (string "5" converted to number)
1 == true         // true (true → 1)
0 == false        // true (false → 0)
null == undefined // true (special case)
"" == false       // true (both falsy)

// Unexpected results
[] == false       // true
[] == ![]         // true (!)
"" == 0           // true
```

### Strict Equality (===)
No type coercion - types must match.

```javascript
5 === "5"         // false (different types)
1 === true        // false (different types)
0 === false       // false (different types)
null === undefined// false (different types)

// Recommended
"hello" === "hello"  // true
42 === 42            // true
```

---

## Common Gotchas

```javascript
// Array/Object to primitive
[] + []           // "" (empty string)
[] + {}           // "[object Object]"
{} + []           // 0 (in some contexts)

// NaN is special
NaN == NaN        // false (!)
NaN === NaN       // false (!)
Number.isNaN(NaN) // true (correct way)

// Null and undefined
null == undefined  // true (loose)
null === undefined // false (strict)

// String concatenation trap
"2" + 2 + 2       // "222" (left to right)
2 + 2 + "2"       // "42" (left to right)

// Comparison quirks
"10" > "9"        // false (string comparison)
"10" > 9          // true (coerced to number)
```

---

## Best Practices

1. **Always use `===` and `!==`** (strict equality)
   ```javascript
   // ✓ Good
   if (value === 0) { }
   if (user !== null) { }
   
   // ✗ Avoid
   if (value == 0) { }
   ```

2. **Be explicit with conversions**
   ```javascript
   // ✓ Clear intent
   Number(input)
   String(value)
   Boolean(flag)
   
   // ✗ Relies on coercion
   +input
   value + ""
   !!flag
   ```

3. **Watch the `+` operator**
   ```javascript
   // ✓ Use template literals
   `Total: ${price + tax}`
   
   // ✗ Can be ambiguous
   "Total: " + price + tax
   ```

4. **Check for null/undefined explicitly**
   ```javascript
   // ✓ Clear check
   if (value !== null && value !== undefined) { }
   if (value != null) { }  // Checks both
   
   // ✗ Might exclude 0, "", false
   if (value) { }
   ```

---

## Key Takeaways

- **Implicit coercion** happens automatically (can be surprising)
- **Explicit coercion** makes intent clear
- Only **6 falsy values** - everything else is truthy
- Use **`===`** to avoid coercion issues
- The **`+` operator** with strings causes concatenation
- **`NaN`** never equals anything, including itself
