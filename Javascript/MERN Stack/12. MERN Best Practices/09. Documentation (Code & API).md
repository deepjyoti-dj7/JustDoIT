# 09. Documentation (Code & API)

## Introduction

Good documentation improves code maintainability, team collaboration, and developer experience. This guide covers code documentation (JSDoc) and API documentation (Swagger/OpenAPI) for MERN applications.

---

## Why Documentation Matters

1. **Maintainability**: Future developers understand code quickly
2. **Onboarding**: New team members get up to speed faster
3. **Collaboration**: Clear communication between frontend and backend
4. **API Contract**: Defines expected behavior and data structures
5. **Testing**: Helps write better tests

---

## Code Documentation (JSDoc)

### What is JSDoc?

JavaScript documentation generator that creates HTML documentation from comments.

### Installation

```bash
npm install --save-dev jsdoc
```

### Basic Syntax

```javascript
/**
 * Description of function
 * @param {Type} paramName - Parameter description
 * @returns {Type} Return value description
 */
```

### Function Documentation

```javascript
/**
 * Calculates the sum of two numbers
 * @param {number} a - First number
 * @param {number} b - Second number
 * @returns {number} Sum of a and b
 * @example
 * add(2, 3); // Returns 5
 */
function add(a, b) {
  return a + b;
}

/**
 * Fetches user from database by ID
 * @async
 * @param {string} userId - MongoDB ObjectId
 * @returns {Promise<Object>} User object
 * @throws {Error} If user not found
 */
async function getUserById(userId) {
  const user = await User.findById(userId);
  if (!user) throw new Error('User not found');
  return user;
}

/**
 * Validates email format
 * @param {string} email - Email to validate
 * @returns {boolean} True if valid, false otherwise
 */
const isValidEmail = (email) => {
  const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  return regex.test(email);
};
```

### Class Documentation

```javascript
/**
 * Represents a user in the system
 * @class
 */
class User {
  /**
   * Create a user
   * @param {string} name - User's name
   * @param {string} email - User's email
   */
  constructor(name, email) {
    this.name = name;
    this.email = email;
  }
  
  /**
   * Get user's full profile
   * @returns {Object} User profile with name and email
   */
  getProfile() {
    return {
      name: this.name,
      email: this.email
    };
  }
}
```

### React Component Documentation

```javascript
import PropTypes from 'prop-types';

/**
 * UserCard component displays user information
 * @component
 * @param {Object} props
 * @param {Object} props.user - User object
 * @param {string} props.user.name - User's name
 * @param {string} props.user.email - User's email
 * @param {Function} props.onEdit - Callback when edit is clicked
 * @example
 * <UserCard 
 *   user={{ name: 'John', email: 'john@example.com' }}
 *   onEdit={handleEdit}
 * />
 */
function UserCard({ user, onEdit }) {
  return (
    <div className="user-card">
      <h3>{user.name}</h3>
      <p>{user.email}</p>
      <button onClick={() => onEdit(user)}>Edit</button>
    </div>
  );
}

UserCard.propTypes = {
  user: PropTypes.shape({
    name: PropTypes.string.isRequired,
    email: PropTypes.string.isRequired
  }).isRequired,
  onEdit: PropTypes.func.isRequired
};

export default UserCard;
```

### Custom Types (TypeScript-style)

```javascript
/**
 * @typedef {Object} User
 * @property {string} id - User ID
 * @property {string} name - User's name
 * @property {string} email - User's email
 * @property {boolean} isActive - Account status
 */

/**
 * @typedef {Object} CreateUserDTO
 * @property {string} name - User's name
 * @property {string} email - User's email
 * @property {string} password - User's password
 */

/**
 * Creates a new user
 * @param {CreateUserDTO} userData - User data
 * @returns {Promise<User>} Created user
 */
async function createUser(userData) {
  // Implementation
}
```

### Generating Documentation

**jsdoc.json**:
```json
{
  "source": {
    "include": ["src"],
    "includePattern": ".js$",
    "excludePattern": "(node_modules|test)"
  },
  "opts": {
    "destination": "./docs",
    "recurse": true
  }
}
```

**package.json**:
```json
{
  "scripts": {
    "docs": "jsdoc -c jsdoc.json"
  }
}
```

```bash
npm run docs
```

---

## API Documentation (Swagger/OpenAPI)

### What is Swagger?

Specification for RESTful APIs with interactive documentation UI.

### Installation

```bash
npm install swagger-ui-express swagger-jsdoc
```

### Setup

```javascript
// swagger.js
const swaggerJsDoc = require('swagger-jsdoc');
const swaggerUi = require('swagger-ui-express');

const options = {
  definition: {
    openapi: '3.0.0',
    info: {
      title: 'My API',
      version: '1.0.0',
      description: 'MERN Stack API Documentation',
      contact: {
        name: 'API Support',
        email: 'support@example.com'
      }
    },
    servers: [
      {
        url: 'http://localhost:5000',
        description: 'Development server'
      },
      {
        url: 'https://api.example.com',
        description: 'Production server'
      }
    ],
    components: {
      securitySchemes: {
        bearerAuth: {
          type: 'http',
          scheme: 'bearer',
          bearerFormat: 'JWT'
        }
      }
    },
    security: [{
      bearerAuth: []
    }]
  },
  apis: ['./routes/*.js', './models/*.js']
};

const swaggerSpec = swaggerJsDoc(options);

module.exports = { swaggerUi, swaggerSpec };

// app.js
const { swaggerUi, swaggerSpec } = require('./swagger');

app.use('/api-docs', swaggerUi.serve, swaggerUi.setup(swaggerSpec));
```

### Documenting Models

```javascript
/**
 * @swagger
 * components:
 *   schemas:
 *     User:
 *       type: object
 *       required:
 *         - name
 *         - email
 *         - password
 *       properties:
 *         id:
 *           type: string
 *           description: Auto-generated user ID
 *         name:
 *           type: string
 *           description: User's name
 *         email:
 *           type: string
 *           format: email
 *           description: User's email
 *         password:
 *           type: string
 *           format: password
 *           description: User's password (hashed)
 *         isActive:
 *           type: boolean
 *           default: true
 *           description: Account status
 *         createdAt:
 *           type: string
 *           format: date-time
 *           description: Account creation timestamp
 *       example:
 *         id: 60d5ec49f1a2c8b1f8e4e1a1
 *         name: John Doe
 *         email: john@example.com
 *         isActive: true
 *         createdAt: 2023-01-15T10:30:00.000Z
 */
```

### Documenting Endpoints

**GET Request**:
```javascript
/**
 * @swagger
 * /api/users:
 *   get:
 *     summary: Get all users
 *     tags: [Users]
 *     parameters:
 *       - in: query
 *         name: page
 *         schema:
 *           type: integer
 *           default: 1
 *         description: Page number
 *       - in: query
 *         name: limit
 *         schema:
 *           type: integer
 *           default: 10
 *         description: Number of items per page
 *     responses:
 *       200:
 *         description: List of users
 *         content:
 *           application/json:
 *             schema:
 *               type: object
 *               properties:
 *                 users:
 *                   type: array
 *                   items:
 *                     $ref: '#/components/schemas/User'
 *                 page:
 *                   type: integer
 *                 totalPages:
 *                   type: integer
 *       500:
 *         description: Server error
 */
router.get('/users', async (req, res) => {
  // Implementation
});
```

**POST Request**:
```javascript
/**
 * @swagger
 * /api/users:
 *   post:
 *     summary: Create a new user
 *     tags: [Users]
 *     requestBody:
 *       required: true
 *       content:
 *         application/json:
 *           schema:
 *             type: object
 *             required:
 *               - name
 *               - email
 *               - password
 *             properties:
 *               name:
 *                 type: string
 *               email:
 *                 type: string
 *                 format: email
 *               password:
 *                 type: string
 *                 format: password
 *                 minLength: 6
 *             example:
 *               name: John Doe
 *               email: john@example.com
 *               password: secret123
 *     responses:
 *       201:
 *         description: User created successfully
 *         content:
 *           application/json:
 *             schema:
 *               $ref: '#/components/schemas/User'
 *       400:
 *         description: Validation error
 *       409:
 *         description: Email already exists
 */
router.post('/users', async (req, res) => {
  // Implementation
});
```

**GET by ID**:
```javascript
/**
 * @swagger
 * /api/users/{id}:
 *   get:
 *     summary: Get user by ID
 *     tags: [Users]
 *     parameters:
 *       - in: path
 *         name: id
 *         required: true
 *         schema:
 *           type: string
 *         description: User ID
 *     responses:
 *       200:
 *         description: User found
 *         content:
 *           application/json:
 *             schema:
 *               $ref: '#/components/schemas/User'
 *       404:
 *         description: User not found
 */
router.get('/users/:id', async (req, res) => {
  // Implementation
});
```

**PUT Request**:
```javascript
/**
 * @swagger
 * /api/users/{id}:
 *   put:
 *     summary: Update user
 *     tags: [Users]
 *     security:
 *       - bearerAuth: []
 *     parameters:
 *       - in: path
 *         name: id
 *         required: true
 *         schema:
 *           type: string
 *     requestBody:
 *       required: true
 *       content:
 *         application/json:
 *           schema:
 *             type: object
 *             properties:
 *               name:
 *                 type: string
 *               email:
 *                 type: string
 *     responses:
 *       200:
 *         description: User updated
 *       401:
 *         description: Unauthorized
 *       404:
 *         description: User not found
 */
router.put('/users/:id', authMiddleware, async (req, res) => {
  // Implementation
});
```

**DELETE Request**:
```javascript
/**
 * @swagger
 * /api/users/{id}:
 *   delete:
 *     summary: Delete user
 *     tags: [Users]
 *     security:
 *       - bearerAuth: []
 *     parameters:
 *       - in: path
 *         name: id
 *         required: true
 *         schema:
 *           type: string
 *     responses:
 *       200:
 *         description: User deleted
 *       401:
 *         description: Unauthorized
 *       404:
 *         description: User not found
 */
router.delete('/users/:id', authMiddleware, async (req, res) => {
  // Implementation
});
```

---

## README Documentation

### Project README Template

```markdown
# Project Name

Brief description of the project

## Features

- User authentication with JWT
- CRUD operations for resources
- Real-time updates with Socket.io
- File upload with Multer
- Payment integration with Stripe

## Tech Stack

**Frontend:** React, Redux Toolkit, Material-UI  
**Backend:** Node.js, Express, MongoDB  
**Other:** Socket.io, JWT, Stripe

## Prerequisites

- Node.js 16+
- MongoDB 4.4+
- npm or yarn

## Installation

### Clone repository
```bash
git clone https://github.com/username/project.git
cd project
```

### Backend setup
```bash
cd backend
npm install
cp .env.example .env  # Configure environment variables
npm run dev
```

### Frontend setup
```bash
cd frontend
npm install
npm start
```

## Environment Variables

### Backend (.env)
```
PORT=5000
MONGO_URI=mongodb://localhost:27017/mydb
JWT_SECRET=your_secret_key
STRIPE_SECRET_KEY=sk_test_...
```

### Frontend (.env)
```
REACT_APP_API_URL=http://localhost:5000
REACT_APP_STRIPE_PUBLIC_KEY=pk_test_...
```

## API Documentation

Swagger UI: http://localhost:5000/api-docs

## Project Structure

```
backend/
├── config/
├── controllers/
├── middleware/
├── models/
├── routes/
├── utils/
└── server.js

frontend/
├── public/
├── src/
    ├── components/
    ├── pages/
    ├── redux/
    ├── utils/
    └── App.js
```

## Scripts

### Backend
```bash
npm run dev      # Development with nodemon
npm start        # Production
npm test         # Run tests
npm run lint     # Run ESLint
```

### Frontend
```bash
npm start        # Development server
npm run build    # Production build
npm test         # Run tests
```

## Testing

```bash
npm test
```

## Deployment

### Backend (Heroku)
```bash
heroku create
git push heroku main
heroku config:set MONGO_URI=...
```

### Frontend (Vercel)
```bash
vercel
```

## Contributing

1. Fork the project
2. Create feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit changes (`git commit -m 'Add AmazingFeature'`)
4. Push to branch (`git push origin feature/AmazingFeature`)
5. Open Pull Request

## License

MIT License

## Contact

Your Name - email@example.com  
Project Link: https://github.com/username/project
```

---

## Interview Questions

**Q1: Why document code?**
- Maintainability, onboarding, collaboration, API contract, testing

**Q2: What is JSDoc?**
- JavaScript documentation generator
- Creates HTML docs from comments
- Defines types, params, returns

**Q3: What is Swagger/OpenAPI?**
- API specification format
- Interactive documentation UI
- Defines endpoints, parameters, responses

**Q4: Best practices for README?**
- Clear description
- Installation steps
- Environment variables
- Project structure
- Scripts and deployment

**Q5: How to document React components?**
- JSDoc comments
- PropTypes for type checking
- Example usage
- Component description

---

## Summary

- **JSDoc**: Code documentation with types, params, returns
- **Swagger**: Interactive API documentation
- **README**: Project overview, setup, deployment
- **Best Practice**: Document as you code, keep updated
- **Tools**: jsdoc, swagger-ui-express, swagger-jsdoc
