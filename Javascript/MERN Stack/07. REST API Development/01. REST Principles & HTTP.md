# REST Principles & HTTP

## What is REST?

**REST (Representational State Transfer)** is an architectural style for designing networked applications.

**Key Characteristics:**
- Uses HTTP methods (GET, POST, PUT, DELETE)
- Stateless client-server communication
- Resource-based (not action-based)
- Standard data formats (JSON, XML)

> **REST is not a protocol, it's an architectural style.**

---

## REST Principles

### 1. Client-Server Architecture

Separation of concerns between client and server.

```
Client (Frontend)  <-->  Server (Backend)
   React/Vue              Express/Node.js
```

**Benefits:**
- Independent evolution
- Better scalability
- Clear separation of concerns

### 2. Statelessness

Each request contains **all information** needed to process it.

```js
// ❌ Bad: Server stores state
app.get('/users', (req, res) => {
  const page = req.session.currentPage; // Relies on server state
});

// ✅ Good: Client sends all needed info
app.get('/users', (req, res) => {
  const page = req.query.page || 1; // Stateless
});
```

**Benefits:**
- Easier scaling (no session state)
- Better reliability
- Simpler server logic

### 3. Cacheability

Responses should be cacheable when possible.

```js
app.get('/products', (req, res) => {
  res.set('Cache-Control', 'public, max-age=3600'); // Cache for 1 hour
  res.json(products);
});
```

### 4. Uniform Interface

Consistent way to interact with resources.

```
GET    /users      → Get all users
GET    /users/1    → Get user by ID
POST   /users      → Create user
PUT    /users/1    → Update user
DELETE /users/1    → Delete user
```

### 5. Layered System

Client doesn't know if connected directly to server or through intermediaries.

```
Client → Load Balancer → API Gateway → Microservices
```

### 6. Code on Demand (Optional)

Server can send executable code to client.

```js
// Example: Sending JavaScript code
res.json({
  data: users,
  script: 'function processUsers() { ... }'
});
```

---

## HTTP Methods

### GET - Read Resource

```js
// Get all users
GET /api/users

// Get specific user
GET /api/users/123

// Get with query params
GET /api/users?role=admin&page=2
```

**Characteristics:**
- Safe (no side effects)
- Idempotent (same result on multiple calls)
- Cacheable

### POST - Create Resource

```js
POST /api/users
Content-Type: application/json

{
  "name": "John Doe",
  "email": "john@example.com"
}
```

**Characteristics:**
- Not safe (creates data)
- Not idempotent (multiple calls = multiple resources)
- Not cacheable

### PUT - Update/Replace Resource

```js
PUT /api/users/123
Content-Type: application/json

{
  "name": "John Smith",
  "email": "john.smith@example.com"
}
```

**Characteristics:**
- Not safe (modifies data)
- Idempotent (same result on multiple calls)
- Replaces entire resource

### PATCH - Partial Update

```js
PATCH /api/users/123
Content-Type: application/json

{
  "email": "newemail@example.com"
}
```

**Characteristics:**
- Not safe (modifies data)
- May or may not be idempotent
- Updates only specified fields

### DELETE - Remove Resource

```js
DELETE /api/users/123
```

**Characteristics:**
- Not safe (removes data)
- Idempotent (deleting twice = same result)

---

## HTTP Status Codes

### 2xx Success

| Code | Name | When to Use |
|------|------|-------------|
| 200 | OK | Successful GET, PUT, PATCH |
| 201 | Created | Successful POST |
| 204 | No Content | Successful DELETE |

```js
// 200 OK
res.status(200).json({ user });

// 201 Created
res.status(201).json({ user });

// 204 No Content
res.status(204).send();
```

### 3xx Redirection

| Code | Name | When to Use |
|------|------|-------------|
| 301 | Moved Permanently | Resource moved to new URL |
| 304 | Not Modified | Cached version is still valid |

### 4xx Client Errors

| Code | Name | When to Use |
|------|------|-------------|
| 400 | Bad Request | Invalid request data |
| 401 | Unauthorized | Missing/invalid authentication |
| 403 | Forbidden | User lacks permission |
| 404 | Not Found | Resource doesn't exist |
| 409 | Conflict | Duplicate resource |
| 422 | Unprocessable Entity | Validation failed |
| 429 | Too Many Requests | Rate limit exceeded |

```js
// 400 Bad Request
res.status(400).json({ error: 'Invalid email format' });

// 401 Unauthorized
res.status(401).json({ error: 'Authentication required' });

// 404 Not Found
res.status(404).json({ error: 'User not found' });
```

### 5xx Server Errors

| Code | Name | When to Use |
|------|------|-------------|
| 500 | Internal Server Error | Unexpected server error |
| 502 | Bad Gateway | Invalid response from upstream |
| 503 | Service Unavailable | Server temporarily down |

```js
// 500 Internal Server Error
res.status(500).json({ error: 'Internal server error' });
```

---

## HTTP Headers

### Request Headers

```http
GET /api/users HTTP/1.1
Host: api.example.com
Content-Type: application/json
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
Accept: application/json
User-Agent: Mozilla/5.0
```

### Response Headers

```http
HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: public, max-age=3600
ETag: "33a64df551425fcc55e4d42a148795d9f25f89d4"
X-RateLimit-Limit: 100
X-RateLimit-Remaining: 95
```

### Common Headers

```js
// Content-Type: What you're sending
res.set('Content-Type', 'application/json');

// Cache-Control: Caching directives
res.set('Cache-Control', 'public, max-age=3600');

// ETag: Resource version identifier
res.set('ETag', '"abc123"');

// CORS headers
res.set('Access-Control-Allow-Origin', '*');
```

---

## REST vs SOAP

| Feature | REST | SOAP |
|---------|------|------|
| Protocol | Architectural style | Protocol |
| Format | JSON, XML, etc. | XML only |
| Transport | HTTP/HTTPS | HTTP, SMTP, TCP |
| Complexity | Simple | Complex |
| Performance | Faster | Slower |
| Use case | Web/Mobile APIs | Enterprise systems |

---

## Idempotency

**Idempotent**: Multiple identical requests have same effect as single request.

```js
// ✅ Idempotent (GET)
GET /api/users/123  // Always returns same user

// ✅ Idempotent (PUT)
PUT /api/users/123  // Updates to same state
{ "name": "John" }

// ✅ Idempotent (DELETE)
DELETE /api/users/123  // First: deletes, Second: 404

// ❌ Not Idempotent (POST)
POST /api/users  // Creates new user each time
```

---

## REST Best Practices

### 1. Use Nouns, Not Verbs

```
❌ Bad:
GET  /getUsers
POST /createUser
POST /deleteUser/123

✅ Good:
GET    /users
POST   /users
DELETE /users/123
```

### 2. Use Plural Nouns

```
❌ Bad: /user/123
✅ Good: /users/123
```

### 3. Use HTTP Methods Correctly

```
✅ Good:
GET    /users      - List users
POST   /users      - Create user
GET    /users/123  - Get user
PUT    /users/123  - Update user
DELETE /users/123  - Delete user
```

### 4. Nest Resources for Relationships

```
GET /users/123/posts       - User's posts
GET /posts/456/comments    - Post's comments
POST /users/123/posts      - Create post for user
```

### 5. Use Query Parameters for Filtering

```
GET /users?role=admin
GET /products?category=electronics&sort=price
GET /posts?page=2&limit=10
```

---

## Interview Questions

### Q1: What is REST?
**Answer**: REST is an architectural style for designing networked applications. It uses HTTP methods, is stateless, and is resource-based.

### Q2: What are the main HTTP methods?
**Answer**: GET (read), POST (create), PUT (update/replace), PATCH (partial update), DELETE (remove).

### Q3: What's the difference between PUT and PATCH?
**Answer**:
- **PUT**: Replaces entire resource
- **PATCH**: Updates only specified fields

### Q4: What does stateless mean in REST?
**Answer**: Each request contains all information needed to process it. Server doesn't store client state between requests.

### Q5: What's the difference between 401 and 403?
**Answer**:
- **401 Unauthorized**: Not authenticated (missing/invalid credentials)
- **403 Forbidden**: Authenticated but lacks permission

### Q6: What is idempotency?
**Answer**: Multiple identical requests have the same effect as a single request. GET, PUT, DELETE are idempotent. POST is not.

### Q7: Why use JSON over XML?
**Answer**: JSON is lighter, easier to parse, more readable, and native to JavaScript.

---

## Summary

- **REST** is an architectural style using HTTP methods
- **6 Principles**: Client-Server, Stateless, Cacheable, Uniform Interface, Layered System, Code on Demand
- **HTTP Methods**: GET (read), POST (create), PUT (replace), PATCH (update), DELETE (remove)
- **Status Codes**: 2xx (success), 4xx (client error), 5xx (server error)
- **Idempotent**: GET, PUT, DELETE (safe to retry)
- **Best Practices**: Use nouns, plural resources, HTTP methods correctly, nest relationships
- **REST vs SOAP**: REST is simpler, faster, uses JSON; SOAP is complex, uses XML
