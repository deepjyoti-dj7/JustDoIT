# 13. Static Files & Assets

## Serving Static Files

Use `express.static()` middleware to serve static files.

---

## Basic Setup

```javascript
const express = require('express');
const path = require('path');

const app = express();

// Serve static files from 'public' folder
app.use(express.static('public'));

app.listen(3000);
```

**Folder structure:**

```
project/
├── app.js
├── public/
│   ├── index.html
│   ├── style.css
│   ├── script.js
│   └── images/
│       └── logo.png
```

**Access files:**

```
http://localhost:3000/index.html
http://localhost:3000/style.css
http://localhost:3000/script.js
http://localhost:3000/images/logo.png
```

---

## Custom Path Prefix

```javascript
// Serve files with '/static' prefix
app.use('/static', express.static('public'));

// Access:
// http://localhost:3000/static/style.css
// http://localhost:3000/static/images/logo.png
```

---

## Absolute Path

```javascript
const path = require('path');

app.use(express.static(path.join(__dirname, 'public')));
```

---

## Multiple Static Directories

```javascript
app.use(express.static('public'));
app.use(express.static('files'));
app.use(express.static('uploads'));

// Express looks for files in order
```

---

## Serve from Different Folders

```javascript
app.use('/css', express.static('public/stylesheets'));
app.use('/js', express.static('public/scripts'));
app.use('/images', express.static('public/images'));

// Access:
// http://localhost:3000/css/style.css
// http://localhost:3000/js/script.js
// http://localhost:3000/images/logo.png
```

---

## Complete Example

```javascript
const express = require('express');
const path = require('path');

const app = express();

// Serve static files
app.use(express.static(path.join(__dirname, 'public')));

// Serve files with prefix
app.use('/assets', express.static(path.join(__dirname, 'assets')));

// API routes
app.get('/api/users', (req, res) => {
  res.json({ users: [] });
});

// Fallback to index.html for SPA
app.get('*', (req, res) => {
  res.sendFile(path.join(__dirname, 'public', 'index.html'));
});

app.listen(3000);
```

---

## Cache Control

```javascript
const options = {
  maxAge: '1d',  // Cache for 1 day
  etag: false    // Disable etag
};

app.use(express.static('public', options));
```

---

## Serve Index File

```javascript
const options = {
  index: 'home.html'  // Default: 'index.html'
};

app.use(express.static('public', options));
```

---

## Security Options

```javascript
const options = {
  dotfiles: 'ignore',  // Ignore dotfiles
  index: false,        // Disable directory indexing
  maxAge: '1d'
};

app.use(express.static('public', options));
```

---

## Best Practices

✅ **Use absolute paths**: `path.join(__dirname, 'public')`  
✅ **Set cache headers**: For better performance  
✅ **Use CDN**: For production  
✅ **Compress assets**: Use gzip/brotli  
✅ **Organize assets**: Separate folders for css, js, images  
❌ **Don't serve sensitive files**: Use `.gitignore`  

---

## Summary

**Static Files:**
- Use `express.static()` middleware
- Serve CSS, JS, images, etc.

**Pattern:**
```javascript
app.use(express.static('public'));
app.use('/static', express.static('assets'));
```
